<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>predict_phenotypes — predict_phenotypes • SPIAT</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="predict_phenotypes — predict_phenotypes"><meta property="og:description" content="Predicts cell phenotypes based on marker intensity levels. If no
  prior cell phenotypes are available, it adds the phenotypes to the
  SpaitalExperiment object used as input. If reference cell phenotypes are
  available, it produces a density plot showing predicted cutoff of a
  positive reading for marker intensity and it returns a dataframe containing
  the predicted intensity status for a particular marker."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPIAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic_analysis.html">Basic analyses</a>
    </li>
    <li>
      <a href="../articles/cell-colocalisation.html">Cell colocalisation</a>
    </li>
    <li>
      <a href="../articles/data_reading-formatting.html">Reading in data and data formatting in SPIAT</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Overview of the SPIAT package</a>
    </li>
    <li>
      <a href="../articles/neighborhood.html">Cellular neighborhood with SPIAT</a>
    </li>
    <li>
      <a href="../articles/quality-control_visualisation.html">Quality control and visualisation</a>
    </li>
    <li>
      <a href="../articles/spatial-heterogeneity.html">Spatial heterogeneity with SPIAT</a>
    </li>
    <li>
      <a href="../articles/tissue-structure.html">Characterise tissue structure with SPIAT</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/trigosteam/SPIAT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>predict_phenotypes</h1>
    <small class="dont-index">Source: <a href="https://github.com/trigosteam/SPIAT/blob/HEAD/R/predict_phenotypes.R" class="external-link"><code>R/predict_phenotypes.R</code></a></small>
    <div class="hidden name"><code>predict_phenotypes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Predicts cell phenotypes based on marker intensity levels. If no
  prior cell phenotypes are available, it adds the phenotypes to the
  SpaitalExperiment object used as input. If reference cell phenotypes are
  available, it produces a density plot showing predicted cutoff of a
  positive reading for marker intensity and it returns a dataframe containing
  the predicted intensity status for a particular marker.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predict_phenotypes</span><span class="op">(</span></span>
<span>  <span class="va">spe_object</span>,</span>
<span>  thresholds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">tumour_marker</span>,</span>
<span>  <span class="va">baseline_markers</span>,</span>
<span>  nuclear_marker <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reference_phenotypes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  markers_to_phenotype <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_distribution <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>spe_object</dt>
<dd><p>SpatialExperiment object in the form of the output of
<code><a href="format_image_to_spe.html">format_image_to_spe</a></code>.</p></dd>


<dt>thresholds</dt>
<dd><p>(Optional) Numeric Vector specifying the cutoff of a
positive reading. The order must match the marker order, and it should be
NA for DAPI.</p></dd>


<dt>tumour_marker</dt>
<dd><p>String containing the tumour_marker used for the image.
If tumor cells are known, annotate tumor cells as 1 and non-tumor cells as
0, and include the rowname.</p></dd>


<dt>baseline_markers</dt>
<dd><p>String Vector. Markers not found on tumour cells to
refine the threshold used for tumour cell phenotying.</p></dd>


<dt>nuclear_marker</dt>
<dd><p>String. Nuclear marker used.</p></dd>


<dt>reference_phenotypes</dt>
<dd><p>Boolean. TRUE or FALSE value whether there are reference
phenotypes for the sample obtained by the user through other means (e.g.
HALO or InForm). If there are reference phenotypes available, a matrix of
predicted phenotypes, intensities, and reference phenotypes will be
returned, which can be used as input to "marker_prediction_plot". If no
reference phenotype available, the result of the function will be added to
the spe object used in the input. Note that if a reference phenotype is to
be used, the phenotypes must be an explicit combination of positive markers
(e.g. AMACR,PDL1), as opposed to descriptive (PDL1+ tumour cells).</p></dd>


<dt>markers_to_phenotype</dt>
<dd><p>String Vector. Markers to be included in the phenotyping. If
NULL, then all markers will be used. DAPI needs to be excluded.</p></dd>


<dt>plot_distribution</dt>
<dd><p>Boolean. If TRUE, plots of the marker intensities
distributions and cutoffs are plotted.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An updated spe object with cell phenotypes or a data.frame of
  predicted phenotypes</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># keep the original phenotypes</span></span></span>
<span class="r-in"><span><span class="va">predicted_result</span> <span class="op">&lt;-</span> <span class="fu">predict_phenotypes</span><span class="op">(</span>spe_object <span class="op">=</span> <span class="va">simulated_image</span>, thresholds <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>tumour_marker <span class="op">=</span> <span class="st">"Tumour_marker"</span>,baseline_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune_marker1"</span>, <span class="st">"Immune_marker2"</span>,</span></span>
<span class="r-in"><span><span class="st">"Immune_marker3"</span>, <span class="st">"Immune_marker4"</span><span class="op">)</span>, reference_phenotypes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Tumour_marker"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Immune_marker1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Immune_marker2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Immune_marker3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Immune_marker4"</span>
<span class="r-plt img"><img src="predict_phenotypes-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># update the predicted phenotypes</span></span></span>
<span class="r-in"><span><span class="va">predicted_spe_image</span> <span class="op">&lt;-</span> <span class="fu">predict_phenotypes</span><span class="op">(</span>spe_object <span class="op">=</span> <span class="va">simulated_image</span>, thresholds <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>tumour_marker <span class="op">=</span> <span class="st">"Tumour_marker"</span>,baseline_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune_marker1"</span>, <span class="st">"Immune_marker2"</span>,</span></span>
<span class="r-in"><span><span class="st">"Immune_marker3"</span>, <span class="st">"Immune_marker4"</span><span class="op">)</span>, reference_phenotypes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Tumour_marker  threshold intensity:  0.445450443784465"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Immune_marker1  threshold intensity:  0.116980867970434"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Immune_marker2  threshold intensity:  0.124283809517202"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Immune_marker3  threshold intensity:  0.0166413130263845"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Immune_marker4  threshold intensity:  0.00989731350898589"</span>
<span class="r-plt img"><img src="predict_phenotypes-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Anna Trigos, Yuzhou Feng, Tianpei Yang, Mabel Li, John Zhu, Volkan Ozcoban, Maria Doyle.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

