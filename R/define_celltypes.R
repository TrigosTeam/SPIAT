#' define_celltypes
#'
#' @description Define celltypes of selected phenotypes. If the specified phenotype vector is 
#' shorter than the phenotypes present in the sce_object, then the unspecified phenotypes will be defined
#' as "Undefined" 
#' @param sce_object SingleCellExperiment object generated by format_image_to_sce
#' @param phentoypes Vector of phenotypes of keep or exclude
#' @param names Vector of new names assigned to the selected phenotypes
#' @export

define_celltypes <- function(sce_object,phenotypes = NULL, names = NULL){
  
  # CHECK if all phenotypes exist
  if (!all(phenotypes %in% unique(colData(sce_object)$Phenotype))){
    stop("One or more phenotype not found in image")
  }
  sce_object$Cell.Type <- ""
  all_phenotypes <- quiet_basic(print_phenotypes(sce_object))
  names<- c(names,rep("Undefined",length(all_phenotypes[!(all_phenotypes %in% phenotypes)])))
  phenotypes <- c(phenotypes,all_phenotypes[!(all_phenotypes %in% phenotypes)])
  
  for (i in 1:length(phenotypes)){
    sce_object[,sce_object$Phenotype == phenotypes[i]]$Cell.Type <- names[i]
  }
  return(sce_object)
}

