[{"path":[]},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"introduction","dir":"Articles","previous_headings":"Basics","what":"Introduction","title":"Overview of the SPIAT package","text":"SPIAT (Spatial Image Analysis Tissues) R package suite data processing, quality control, visualization, data handling data analysis tools. SPIAT compatible data generated single-cell spatial proteomics platforms (e.g. OPAL, CODEX, MIBI). SPIAT reads spatial data form X Y coordinates cells, marker intensities cell phenotypes. SPIAT includes six analysis modules allow visualization, calculation cell colocalization, categorization immune microenvironment relative tumor areas, analysis cellular neighborhoods, quantification spatial heterogeneity, providing comprehensive toolkit spatial data analysis. overview functions available shown figure .","code":""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"install-spiat","dir":"Articles","previous_headings":"Basics","what":"Install SPIAT","title":"Overview of the SPIAT package","text":"SPIAT R package available via Bioconductor repository packages. R can installed operating system CRAN can install SPIAT using following commands R session:","code":"# ## Check that you have a valid Bioconductor installation # BiocManager::valid()  # if (!requireNamespace(\"BiocManager\", quietly = TRUE)) { #       install.packages(\"BiocManager\") #   } #  # BiocManager::install(\"SPIAT\") #   ## install from GitHub # install.packages(\"devtools\") # if you don't have devtools installed # devtools::install_github(\"TrigosTeam/SPIAT\", ref = \"main\")"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"citing-spiat","dir":"Articles","previous_headings":"Basics","what":"Citing SPIAT","title":"Overview of the SPIAT package","text":"hope SPIAT useful research. Please use following information cite package overall approach. Thank !","code":"## Citation info citation(\"SPIAT\") ##  ## Yang T, Ozcoban V, Pasam A, Kocovski N, Pizzolla A, Huang Y, Bass G, ## Keam S, Neeson P, Sandhu S, Goode D, Trigos A (2020). \"SPIAT: An R ## package for the Spatial Image Analysis of Cells in Tissues.\" _bioRxiv_. ## doi: 10.1101/2020.05.28.122614 (URL: ## https://doi.org/10.1101/2020.05.28.122614). ##  ## A BibTeX entry for LaTeX users is ##  ##   @Article{, ##     title = {SPIAT: An R package for the Spatial Image Analysis of Cells in Tissues}, ##     author = {Tianpei Yang and Volkan Ozcoban and Anu Pasam and Nikolce Kocovski and Angela Pizzolla and Yu-Kuan Huang and Greg Bass and Simon P Keam and Paul J Neeson and Shahneen K Sandhu and David L Goode and Anna S Trigos}, ##     journal = {bioRxiv}, ##     year = {2020}, ##     doi = {10.1101/2020.05.28.122614}, ##   }"},{"path":[]},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"reading-in-data-and-basic-data-formatting-in-spiat","dir":"Articles","previous_headings":"Tutorial","what":"Reading in data and basic data formatting in SPIAT","title":"Overview of the SPIAT package","text":"First load SPIAT library. format_image_to_sce main function read data SPIAT.format_image_to_sce creates SingleCellExperiment object used subsequent functions. key data points interest SPIAT cell coordinates, marker intensities cell phenotypes cell. format_image_to_sce specific options read data generated InForm, HALO, Visium 10X Genomics, CODEX cell profiler. However, advice pre-formatting data input SPIAT accepted ‘general’ option (shown ). due often inconsistencies column names data formats across different versions result different user options using platforms.","code":"library(SPIAT)"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"reading-in-data-through-the-general-option-recommended","dir":"Articles","previous_headings":"Tutorial > Reading in data and basic data formatting in SPIAT","what":"Reading in data through the ‘general’ option (RECOMMENDED)","title":"Overview of the SPIAT package","text":"Format “general” allows input matrix intensities (intensity_matrix), vector phenotypes, order appear intensity_matrix. must form marker combinations (e.g. “CD3,CD8”), opposed cell names (e.g. “cytotoxic T cells”), matching marker names. phenotypes available, vector NA can used input. also need provide vector X coordinates cells one Y (coord_x coord_y). cells must order intensity_matrix. Xmin, Xmax, Ymin Ymax columns, advise calculating average obtain single X Y coordinate, can use input coord_x coord_y. use dummy data illustrate read “general” format. formatted image now contains phenotype, location marker intensity information 3 cells. Note users want define cell IDs, cell IDs defined colnames intensity matrix. order rows metadata correspond order colnames intensity matrix. function automatically assing rownames metadata Use following codes inspect information.","code":"# Construct a dummy marker intensity matrix ## rows are markers, columns are cells intensity_matrix <- matrix(c(14.557, 0.169, 1.655, 0.054,                              17.588, 0.229, 1.188, 2.074,                               21.262, 4.206,  5.924, 0.021), nrow = 4, ncol = 3) # define marker names as rownames rownames(intensity_matrix) <- c(\"DAPI\", \"CD3\", \"CD4\", \"AMACR\") # define cell IDs as colnames colnames(intensity_matrix) <- c(\"Cell_1\", \"Cell_2\", \"Cell_3\")   # Construct a dummy metadata (phenotypes, x/y coordinates) # the order of the elements in these vectors correspond to the cell order  # in `intensity matrix` phenotypes <- c(\"OTHER\",  \"AMACR\", \"CD3,CD4\") coord_x <- c(82, 171, 184) coord_y <- c(30, 22, 38)  general_format_image <-    format_image_to_sce(format = \"general\", intensity_matrix = intensity_matrix,                     phenotypes = phenotypes, coord_x = coord_x, coord_y = coord_y) ## Note: 4 rows removed due to NA intensity values. # metadata colData(general_format_image) ## DataFrame with 3 rows and 3 columns ##          Phenotype Cell.X.Position Cell.Y.Position ##        <character>       <numeric>       <numeric> ## Cell_1       OTHER              82              30 ## Cell_2       AMACR             171              22 ## Cell_3     CD3,CD4             184              38 # marker intensities assay(general_format_image) ##       Cell_1 Cell_2 Cell_3 ## DAPI  14.557 17.588 21.262 ## CD3    0.169  0.229  4.206 ## CD4    1.655  1.188  5.924 ## AMACR  0.054  2.074  0.021"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"reading-in-data-pre-formatted-by-other-software","dir":"Articles","previous_headings":"Tutorial > Reading in data and basic data formatting in SPIAT","what":"Reading in data pre-formatted by other software","title":"Overview of the SPIAT package","text":"SPIAT compatible data generated INFORM“,”HALO“,”Visium“,”CODEX\" “cellprofiler,” can specified options format_image_to_sce. “Visium,” “CODEX” \"cellprofiler see help (?format_image_to_sce).","code":""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"reading-in-data-from-inform","dir":"Articles","previous_headings":"Tutorial > Reading in data and basic data formatting in SPIAT > Reading in data pre-formatted by other software","what":"Reading in data from InForm","title":"Overview of the SPIAT package","text":"read data InForm, need table file generated InForm, list markers interest, location cell. format_image_to_sce uses Cell X Position Cell Y Position columns Phenotype column InForm raw data. phenotype cell can single marker, example, “CD3,” combination markers, “CD3,CD4.” convention, SPIAT assumes cells marked “” refer cells positive DAPI marker. phenotypes must based markers (e.g. CD3,CD4), rather names cells (e.g. cytotoxic T cells). names cells can added later using define_celltypes function. following cell properties columns also required present InForm input file: Entire Cell Area (pixels), Nucleus Area (pixels), Nucleus Compactness, Nucleus Axis Ratio, Entire Cell Axis Ratio. present users’ data, can columns NAs. read InForm data, need specify following parameters: format: “INFORM” path: path raw InForm image data file markers: names markers used OPAL staining. must order marker columns input file, InForm must match marker name used input file. One markers must DAPI. locations: locations markers cells, either Nucleus, Cytoplasm Membrane. must order markers. locations used auto-detect intensity (dye) columns. small example InForm input included SPIAT (see ) containing dummy marker intensity values required columns. example file just demonstrating importing raw data file, later Example data section load larger preformatted dataset. Users also welcome use formatting option closer format files Alternatively, rather specifying locations, can also specify specific intensity columns intensity_columns_interest shown .","code":"raw_inform_data <- system.file(\"extdata\", \"tiny_inform.txt.gz\", package = \"SPIAT\") head(raw_inform_data) ## [1] \"/Library/Frameworks/R.framework/Versions/4.1/Resources/library/SPIAT/extdata/tiny_inform.txt.gz\" markers <- c(\"DAPI\", \"CD3\", \"PDL-1\", \"CD4\", \"CD8\", \"AMACR\") locations <- c(\"Nucleus\", \"Cytoplasm\", \"Membrane\", \"Cytoplasm\", \"Cytoplasm\", \"Cytoplasm\") #maybe you no longer need this if we are using the general format? formatted_image <- format_image_to_sce(                           format=\"INFORM\",                           path=raw_inform_data,                           markers=markers,                           locations=locations) raw_inform_data <- system.file(\"extdata\", \"tiny_inform.txt.gz\", package = \"SPIAT\") markers <- c(\"DAPI\", \"CD3\", \"PD-L1\", \"CD4\", \"CD8\", \"AMACR\") intensity_columns_interest <- c(   \"Nucleus DAPI (DAPI) Mean (Normalized Counts, Total Weighting)\",   \"Cytoplasm CD3 (Opal 520) Mean (Normalized Counts, Total Weighting)\",    \"Membrane PDL-1 (Opal 540) Mean (Normalized Counts, Total Weighting)\",   \"Cytoplasm CD4 (Opal 620) Mean (Normalized Counts, Total Weighting)\",   \"Cytoplasm CD8 (Opal 650) Mean (Normalized Counts, Total Weighting)\",    \"Cytoplasm AMACR (Opal 690) Mean (Normalized Counts, Total Weighting)\"   ) formatted_image <- format_image_to_sce(                           format=\"INFORM\",                           path=raw_inform_data,                           markers=markers,                     intensity_columns_interest=intensity_columns_interest)"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"reading-in-data-from-halo","dir":"Articles","previous_headings":"Tutorial > Reading in data and basic data formatting in SPIAT > Reading in data pre-formatted by other software","what":"Reading in data from HALO","title":"Overview of the SPIAT package","text":"read data HALO, need table file generated HALO, lists marker intensities. biggest difference InForm HALO formats coding cell phenotypes. InForm encodes phenotypes combination positive markers (e.g. “CD3,CD4”), HALO uses binary system 1 cell positive marker 0 otherwise. format_image_to_sce collapses HALO encoded phenotypes INFORM-like format create Phenotype column. example, HALO assigned cell marker status 1 CD3 1 CD4, SPIAT give Phenotype “CD3,CD4.” Cells marker status 1 DAPI marker, given phenotype “.” format_image_to_sce takes average HALO X min X max columns cell create Cell.X.Position column. takes average Y min Y max create Cell.Y.Position column. read HALO data, need specify following parameters: format: “HALO” path: path raw HALO image data file markers: names markers used OPAL staining. must order marker columns input file, HALO must match marker name used input file. One markers must DAPI. locations: locations markers cells, either Nucleus, Cytoplasm Membrane. must order markers. locations used auto-detect intensity (dye) columns. Users can specify locations auto-detect columns shown INFORM. Alternatively, users want specify columns instead, can intensity_columns_interest, shown example . Note also must specify dye_columns_interest. following cell properties columns required present HALO input file: Cell Area, Nucleus Area, Cytoplasm Area.","code":"raw_halo_data <- \"path/to/halo/file\" markers <- c(\"DAPI\", \"CD3\", \"PDL-1\", \"CD4\", \"CD8\", \"AMACR\") intensity_columns_interest <- c(\"Dye 1 Nucleus Intensity\",                                 \"Dye 2 Cytoplasm Intensity\",                                 \"Dye 3 Membrane Intensity\",                                 \"Dye 4 Cytoplasm Intensity\",                                 \"Dye 5 Cytoplasm Intensity\",                                 \"Dye 6 Cytoplasm Intensity\") dye_columns_interest <- c(\"Dye 1 Positive Nucleus\",                           \"Dye 2 Positive Cytoplasm\",                           \"Dye 3 Positive Membrane\",                           \"Dye 4 Positive Cytoplasm\",                           \"Dye 5 Positive Cytoplasm\",                           \"Dye 6 Positive Cytoplasm\") formatted_image <- format_image_to_sce(                           format=\"HALO\",                           path=raw_halo_data,                           markers=markers,                           intensity_columns_interest=intensity_columns_interest,                           dye_columns_interest=dye_columns_interest                           )"},{"path":[]},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"example-data","dir":"Articles","previous_headings":"Tutorial > Inspecting the SingelCellExperiment object","what":"Structure of a SPIAT SingleCellExperiment object","title":"Overview of the SPIAT package","text":"vignette use InForm data file ’s already formatted SPIAT format_image_to_sce, can load data. SingleCellExperiment format. example data 5 markers 4951 cells. assay stores intensity level every marker (rows) every cell (columns). colData stores phenotype, x y coordinates, cell properties. can check phenotypes present print_feature, print specified column data. phenotypes example data can interpreted follows: Tumour_marker = cancer cells Immune_marker1,Immune_marker2 = immune cell type 1 Immune_marker1,Immune_marker3 = immune cell type 2 Immune_marker1,Immune_marker2,Immune_marker4 = immune cell type 3 = cell types","code":"data(\"simulated_image\") class(simulated_image) ## [1] \"SingleCellExperiment\" ## attr(,\"package\") ## [1] \"SingleCellExperiment\" dim(simulated_image) ## [1]    5 4951 # take a look at first 5 columns assay(simulated_image)[, 1:5] ##                      Cell_1       Cell_2      Cell_3       Cell_4       Cell_5 ## Tumour_marker  4.466925e-01 1.196802e-04 0.235435887 1.125552e-01 1.600443e-02 ## Immune_marker1 1.143640e-05 4.360881e-19 0.120582510 2.031554e-13 1.685832e-01 ## Immune_marker2 1.311175e-15 5.678623e-02 0.115769761 5.840184e-12 9.025254e-05 ## Immune_marker3 6.342341e-09 2.862823e-06 0.053107792 6.289501e-04 4.912962e-13 ## Immune_marker4 2.543406e-04 4.702311e-04 0.005878394 4.582812e-03 2.470984e-03 # take a look at first 5 rows colData(simulated_image)[1:5, ] ## DataFrame with 5 rows and 3 columns ##          Phenotype Cell.X.Position Cell.Y.Position ##        <character>       <numeric>       <numeric> ## Cell_1       OTHER        139.7748         86.7041 ## Cell_2       OTHER         77.8672         80.0965 ## Cell_3       OTHER         84.4463         19.2386 ## Cell_4       OTHER        110.1986          5.6560 ## Cell_5       OTHER        167.8956        171.9264 print_feature(simulated_image, feature_colname = \"Phenotype\") ## [1] \"OTHER\"                                        ## [2] \"Immune_marker1,Immune_marker2\"                ## [3] \"Tumour_marker\"                                ## [4] \"Immune_marker1,Immune_marker2,Immune_marker4\" ## [5] \"Immune_marker1,Immune_marker3\""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"nomenclature","dir":"Articles","previous_headings":"Tutorial > Inspecting the SingelCellExperiment object","what":"Nomenclature","title":"Overview of the SPIAT package","text":"SPIAT define markers proteins whose levels queried OPAL, CODEX another platform. Examples markers “AMACR” prostate cancer cells, “panCK” epithelial tumor cells, “CD3” T cells “CD20” B cells. combination markers results specific cell phenotype. example, cell positive “CD3” “CD4” markers “CD3,CD4” cell phenotype. Finally, define cell type name assigned user cell phenotype. example, user can name “CD3,CD4” cells “helper T cells.” refer “helper T cells” therefore cell type.","code":""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"splitting-images","dir":"Articles","previous_headings":"Tutorial > Inspecting the SingelCellExperiment object","what":"Splitting images","title":"Overview of the SPIAT package","text":"case large images, images two independent tissue sections, recommended split images sections defined user. can performed image_splitter format_image_to_sce.","code":"split_image <- image_splitter(simulated_image, number_of_splits=3, plot = FALSE)"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"predicting-cell-phenotypes","dir":"Articles","previous_headings":"Tutorial > Inspecting the SingelCellExperiment object","what":"Predicting cell phenotypes","title":"Overview of the SPIAT package","text":"SPIAT can predict cell phenotypes using marker intensity levels predict_phenotypes. can used check phenotypes assigned InForm HALO. can also potentially used automate manual phenotypying performed InForm/HALO. underlying algorithm based density distribution marker intensities. found algorithm perform best OPAL data, well identifying clearly distinct cell types MIBI CODEX datasets. algorithm take account cell shape size, required phenotyping, using HALO InForm machine-learning best method recommended. predict_phenotypes produces density plot shows cutoff calling cell positive marker. also prints console number true positives (TP), true negatives (TN), false positives (FP) false negatives (FN). returns table containing phenotypes predicted SPIAT actual phenotypes InForm/HALO (available).      can use marker_prediction_plot plot predicted cell phenotypes ones obtained using HALO InForm, comparison.  plot shows Immune_marker1+ cells tissue. left Immune_marker1+ cells defined InForm right Immune_marker1+ cells predicted using SPIAT. Similar plots generated markers. example, following plots Tumour_marker.  next example shows replace original phenotypes predicted ones. Note tutorial, still use original phenotypes.","code":"predicted_image <- predict_phenotypes(sce_object = simulated_image,                                       thresholds = NULL,                                       tumour_marker = \"Tumour_marker\",                                       baseline_markers = c(\"Immune_marker1\", \"Immune_marker2\", \"Immune_marker3\", \"Immune_marker4\"),                                       reference_phenotypes = TRUE) ## [1] \"Tumour_marker\" ## [1] \"Immune_marker1\" ## [1] \"Immune_marker2\" ## [1] \"Immune_marker3\" ## [1] \"Immune_marker4\" marker_prediction_plot(predicted_image, marker=\"Immune_marker1\") marker_prediction_plot(predicted_image, marker=\"Tumour_marker\") predicted_image2 <- predict_phenotypes(sce_object = simulated_image,                                       thresholds = NULL,                                       tumour_marker = \"Tumour_marker\",                                       baseline_markers = c(\"Immune_marker1\", \"Immune_marker2\", \"Immune_marker3\", \"Immune_marker4\"),                                       reference_phenotypes = FALSE) ## [1] \"Tumour_marker  threshold intensity:  0.445450443784465\" ## [1] \"Immune_marker1  threshold intensity:  0.116980867970434\" ## [1] \"Immune_marker2  threshold intensity:  0.124283809517202\" ## [1] \"Immune_marker3  threshold intensity:  0.0166413130263845\" ## [1] \"Immune_marker4  threshold intensity:  0.00989731350898589\""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"specifying-cell-types","dir":"Articles","previous_headings":"Tutorial > Inspecting the SingelCellExperiment object","what":"Specifying cell types","title":"Overview of the SPIAT package","text":"SPIAT can define cell types define_celltypes function. default column called Cell.Type. Note needs specified user.","code":"formatted_image <- define_celltypes(simulated_image,                                      categories = c(\"Tumour_marker\", \"Immune_marker1,Immune_marker2\", \"Immune_marker1,Immune_marker3\",                                                     \"Immune_marker1,Immune_marker2,Immune_marker4\", \"OTHER\"),                                      category_colname = \"Phenotype\",                                     names = c(\"Tumour\", \"Immune1\", \"Immune2\",                                                \"Immune3\", \"Others\"),                                     new_colname = \"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"quality-control","dir":"Articles","previous_headings":"Tutorial","what":"Quality control","title":"Overview of the SPIAT package","text":"present quality control steps implemented SPIAT check quality phenotyping, help detect uneven staining, potential technical artefacts.","code":""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"boxplots-of-marker-intensities","dir":"Articles","previous_headings":"Tutorial > Quality control","what":"Boxplots of marker intensities","title":"Overview of the SPIAT package","text":"Phenotyping cells can verified comparing marker intensities cells labelled positive negative marker. Cells positive marker high levels marker. unclear separation marker intensities positive negative cells suggest phenotypes accurately assigned. can use marker_intensity_boxplot produce boxplot cells phenotyped positive negative marker.  Note negative cells high marker intensity, vice versa. HALO InForm use machine learning determine positive cells, strict threshold, also take account properties cell shape, nucleus size etc. general, limited overlap whiskers outlier points tolerated. However, overlapping boxplots suggests unreliable phenotyping.","code":"marker_intensity_boxplot(formatted_image, \"Immune_marker1\")"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"scatter-plots-of-marker-levels","dir":"Articles","previous_headings":"Tutorial > Quality control","what":"Scatter plots of marker levels","title":"Overview of the SPIAT package","text":"Uneven marker staining high background intensity can identified plot_cell_marker_levels. produces scatter plot intensity marker cell. relatively even across image phenotyped cells. Cells phenotyped positive particular marker excluded.","code":"plot_cell_marker_levels(formatted_image, \"Immune_marker1\")"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"heatmaps-of-marker-levels","dir":"Articles","previous_headings":"Tutorial > Quality control","what":"Heatmaps of marker levels","title":"Overview of the SPIAT package","text":"large images, also option ‘blurring’ image, image split multiple small areas, marker intensities averaged within . image blurred based num_splits parameter.","code":"plot_marker_level_heatmap(formatted_image, num_splits = 100, \"Tumour_marker\")"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"identifying-incorrect-phenotypes","dir":"Articles","previous_headings":"Tutorial > Quality control","what":"Identifying incorrect phenotypes","title":"Overview of the SPIAT package","text":"may see biologically implausible present input data using print_feature. example, cells might incorrectly typed positive two markers known co-occur single cell type. Incorrect cell phenotypes may present due low cell segmentation quality, antibody ‘bleeding’ one cell another inadequate marker thresholding. number incorrectly phenotyped cells small (<5%), advise simply removing cells (see ). higher proportion, recommend checking cell segmentation phenotyping methods, systematic problem might present.","code":""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"removing-incorrect-phenotypes","dir":"Articles","previous_headings":"Tutorial > Quality control","what":"Removing incorrect phenotypes","title":"Overview of the SPIAT package","text":"identify incorrect phenotypes want exclude can select_phenotypes. vignette work original phenotypes present formatted_image.","code":"data_subset <- select_celltypes(formatted_image, keep=TRUE,                                 celltypes = c(\"Tumour_marker\",\"Immune_marker1,Immune_marker3\", \"Immune_marker1,Immune_marker2\",                                              \"Immune_marker1,Immune_marker2,Immune_marker4\"),                                 feature_colname = \"Phenotype\") print_feature(data_subset, feature_colname = \"Phenotype\") ## [1] \"Immune_marker1,Immune_marker2\"                ## [2] \"Tumour_marker\"                                ## [3] \"Immune_marker1,Immune_marker2,Immune_marker4\" ## [4] \"Immune_marker1,Immune_marker3\""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"marker-permutation","dir":"Articles","previous_headings":"Tutorial > Quality control","what":"Marker permutation","title":"Overview of the SPIAT package","text":"can use marker_permutation help identify incorrect cell phenotypes present. permutes marker labels cells create null distribution, calculates empirical p-value whether image enriched depleted particular combination markers. low P value Depletion.p suggests phenotype might unreliable. Note, however, approach replace priori known biological knowledge interpreted conjuction expert biologists.","code":"# permute marker labels of cells sig <- marker_permutation(formatted_image, num_iter = 100)  # sort by Observed_cell_number sig.sorted <- sig[order(-sig$Observed_cell_number), ]  # take a look head(sig.sorted) ##                                              Observed_cell_number ## Tumour_marker                                                 819 ## Immune_marker1,Immune_marker2,Immune_marker4                  630 ## Immune_marker1,Immune_marker2                                 338 ## Immune_marker1,Immune_marker3                                 178 ## Immune_marker1                                                  0 ## Immune_marker2                                                  0 ##                                              Percentage_of_iterations_where_present ## Tumour_marker                                                                   100 ## Immune_marker1,Immune_marker2,Immune_marker4                                    100 ## Immune_marker1,Immune_marker2                                                   100 ## Immune_marker1,Immune_marker3                                                   100 ## Immune_marker1                                                                  100 ## Immune_marker2                                                                  100 ##                                              Average_bootstrap_cell_number ## Tumour_marker                                                       426.59 ## Immune_marker1,Immune_marker2,Immune_marker4                         22.32 ## Immune_marker1,Immune_marker2                                       157.56 ## Immune_marker1,Immune_marker3                                        24.05 ## Immune_marker1                                                      647.16 ## Immune_marker2                                                      524.78 ##                                              Enrichment.p Depletion.p ## Tumour_marker                                        0.01        1.00 ## Immune_marker1,Immune_marker2,Immune_marker4         0.01        1.00 ## Immune_marker1,Immune_marker2                        0.01        1.00 ## Immune_marker1,Immune_marker3                        0.01        1.00 ## Immune_marker1                                       1.00        0.01 ## Immune_marker2                                       1.00        0.01"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"dimensionality-reduction-to-identify-missclassified-cells","dir":"Articles","previous_headings":"Tutorial > Quality control","what":"Dimensionality reduction to identify missclassified cells","title":"Overview of the SPIAT package","text":"can also check specific missclassified cells using dimensionality reduction. SPIAT offers tSNE UMAPs based marker intensities visualize cells. Cells distinct types forming clearly different clusters. generated dimensionality reduction plots interactive, users can hover cell obtain cell ID. Users can remove specific missclassified cells. Note dimensionality_reduction_plot prints umap tsne plot. user wants interactive plot, can pass result ggplotly function plotly package. plot shows four clear clusters based marker intensities. consistent cell definition marker combinations “Phenotype” column. interactive TSNE plot allows users hover cursor misclassified cells see cell IDs. example, Cell_3302, Cell_4917, Cell_2297, Cell_488, Cell_4362, Cell_4801, Cell_2220 obviously misclassified according plot. can use select_celltypes delete misclassified cells. plot TSNE . time clusters even better previous one.","code":"predicted_image2 <-    define_celltypes(predicted_image2,                     categories = c(\"Tumour_marker\", \"Immune_marker1,Immune_marker2\",                                   \"Immune_marker1,Immune_marker3\",                                    \"Immune_marker1,Immune_marker2,Immune_marker4\"),                     category_colname = \"Phenotype\",                    names = c(\"Tumour\", \"Immune1\", \"Immune2\",  \"Immune3\"),                    new_colname = \"Cell.Type\")  # Delete cells with unrealistic marker combinations from the dataset predicted_image2 <- select_celltypes(predicted_image2, \"Undefined\",                                       feature_colname = \"Cell.Type\", keep = FALSE)  # TSNE plot g <- dimensionality_reduction_plot(predicted_image2, plot_type = \"TSNE\", feature_colname = \"Cell.Type\")  plotly::ggplotly(g) predicted_image2 <- select_celltypes(predicted_image2, c(\"Cell_3302\", \"Cell_4917\", \"Cell_2297\", \"Cell_488\", \"Cell_4362\", \"Cell_4801\", \"Cell_2220\"), feature_colname = \"rowname\", keep = FALSE) # TSNE plot g <- dimensionality_reduction_plot(predicted_image2, plot_type = \"TSNE\", feature_colname = \"Cell.Type\")  plotly::ggplotly(g)"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"visualizing-tissues","dir":"Articles","previous_headings":"Tutorial","what":"Visualizing tissues","title":"Overview of the SPIAT package","text":"addition marker level tissue plots QC, SPIAT methods visualizing markers phenotypes tissues.","code":""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"categorical-dot-plot","dir":"Articles","previous_headings":"Tutorial > Visualizing tissues","what":"Categorical dot plot","title":"Overview of the SPIAT package","text":"can see location cell types (column data) tissue plot_cell_basic. dot plot corresponds cell cells coloured cell type. cell types present data cell types interest put category “” coloured lightgrey.","code":"my_colors <- c(\"red\", \"blue\", \"darkcyan\", \"darkgreen\")    plot_cell_categories(formatted_image, c(\"Tumour\", \"Immune1\", \"Immune2\", \"Immune3\"),                       my_colors, \"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"d-surface-plot","dir":"Articles","previous_headings":"Tutorial > Visualizing tissues","what":"3D surface plot","title":"Overview of the SPIAT package","text":"can visualize selected marker 3D marker_surface_plot. image blurred based num_splits parameter.","code":"marker_surface_plot(formatted_image, num_splits=15, marker=\"Immune_marker1\")"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"d-stacked-surface-plot","dir":"Articles","previous_headings":"Tutorial > Visualizing tissues","what":"3D stacked surface plot","title":"Overview of the SPIAT package","text":"visualize multiple markers 3D single plot can use marker_surface_plot_stack. shows normalized intensity level specified markers enables identification co-occurring mutually exclusive markers. stacked surface plots Tumour_marker (tumour cell) Immune_marker1 (T cell) markers prostate tissue shows Tumour_marker Immune_marker1 mutually exclusive peaks valleys opposite.","code":"marker_surface_plot_stack(formatted_image, num_splits=15, markers=c(\"Tumour_marker\", \"Immune_marker1\"))"},{"path":[]},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"cell-percentages","dir":"Articles","previous_headings":"Tutorial > Basic analyses","what":"Cell percentages","title":"Overview of the SPIAT package","text":"can obtain number proportion cell type calculate_cell_proportions. can use reference_celltypes specify cell types use reference. example, “Total” calculate proportion cell type cells. can exclude cell types interest e.g. “Undefined” celltypes_to_exclude.  Alternatively, can also visualize cell type proportions barplots using plot_cell_percentages.","code":"p_cells <- calculate_cell_proportions(formatted_image,                                        reference_celltypes=NULL,                                        feature_colname =\"Cell.Type\",                                       celltypes_to_exclude = \"Others\",                                       plot.image = TRUE) p_cells ##   Cell_type Number_of_celltype Proportion Percentage Proportion_name ## 5    Tumour                819 0.41679389  41.679389          /Total ## 3   Immune3                630 0.32061069  32.061069          /Total ## 1   Immune1                338 0.17201018  17.201018          /Total ## 2   Immune2                178 0.09058524   9.058524          /Total plot_cell_percentages(cell_proportions = p_cells,                        cells_to_exclude = \"Tumour\", cellprop_colname=\"Proportion_name\")"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"cell-distances","dir":"Articles","previous_headings":"Tutorial > Basic analyses","what":"Cell distances","title":"Overview of the SPIAT package","text":"can calculate pairwise distances two cell types (cell type cell type B) calculate_pairwise_distances_between_cell_types. function returns data.frame contains pairwise distances cell cell type cell type B. pairwise distances can visualized violin plot plot_cell_distances_violin.  can also calculate summary statistics distances combination cell types, mean, median, min, max standard deviation, calculate_summary_distances_between_cell_types. pair-wise cell distances can visualized heatmap plot_distance_heatmap. example shows average pairwise distances cell types.  plot shows Tumour cells interacting closely Tumour cells Immune3 cells. can also calculate minimum distances cell types calculate_minimum_distances_between_cell_types. minimum distances can visualized violin plot plot_cell_distances_violin. Visualization distribution often reveals whether pairs cells evenly spaced across image, whether clusters pairs cell types.  can also calculate summary statistics distances combination cell types, mean, median, min, max standard deviation, calculate_summary_distances_between_cell_types. Similarly, summary statistics minimum distances can also visualised heatmap. example shows average minimum distance cell types.","code":"distances <- calculate_pairwise_distances_between_celltypes(formatted_image,                                                      cell_types_of_interest = c(\"Tumour\", \"Immune1\", \"Immune3\"),                                                     feature_colname = \"Cell.Type\") plot_cell_distances_violin(distances) summary_distances <- calculate_summary_distances_between_celltypes(distances) plot_distance_heatmap(summary_distances, metric = \"mean\") min_dist <- calculate_minimum_distances_between_celltypes(   formatted_image,    cell_types_of_interest = c(\"Tumour\", \"Immune1\", \"Immune2\",\"Immune3\", \"Others\"),   feature_colname = \"Cell.Type\") ## [1] \"Markers had been selected in pair-wise distance calculation: \" ## [1] \"Others\"  \"Immune1\" \"Tumour\"  \"Immune3\" \"Immune2\" plot_cell_distances_violin(min_dist) min_summary_dist <- calculate_summary_distances_between_celltypes(min_dist) plot_distance_heatmap(min_summary_dist, metric = \"mean\")"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"cell-colocalization","dir":"Articles","previous_headings":"Tutorial","what":"Cell colocalization","title":"Overview of the SPIAT package","text":"SPIAT can quantify cell colozalization, refers much two cell types colocalizing thus potentially interacting.","code":""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"cells-in-neighbourhood-cin","dir":"Articles","previous_headings":"Tutorial > Cell colocalization","what":"Cells In Neighbourhood (CIN)","title":"Overview of the SPIAT package","text":"can calculate average percentage cells one cell type (target) within radius another cell type (reference) using average_percentage_of_cells_within_radius. Alternatively, analysis can also performed based marker intensities rather cell types. , use average_marker_intensity_within_radius calculate average intensity target_marker within radius cells positive reference marker. Note pools cells target marker within specific radius reference cell. Results represent average intensities within radius. help identify suitable radii average_percentage_of_cells_within_radius average_marker_intensity_within_radius users can use plot_average_intensity. function calculates average intensity target marker number user-supplied radii values, plots intensity level specified radius line graph. radius unit pixels.  plot shows high levels Immune_marker3 observed cells near Immune_marker2 cells levels decreased larger radii. suggests Immune_marker2 Immune_marker3 cells may closely interacting tissue.","code":"average_percentage_of_cells_within_radius(formatted_image,                                            reference_celltype = \"Immune1\",                                            target_celltype = \"Immune2\",                                            radius=100, feature_colname=\"Cell.Type\") ## [1] 4.768123 average_marker_intensity_within_radius(formatted_image,                                         reference_marker =\"Immune_marker3\",                                         target_marker = \"Immune_marker2\",                                         radius=30) ## [1] 0.5995357 plot_average_intensity(formatted_image, reference_marker=\"Immune_marker3\",                         target_marker=\"Immune_marker2\", c(30, 35, 40, 45, 50, 75, 100))"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"mixing-score-ms-and-normalized-mixing-score-nms","dir":"Articles","previous_headings":"Tutorial > Cell colocalization","what":"Mixing Score (MS) and Normalized Mixing Score (NMS)","title":"Overview of the SPIAT package","text":"score originally defined number immune-tumor interactions divided number immune-immune interactions (Keren et al. 2018). SPIAT generalizes method user-defined pair cell types. mixing_score_summary returns mixing score reference cell type target cell type. mixing score defined number target-reference interactions/number reference-reference interactions within specified radius. higher score greater mixing two cell types. normalized score normalized number target reference cells image.","code":"mixing_score_summary(formatted_image, reference_celltype = \"Immune1\",                       target_celltype = \"Immune2\", radius=100, feature_colname =\"Cell.Type\") ##   Reference  Target Number_of_reference_cells Number_of_target_cells ## 2   Immune1 Immune2                       338                    178 ##   Reference_target_interaction Reference_reference_interaction Mixing_score ## 2                          583                            1184    0.4923986 ##   Normalised_mixing_score ## 2                1.864476"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"cross-k-function","dir":"Articles","previous_headings":"Tutorial > Cell colocalization","what":"Cross K function","title":"Overview of the SPIAT package","text":"Cross K function calculates number target cell types across range raddi reference cell type, compares behaviour input image image randomly distributed points using Poisson point process. 4 patterns can distinguished K-cross function, illustrated plots . (taken April 2021).  , black line represents input image, red line represents randomly distributed point pattern. 1st plot: red line black line close , meaning two types points randomly independently distributed. 2nd plot: red line black line, large difference middle plot, meaning points mixed split clusters. 3rd plot: increase radius, black line diverges red line, meaning one mixed cluster two types points. 4th plot: red line black line, meaning two types points form separated clusters. can calculate cross K-function using SPIAT.  can calculate area curve (AUC) cross K-function. general, tells us two types cells : negative values: separate clusters positive values: mixing cell types AUC score close zero tells us two types cells either relationship form ring surrounding cluster.","code":"df_cross <- calculate_cross_functions(formatted_image, method = \"Kcross\",                                        cell_types_of_interest = c(\"Tumour\",\"Immune3\"),                                        feature_colname =\"Cell.Type\",                                       dist = 100) AUC_of_cross_function(df_cross) ## [1] 0.07372797"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"cross-k-intersection-cki","dir":"Articles","previous_headings":"Tutorial > Cell colocalization","what":"Cross-K Intersection (CKI)","title":"Overview of the SPIAT package","text":"another pattern cross K curve previously appreciated, “ring” one cell type surrounding area another cell type. pattern, observed expected curves cross K function cross intersect. observed crossing many example images rings exist. However, crossing exclusively present ring images. separate clusters two cell types close, crossing can also happen low distance. images infiltration, crossing may also happen extremely low distance due randomness. use crossing metric indicating ring pattern, need choose reasonable distance cross K function (generally quarter half image size, also consider cluster size), filter extremely low crossing distance. result shows crossing happens 50% specified distance (100) cross K function, close edge tumour cluster. means crossing due randomness cell distribution, due two close located immune tumour clusters. result aligns observation immune ring surrounding tumour cluster.","code":"crossing_of_crossK(df_cross) ## [1] \"Crossing of cross K function is detected for this image, indicating a potential immune ring.\" ## [1] \"The crossing happens at the 50 % of the specified distance.\" ## [1] 0.5"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"spatial-heterogeneity","dir":"Articles","previous_headings":"Tutorial","what":"Spatial heterogeneity","title":"Overview of the SPIAT package","text":"Cell colocalization metrics allow capturing dominant spatial pattern image. However, patterns unlikely distributed evenly tissue, rather spatial heterogeneity patterns. measure , SPIAT splits image smaller images (either using grid concentric circles around reference cell population), followed calculation spatial metric pattern interest (e.g. cell colocalization, entropy), measures Prevalance Distinctiveness pattern.","code":""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"localized-entropy","dir":"Articles","previous_headings":"Tutorial > Spatial heterogeneity","what":"Localized Entropy","title":"Overview of the SPIAT package","text":"Entropy spatial analysis refers balance number cells distinct populations. entropy score can obtained entire image. However, entropy one image provide us spatial information image. therefore propose concept Localised Entropy, calculates entropy score predefined local region. local regions can calculated defined next two sections.","code":"calculate_entropy(formatted_image, cell_types_of_interest = c(\"Immune1\",\"Immune2\"),                    feature_colname = \"Cell.Type\") ## [1] 0.9294873"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"fish-net-grid","dir":"Articles","previous_headings":"Tutorial > Spatial heterogeneity","what":"Fish net grid","title":"Overview of the SPIAT package","text":"One approach calculate localised metric split image “fish-net” grid squares. grid square, grid_metrics calculate metric square visualise raster image. Users can choose metric localised metric. use entropy example. calculating localised entropy, can apply metrics like percentages grid squares patterns (Prevalence) Moran’s (Distinctiveness). selection threshold depends pattern metric user chooses find localised pattern. chose 0.75 entropy 0.75 roughly entropy two cell types ratio 1:5 5:1.","code":"grid <- grid_metrics(defined_image, FUN = calculate_entropy, n_split = 20,                      cell_types_of_interest=c(\"Tumour\",\"Immune3\"),                       feature_colname = \"Cell.Type\") calculate_percentage_of_grids(grid, threshold = 0.75, above = TRUE) ## [1] 13 calculate_spatial_autocorrelation(grid, metric = \"globalmoran\") ## [1] 0.09446964"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"gradients-based-on-concentric-circles","dir":"Articles","previous_headings":"Tutorial > Spatial heterogeneity","what":"Gradients (based on concentric circles)","title":"Overview of the SPIAT package","text":"can use gradient function calculate metrics (entropy, mixing score, percentage cells within radius, marker intensity) range radii reference cells. , increasing circle reference cell drawn score calculated cells within circle. result gradient function shows list data.frames specified radii. data.frame, rows represent cells cell type first position cell_types_of_interest arg - reference cells. reference cells cells circles drawn upon. last column data.frame entropy calculated cells circle reference cell. specify metric want calculate FUN=. However, integrated use entropy metric gradient computation function - entropy_gradient_aggregated. function, instead resulting data frames metrics circle (reference cell), result contains overall entropy score aggregating entropy reference cells.","code":"gradient_positions <- c(30, 50, 100) gradient_entropy <-    compute_gradient(defined_image, radii = gradient_positions,                     FUN = calculate_entropy,  cell_types_of_interest = c(\"Immune1\",\"Immune2\"),                    feature_colname = \"Cell.Type\") length(gradient_entropy) ## [1] 3 head(gradient_entropy[[1]]) ##         Cell.X.Position Cell.Y.Position Immune1 Immune2 total Immune1_log2 ## Cell_15       109.67027        17.12956       1       0     1            0 ## Cell_25       153.22795       128.29915       1       0     1            0 ## Cell_30        57.29037        49.88533       1       0     1            0 ## Cell_48        83.47798       295.75058       2       0     2            1 ## Cell_56        35.24227       242.84862       1       0     1            0 ## Cell_61       156.39943       349.08154       2       0     2            1 ##         Immune2_log2 total_log2 Immune1ratio Immune1_entropy Immune2ratio ## Cell_15            0          0            1               0            0 ## Cell_25            0          0            1               0            0 ## Cell_30            0          0            1               0            0 ## Cell_48            0          1            1               0            0 ## Cell_56            0          0            1               0            0 ## Cell_61            0          1            1               0            0 ##         Immune2_entropy entropy ## Cell_15               0       0 ## Cell_25               0       0 ## Cell_30               0       0 ## Cell_48               0       0 ## Cell_56               0       0 ## Cell_61               0       0 gradient_pos <- seq(50, 500, 50) ##radii gradient_results <- entropy_gradient_aggregated(SPIAT::defined_image, cell_types_of_interest = c(\"Immune3\",\"Tumour\"),                                                 feature_colname = \"Cell.Type\", radii = gradient_pos) # plot the results plot(1:10,gradient_results$gradient_df[1, 3:12])"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"characterizing-the-immune-microenvironment-relative-to-the-tumor-margin","dir":"Articles","previous_headings":"Tutorial","what":"Characterizing the immune microenvironment relative to the tumor margin","title":"Overview of the SPIAT package","text":"certain analysis focus understanding spatial distribution immune populations relative tumor margin. SPIAT includes methods determine whether clear tumor margin, automatically identify tumor margin, finally quantify proportion immune populations relative margin.","code":""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"determining-whether-there-is-a-clear-tumor-margin","dir":"Articles","previous_headings":"Tutorial > Characterizing the immune microenvironment relative to the tumor margin","what":"Determining whether there is a clear tumor margin","title":"Overview of the SPIAT package","text":"instances tumor cells distributed way clear tumor margins. can derived intuitively cases, SPIAT offers way quantifying ‘quality’ margin downstream analyses. meant used help flag images relatively poor margins, therefore offer cutoff value. determine clear tumour margin, SPIAT can calculate ratio tumour bordering cells tumour total cells (R-BT). ratio high disproportional high number tumor mangin cells compared internal tumor cells.  result 0.2014652. low value means relatively low number bordering cells compared total tumor cells, meaning image clear tumor margins.","code":"R_BT(formatted_image, cell_type_of_interest = \"Tumour\", \"Cell.Type\") ## [1] 0.2014652"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"automatic-identification-of-the-tumor-margin","dir":"Articles","previous_headings":"Tutorial > Characterizing the immune microenvironment relative to the tumor margin","what":"Automatic identification of the tumor margin","title":"Overview of the SPIAT package","text":"can identify borders identify_bordering_cells. uses alpha hull method (Pateiro-Lopez, Rodriguez-Casal, . 2019) via alphahull package. use tumour cells (Tumour_marker) reference identify bordering cells cell type can used.","code":"formatted_border <- identify_bordering_cells(formatted_image,                                               reference_cell = \"Tumour\",                                               feature_colname=\"Cell.Type\") ## [1] \"The alpha of Polygon is: 63.24375\""},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"classification-of-cells-relative-to-their-location-to-the-margin","dir":"Articles","previous_headings":"Tutorial > Characterizing the immune microenvironment relative to the tumor margin","what":"Classification of cells relative to their location to the margin","title":"Overview of the SPIAT package","text":"can define four locations relative margin based distances: “Internal margin,” “External margin,” “Outside” “Inside.” Specifically, define area within specified distance margin either “Internal margin” (bordering margin, inside tumor area) “External margin” (bordering margin, surrounding tumor area). areas located away specified distance margin defined “Inside” (.e. tumor area) “Outside” (.e. tumor area). First, calculate distance cells tumor margin. Next, classify cells based location. distance cutoff, use distance 5 cells tumor margin. function first calculates average minimum distance pairs nearest cells multiple number 5. Users can change number cell layers increase/decrease margin width. can plot colour structure categories.  can also calculate proportion immune cells locations. Finally, can calculate summaries distances immune cells tumour structure.","code":"formatted_distance <- calculate_distance_to_tumour_margin(formatted_border) ## [1] \"Markers had been selected in pair-wise distance calculation: \" ## [1] \"Non-border\" \"Border\" names_of_immune_cells <- c(\"Immune1\", \"Immune2\",\"Immune3\")  formatted_structure <- define_structure(formatted_distance,                                          names_of_immune_cells = names_of_immune_cells,                                          feature_colname = \"Cell.Type\",                                         n_margin_layers = 5)  categories <- print_feature(formatted_structure, \"Structure\") ## [1] \"Outside\"                \"Stromal.immune\"         \"Internal.margin\"        ## [4] \"Border\"                 \"External.margin.immune\" \"Internal.margin.immune\" ## [7] \"External.margin\"        \"Inside\"                 \"Infiltrated.immune\" plot_cell_categories(formatted_structure, feature_colname = \"Structure\") immune_proportions <- calculate_proportions_of_cells_in_structure(formatted_structure, cell_types_of_interest = names_of_immune_cells, feature_colname =\"Cell.Type\")  immune_proportions ##                Cell.Type                            Relative_to ## 1                Immune1             All_cells_in_the_structure ## 2                Immune2             All_cells_in_the_structure ## 3                Immune3             All_cells_in_the_structure ## 4                Immune1 All_cells_of_interest_in_the_structure ## 5                Immune2 All_cells_of_interest_in_the_structure ## 6                Immune3 All_cells_of_interest_in_the_structure ## 7                Immune1  The_same_cell_type_in_the_whole_image ## 8                Immune2  The_same_cell_type_in_the_whole_image ## 9                Immune3  The_same_cell_type_in_the_whole_image ## 10 All_cells_of_interest             All_cells_in_the_structure ##    P.Infiltrated.Immune P.Internal.Margin.Immune P.External.Margin.Immune ## 1            0.00000000               0.00000000              0.005494505 ## 2            0.00000000               0.00000000              0.005494505 ## 3            0.14385965               0.08780488              2.159340659 ## 4            0.00000000               0.00000000              0.002531646 ## 5            0.00000000               0.00000000              0.002531646 ## 6            1.00000000               1.00000000              0.994936709 ## 7            0.00000000               0.00000000              0.002958580 ## 8            0.00000000               0.00000000              0.005617978 ## 9            0.06507937               0.05714286              0.623809524 ## 10           0.14385965               0.08780488              2.170329670 ##    P.Stromal.Immune ## 1        0.11971581 ## 2        0.06287744 ## 3        0.05683837 ## 4        0.50000000 ## 5        0.26261128 ## 6        0.23738872 ## 7        0.99704142 ## 8        0.99438202 ## 9        0.25396825 ## 10       0.23943162 immune_distances <- calculate_summary_distances_of_cells_to_borders(formatted_structure, cell_types_of_interest = names_of_immune_cells, \"Cell.Type\")  immune_distances ##                    Cell.Type       Area    Min_d    Max_d    Mean_d  Median_d ## 1 All_cell_types_of_interest Tumor_area 10.93225 192.4094  86.20042  88.23299 ## 2 All_cell_types_of_interest     Stroma 10.02387 984.0509 218.11106 133.18220 ## 3                    Immune1 Tumor_area      Inf     -Inf       NaN        NA ## 4                    Immune1     Stroma 84.20018 970.7749 346.14096 301.01535 ## 5                    Immune2 Tumor_area      Inf     -Inf       NaN        NA ## 6                    Immune2     Stroma 79.42753 984.0509 333.26374 284.09062 ## 7                    Immune3 Tumor_area 10.93225 192.4094  86.20042  88.23299 ## 8                    Immune3     Stroma 10.02387 971.5638 102.79227  68.19218 ##    St.dev_d ## 1  45.27414 ## 2 199.87586 ## 3        NA ## 4 187.04247 ## 5        NA ## 6 185.67518 ## 7  45.27414 ## 8 131.32714"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"cellular-neighbourhoods","dir":"Articles","previous_headings":"Tutorial","what":"Cellular neighbourhoods","title":"Overview of the SPIAT package","text":"aggregation cells can result ‘cellular neighbourhoods.’ neighbourhood defined group cells cluster together. can homotypic, containing cells single class (e.g. immune cells), heterotypic (containing tumor immune cells). SPIAT can identify cellular neighbourhoods identify_neighborhoods. Users can select subset cell types interest desired. SPIAT include three algorithms detection neighbourhoods. Hierarchical Clustering algorithm: Euclidean distances cells calculated, pairs cells distance less specified raidus considered ‘interacting,’ rest ‘non-interacting.’ Hierarchical clustering used separate clusters. Larger radii result merging individual clusters. dbscan Rphenograph. Hierarchical Clustering algorithm dbscan, users need define radius defines distance interaction. suggest users test different radii select one generates intuitive clusters upon visualization. Cells assigned clusters assigned Cluster_NA output table. argument min_neighborhood_size specifies threshold neighborhood size considered neighborhood. Rphenograph uses number nearest neighbours detect clusters. number specified min_neighborhood_size argument. also suggest users test different values number. part tutorial, use image image_no_markers simulated spaSim package. image contains “Tumor,” “Immune,” “Immune1” “Immune2” cells without marker intensities.  Users recommended test different radii visualize clustering results. aid process, users can use average_minimum_distance function, calculates average minimum distance cells image, can used starting point. identify cellular neighbourhoods using heirarchical algorithm radius 50, minimum neighbourhood size 100. Cells assigned neighbourhoods smaller 100 assigned “Cluster_NA” neighbourhood.  plot shows clusters Immune, Immune1 Immune2 cells. number colour corresponds distinct cluster. Black cells correspond ‘free,’ un-clustered cells. can visualize cell composition neighborhoods. , can use composition_of_neighborhoods obtain percentages cells specific marker within neighborhood number cells neighborhood. example select cellular neighbourhoods least 5 cells. Finally, can use plot_composition_heatmap produce heatmap showing marker percentages within cluster, can used classify derived neighbourhoods.  plot shows Cluster_1 Cluster_2 contain three types immune cells. Cluster_3 Immune1 cells. Cluster_1 Cluster_2 similar free cells composition Cluster_3.","code":"data(\"image_no_markers\")  plot_cell_categories(image_no_markers, c(\"Tumour\", \"Immune\",\"Immune1\",\"Immune2\",\"Others\"),                      c(\"red\",\"blue\",\"darkgreen\", \"brown\",\"lightgray\"),\"Cell.Type\") average_minimum_distance(image_no_markers) ## [1] 17.01336 clusters <- identify_neighborhoods(image_no_markers,                                     method = \"hierarchical\",                                    min_neighborhood_size = 100,                                    cell_types_of_interest = c(\"Immune\", \"Immune1\", \"Immune2\"),                                     radius = 50, feature_colname = \"Cell.Type\") neighorhoods_vis <- composition_of_neighborhoods(clusters, feature_colname = \"Cell.Type\") neighorhoods_vis <- neighorhoods_vis[neighorhoods_vis$Total_number_of_cells >=5,] plot_composition_heatmap(neighorhoods_vis, feature_colname=\"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"reproducibility","dir":"Articles","previous_headings":"","what":"Reproducibility","title":"Overview of the SPIAT package","text":"","code":"sessionInfo() ## R version 4.1.2 (2021-11-01) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Big Sur 10.16 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ##  ## locale: ## [1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8 ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] SPIAT_0.99.0                SingleCellExperiment_1.16.0 ##  [3] SummarizedExperiment_1.24.0 Biobase_2.54.0              ##  [5] GenomicRanges_1.46.1        GenomeInfoDb_1.30.1         ##  [7] IRanges_2.28.0              S4Vectors_0.32.3            ##  [9] BiocGenerics_0.40.0         MatrixGenerics_1.6.0        ## [11] matrixStats_0.61.0          BiocStyle_2.22.0            ##  ## loaded via a namespace (and not attached): ##   [1] circlize_0.4.14        systemfonts_1.0.4      plyr_1.8.6             ##   [4] lazyeval_0.2.2         sp_1.4-6               splines_4.1.2          ##   [7] crosstalk_1.2.0        ggplot2_3.3.5          elsa_1.1-28            ##  [10] digest_0.6.29          foreach_1.5.2          htmltools_0.5.2        ##  [13] magick_2.7.3           fansi_1.0.2            magrittr_2.0.2         ##  [16] memoise_2.0.1          cluster_2.1.2          doParallel_1.0.17      ##  [19] tensor_1.5             tzdb_0.2.0             tripack_1.3-9.1        ##  [22] ComplexHeatmap_2.10.0  R.utils_2.11.0         vroom_1.5.7            ##  [25] pkgdown_2.0.2          spatstat.sparse_2.1-0  colorspace_2.0-3       ##  [28] ggrepel_0.9.1          textshaping_0.3.6      xfun_0.30              ##  [31] dplyr_1.0.8            rgdal_1.5-28           crayon_1.5.0           ##  [34] RCurl_1.98-1.6         jsonlite_1.8.0         spatstat_2.3-3         ##  [37] spatstat.data_2.1-2    iterators_1.0.14       glue_1.6.2             ##  [40] polyclip_1.10-0        gtable_0.3.0           zlibbioc_1.40.0        ##  [43] XVector_0.34.0         GetoptLong_1.0.5       DelayedArray_0.20.0    ##  [46] shape_1.4.6            apcluster_1.4.9        abind_1.4-5            ##  [49] scales_1.1.1           sgeostat_1.0-27        pheatmap_1.0.12        ##  [52] DBI_1.1.2              spatstat.random_2.1-0  Rcpp_1.0.8             ##  [55] viridisLite_0.4.0      clue_0.3-60            spatstat.core_2.4-0    ##  [58] bit_4.0.4              dittoSeq_1.6.0         htmlwidgets_1.5.4      ##  [61] httr_1.4.2             RColorBrewer_1.1-2     ellipsis_0.3.2         ##  [64] pkgconfig_2.0.3        R.methodsS3_1.8.1      farver_2.1.0           ##  [67] sass_0.4.0             deldir_1.0-6           alphahull_2.2          ##  [70] utf8_1.2.2             tidyselect_1.1.2       labeling_0.4.2         ##  [73] rlang_1.0.2            reshape2_1.4.4         munsell_0.5.0          ##  [76] tools_4.1.2            cachem_1.0.6           cli_3.2.0              ##  [79] dbscan_1.1-10          generics_0.1.2         splancs_2.01-42        ##  [82] mmand_1.6.1            ggridges_0.5.3         evaluate_0.15          ##  [85] stringr_1.4.0          fastmap_1.1.0          yaml_2.3.5             ##  [88] ragg_1.2.2             goftest_1.2-3          knitr_1.37             ##  [91] bit64_4.0.5            fs_1.5.2               purrr_0.3.4            ##  [94] RANN_2.6.1             nlme_3.1-153           R.oo_1.24.0            ##  [97] pracma_2.3.8           compiler_4.1.2         rstudioapi_0.13        ## [100] plotly_4.10.0          png_0.1-7              spatstat.utils_2.3-0   ## [103] spatstat.linnet_2.3-2  tibble_3.1.6           bslib_0.3.1            ## [106] stringi_1.7.6          highr_0.9              desc_1.4.1             ## [109] lattice_0.20-45        Matrix_1.3-4           vctrs_0.3.8            ## [112] pillar_1.7.0           lifecycle_1.0.1        BiocManager_1.30.16    ## [115] GlobalOptions_0.1.2    spatstat.geom_2.3-2    jquerylib_0.1.4        ## [118] data.table_1.14.2      cowplot_1.1.1          bitops_1.0-7           ## [121] raster_3.5-15          R6_2.5.1               bookdown_0.24          ## [124] gridExtra_2.3          codetools_0.2-18       gtools_3.9.2           ## [127] assertthat_0.2.1       rjson_0.2.21           rprojroot_2.0.2        ## [130] GenomeInfoDbData_1.2.7 mgcv_1.8-38            parallel_4.1.2         ## [133] terra_1.5-21           grid_4.1.2             rpart_4.1-15           ## [136] tidyr_1.2.0            rmarkdown_2.12         Rtsne_0.15"},{"path":"https://trigosteam.github.io/SPIAT/articles/introduction.html","id":"author-contributions","dir":"Articles","previous_headings":"","what":"Author Contributions","title":"Overview of the SPIAT package","text":", YF, TY, ML, JZ, VO, MD authors package code. MD YF wrote vignette. YF designed package.","code":""},{"path":[]},{"path":"https://trigosteam.github.io/SPIAT/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Anna Trigos. Author. Yuzhou  Feng. Author, maintainer. Tom  Yang. Author. Mabel  Li. Author. John  Zhu. Author. Volkan  Ozcoban. Author. Maria  Doyle. Author.","code":""},{"path":"https://trigosteam.github.io/SPIAT/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Yang T, Ozcoban V, Pasam , Kocovski N, Pizzolla , Huang Y, Bass G, Keam S, Neeson P, Sandhu S, Goode D, Trigos (2020). “SPIAT: R package Spatial Image Analysis Cells Tissues.” bioRxiv. doi: 10.1101/2020.05.28.122614.","code":"@Article{,   title = {SPIAT: An R package for the Spatial Image Analysis of Cells in Tissues},   author = {Tianpei Yang and Volkan Ozcoban and Anu Pasam and Nikolce Kocovski and Angela Pizzolla and Yu-Kuan Huang and Greg Bass and Simon P Keam and Paul J Neeson and Shahneen K Sandhu and David L Goode and Anna S Trigos},   journal = {bioRxiv},   year = {2020},   doi = {10.1101/2020.05.28.122614}, }"},{"path":"https://trigosteam.github.io/SPIAT/index.html","id":"spiat---spatial-image-analysis-of-tissues","dir":"","previous_headings":"","what":"Spatial Image Analysis of Tissues","title":"Spatial Image Analysis of Tissues","text":"R package analysis OPAL multiplex immunohistochemistry images.","code":""},{"path":"https://trigosteam.github.io/SPIAT/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spatial Image Analysis of Tissues","text":"","code":"# install.packages('devtools') devtools::install_github(\"TrigosTeam/SPIAT\")"},{"path":"https://trigosteam.github.io/SPIAT/index.html","id":"vignette","dir":"","previous_headings":"","what":"Vignette","title":"Spatial Image Analysis of Tissues","text":"vignette overview package can accessed top Menu Articles.","code":""},{"path":"https://trigosteam.github.io/SPIAT/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors:","title":"Spatial Image Analysis of Tissues","text":"Tianpei Yang, Volkan Ozcoban, Anu Pasam, Nikolce Kocovski, Angela Pizzolla, Yu-Kuan Huang, Greg Bass, Simon P. Keam, Paul J. Neeson, Shahneen K. Sandhu, David L. Goode, Anna S. Trigos Pre-print available: SPIAT: R package Spatial Image Analysis Cells Tissues https://www.biorxiv.org/content/10.1101/2020.05.28.122614v1","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/AUC_of_cross_function.html","id":null,"dir":"Reference","previous_headings":"","what":"The difference in AUC of the cross function curves — AUC_of_cross_function","title":"The difference in AUC of the cross function curves — AUC_of_cross_function","text":"Calculate difference area curve (AUC)   two curves, normalised total area graph.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/AUC_of_cross_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The difference in AUC of the cross function curves — AUC_of_cross_function","text":"","code":"AUC_of_cross_function(df.cross)"},{"path":"https://trigosteam.github.io/SPIAT/reference/AUC_of_cross_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The difference in AUC of the cross function curves — AUC_of_cross_function","text":"df.cross Data.frame. output calculate_cross_functions. Containing positions two curves. Columns contain \"r\", \"border\" \"theo\".","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/AUC_of_cross_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The difference in AUC of the cross function curves — AUC_of_cross_function","text":"number","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/AUC_of_cross_function.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The difference in AUC of the cross function curves — AUC_of_cross_function","text":"","code":"df_cross <- calculate_cross_functions(SPIAT::defined_image, method = \"Kcross\",               cell_types_of_interest = c(\"Tumour\",\"Immune3\"),               feature_colname =\"Cell.Type\", dist = 100)  AUC_of_cross_function(df_cross) #> [1] 0.07372797"},{"path":"https://trigosteam.github.io/SPIAT/reference/R_BT.html","id":null,"dir":"Reference","previous_headings":"","what":"The ratio of tumour border cell count and tumour cell count — R_BT","title":"The ratio of tumour border cell count and tumour cell count — R_BT","text":"Calculates ratio tumour border cell count   total tumour cell count image. tumour border cells detected   default identify_bordering_cells function.   ratio high, means tumour cells identified bordering   cells. means clear tumour clusters.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/R_BT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The ratio of tumour border cell count and tumour cell count — R_BT","text":"","code":"R_BT(sce_object, cell_type_of_interest, feature_colname)"},{"path":"https://trigosteam.github.io/SPIAT/reference/R_BT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The ratio of tumour border cell count and tumour cell count — R_BT","text":"sce_object SingleCellExperiment object generated format_image_to_sce. cell_type_of_interest String. cell type user wants determine cluster . feature_colname String. column contains cell type interest.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/R_BT.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The ratio of tumour border cell count and tumour cell count — R_BT","text":"number returned.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/R_BT.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The ratio of tumour border cell count and tumour cell count — R_BT","text":"","code":"R_BT(SPIAT::defined_image, cell_type_of_interest = \"Tumour\", \"Cell.Type\")  #> [1] 0.2014652"},{"path":"https://trigosteam.github.io/SPIAT/reference/average_marker_intensity_within_radius.html","id":null,"dir":"Reference","previous_headings":"","what":"average_marker_intensity_within_radius — average_marker_intensity_within_radius","title":"average_marker_intensity_within_radius — average_marker_intensity_within_radius","text":"Calculates average intensity target_marker within   radius cells positive reference marker. Note pools   cells target marker within specific radius   reference cell. Results represent average intensities within radius,   vector metrics cell.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_marker_intensity_within_radius.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"average_marker_intensity_within_radius — average_marker_intensity_within_radius","text":"","code":"average_marker_intensity_within_radius(   sce_object,   reference_marker,   target_marker,   radius = 20 )"},{"path":"https://trigosteam.github.io/SPIAT/reference/average_marker_intensity_within_radius.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"average_marker_intensity_within_radius — average_marker_intensity_within_radius","text":"sce_object SingleCellExperiment object form output format_image_to_sce. reference_marker String specifying marker used reference cells. target_marker String specifying marker calculate average intensity. radius Numeric specifying radius search cells around reference cells.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_marker_intensity_within_radius.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"average_marker_intensity_within_radius — average_marker_intensity_within_radius","text":"single number returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_marker_intensity_within_radius.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"average_marker_intensity_within_radius — average_marker_intensity_within_radius","text":"","code":"average_marker_intensity_within_radius(SPIAT::simulated_image,                                        reference_marker =\"Immune_marker3\",                                        target_marker = \"Immune_marker2\",                                        radius=30) #> [1] 0.5995357"},{"path":"https://trigosteam.github.io/SPIAT/reference/average_minimum_distance.html","id":null,"dir":"Reference","previous_headings":"","what":"average_minimum_distance — average_minimum_distance","title":"average_minimum_distance — average_minimum_distance","text":"Calculates average minimum distance cells   nearest cells input image.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_minimum_distance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"average_minimum_distance — average_minimum_distance","text":"","code":"average_minimum_distance(sce_object)"},{"path":"https://trigosteam.github.io/SPIAT/reference/average_minimum_distance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"average_minimum_distance — average_minimum_distance","text":"sce_object SingleCellExperiment object form output format_image_to_sce.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_minimum_distance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"average_minimum_distance — average_minimum_distance","text":"single number returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_minimum_distance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"average_minimum_distance — average_minimum_distance","text":"","code":"average_minimum_distance(SPIAT::simulated_image) #> [1] 17.01336"},{"path":"https://trigosteam.github.io/SPIAT/reference/average_nearest_neighbor_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Average nearest neighbor index for point pattern (clustering or dispersion) — average_nearest_neighbor_index","title":"Average nearest neighbor index for point pattern (clustering or dispersion) — average_nearest_neighbor_index","text":"Calculate average nearest neighbor (ANN) index   specified type cells. index indicates clustering effect   point pattern. pattern can clustering, random dispersion.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_nearest_neighbor_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Average nearest neighbor index for point pattern (clustering or dispersion) — average_nearest_neighbor_index","text":"","code":"average_nearest_neighbor_index(   sce_object,   reference_cell,   feature_colname,   p_val = 5e-06 )"},{"path":"https://trigosteam.github.io/SPIAT/reference/average_nearest_neighbor_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Average nearest neighbor index for point pattern (clustering or dispersion) — average_nearest_neighbor_index","text":"sce_object SingleCellExperiment object form output format_image_to_sce. reference_cell String. Cells type used reference cells. feature_colname String. Specify selected column `reference_cell`. p_val Numeric. p value threshold determine significance pattern.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_nearest_neighbor_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Average nearest neighbor index for point pattern (clustering or dispersion) — average_nearest_neighbor_index","text":"list pattern type p value","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_nearest_neighbor_index.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Average nearest neighbor index for point pattern (clustering or dispersion) — average_nearest_neighbor_index","text":"ANN index statistical test test presence clusters   cells, (Clark Evans, 1954). ANN index evaluates spatial   aggregation dispersion effect objects based average distances   pairs nearest objects can used test   clustering specific cell types (e.g. immune tumor cells). Next, z   score p-value ANN index calculated validate   significance pattern.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_nearest_neighbor_index.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Average nearest neighbor index for point pattern (clustering or dispersion) — average_nearest_neighbor_index","text":"","code":"average_nearest_neighbor_index(SPIAT::defined_image, \"Tumour\", \"Cell.Type\") #> $pattern #> [1] \"Clustered\" #>  #> $`p-value` #> [1] 7.11006e-32 #>"},{"path":"https://trigosteam.github.io/SPIAT/reference/average_percentage_of_cells_within_radius.html","id":null,"dir":"Reference","previous_headings":"","what":"average_percentage_of_cells_within_radius — average_percentage_of_cells_within_radius","title":"average_percentage_of_cells_within_radius — average_percentage_of_cells_within_radius","text":"Calculates average percentage cells target cell type   within radius cells reference cell type. calculation   done per reference cell, runtime depend number   reference cells present. Output single value (mean image).","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_percentage_of_cells_within_radius.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"average_percentage_of_cells_within_radius — average_percentage_of_cells_within_radius","text":"","code":"average_percentage_of_cells_within_radius(   sce_object,   reference_celltype,   target_celltype,   radius = 100,   feature_colname )"},{"path":"https://trigosteam.github.io/SPIAT/reference/average_percentage_of_cells_within_radius.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"average_percentage_of_cells_within_radius — average_percentage_of_cells_within_radius","text":"sce_object SingleCellExperiment object form output format_image_to_sce. reference_celltype String specifying cell type reference cells. target_celltype String specifying cell type target cells radius Integer specifying radius search cells around reference cells. Radii ~100 recommended. small, cells might present. feature_colname String specifying column desired cell type annotations.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_percentage_of_cells_within_radius.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"average_percentage_of_cells_within_radius — average_percentage_of_cells_within_radius","text":"numeric vector plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/average_percentage_of_cells_within_radius.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"average_percentage_of_cells_within_radius — average_percentage_of_cells_within_radius","text":"","code":"average_percentage_of_cells_within_radius(SPIAT::defined_image, \"Tumour\",  \"Immune3\", radius = 100, \"Cell.Type\") #> [1] 17.45713"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_cell_proportions.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_cell_proportions — calculate_cell_proportions","title":"calculate_cell_proportions — calculate_cell_proportions","text":"Calculates number proportion cell type.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_cell_proportions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_cell_proportions — calculate_cell_proportions","text":"","code":"calculate_cell_proportions(   sce_object,   reference_celltypes = NULL,   celltypes_to_exclude = NULL,   feature_colname = \"Phenotype\",   plot.image = TRUE )"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_cell_proportions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_cell_proportions — calculate_cell_proportions","text":"sce_object SingleCellExperiment object form output format_image_to_sce. reference_celltypes String Vector specifying reference cell types. NULL (default), proportion cell type cells returned. Alternatively, custom vector cell types can used input, used denominator calculation proportions. celltypes_to_exclude String Vector specifying cell types exclude. example \"\" exclude celltype Total. NULL, cell types included. feature_colname String. Column cells choose cell type (e.g. Phenotype, Cell.Type, etc). plot.image Boolean. Whether plot barplot cell percentages. default TRUE.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_cell_proportions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_cell_proportions — calculate_cell_proportions","text":"data.frame returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_cell_proportions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_cell_proportions — calculate_cell_proportions","text":"","code":"calculate_cell_proportions(SPIAT::defined_image, reference_celltypes = NULL,  celltypes_to_exclude = \"Others\", feature_colname=\"Cell.Type\", plot.image = FALSE) #>   Cell_type Number_of_celltype Proportion Percentage Proportion_name #> 5    Tumour                819 0.41679389  41.679389          /Total #> 3   Immune3                630 0.32061069  32.061069          /Total #> 1   Immune1                338 0.17201018  17.201018          /Total #> 2   Immune2                178 0.09058524   9.058524          /Total"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_cross_functions.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_cross_functions — calculate_cross_functions","title":"calculate_cross_functions — calculate_cross_functions","text":"Compute plot cross functions two specified cell   types. function implements cross functions [spatstat] package.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_cross_functions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_cross_functions — calculate_cross_functions","text":"","code":"calculate_cross_functions(   sce_object,   method = \"Kcross\",   cell_types_of_interest,   feature_colname,   plot_results = TRUE,   dist = NULL )"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_cross_functions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_cross_functions — calculate_cross_functions","text":"sce_object SingleCellExperiment object form output format_image_to_sce. method String method dependence calculation. Options: \"Gcross\", \"Kcross\", \"Kcross.inhom\", \"Lcross\", \"Jcross\". Default method \"Kcross\". cell_types_of_interest String Vector. Cell types interest. feature_colname String name column types. plot_results Boolean. TRUE result plotted, FALSE . either case, object results returned dist Number (OPTIONAL) largest distance two cell types K function evaluated. NULL, use default distances set cross functions.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_cross_functions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_cross_functions — calculate_cross_functions","text":"object class \"fv\" defined `spatstat` package.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_cross_functions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_cross_functions — calculate_cross_functions","text":"","code":"df_cross <- calculate_cross_functions(SPIAT::defined_image, method = \"Kcross\",               cell_types_of_interest = c(\"Tumour\",\"Immune3\"),               feature_colname =\"Cell.Type\", dist = 100)"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_distance_to_tumour_margin.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_distance_to_tumour_margin — calculate_distance_to_tumour_margin","title":"calculate_distance_to_tumour_margin — calculate_distance_to_tumour_margin","text":"Returns SCE object minimum distance immune   cells identified tumour bordering cells.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_distance_to_tumour_margin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_distance_to_tumour_margin — calculate_distance_to_tumour_margin","text":"","code":"calculate_distance_to_tumour_margin(sce_object)"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_distance_to_tumour_margin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_distance_to_tumour_margin — calculate_distance_to_tumour_margin","text":"sce_object SingleCellExperiment object information detected bordering cells (metadata \"Region\" column).","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_distance_to_tumour_margin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_distance_to_tumour_margin — calculate_distance_to_tumour_margin","text":"sce_object returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_distance_to_tumour_margin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_distance_to_tumour_margin — calculate_distance_to_tumour_margin","text":"","code":"sce_border <- identify_bordering_cells(SPIAT::defined_image, reference_cell = \"Tumour\", feature_colname = \"Cell.Type\", n_to_exclude = 10) #> [1] \"The alpha of Polygon is: 63.24375\"  sce_dist <- calculate_distance_to_tumour_margin(sce_border) #> [1] \"Markers had been selected in pair-wise distance calculation: \" #> [1] \"Non-border\" \"Border\""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_entropy.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_entropy — calculate_entropy","title":"calculate_entropy — calculate_entropy","text":"arg `radius` specified, function returns   entropy cell types interest whole image. arg `radius`   specified, function returns data.frame row   reference cell columns stores entropy cell types   interest circle reference cells.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_entropy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_entropy — calculate_entropy","text":"","code":"calculate_entropy(   sce_object,   cell_types_of_interest,   feature_colname = \"Phenotype\",   radius = NULL )"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_entropy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_entropy — calculate_entropy","text":"sce_object SingleCellExperiment object form output format_image_to_sce. cell_types_of_interest String Vector. Cell types interest. arg `radius` NULL, first cell type considered reference cell type. Circles specified radius drawn around reference cells entropy cell types calculated reference cells. feature_colname String specifying column cell types . radius (OPTIONAL) Numeric. maximum radius around reference cell another cell considered interaction.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_entropy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_entropy — calculate_entropy","text":"dataframe number depending argument radius","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_entropy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_entropy — calculate_entropy","text":"","code":"calculate_entropy(SPIAT::defined_image, cell_types_of_interest = c(\"Immune1\",\"Immune2\"), feature_colname = \"Cell.Type\") #> [1] 0.9294873"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_minimum_distances_between_celltypes.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_minimum_distances_between_celltypes — calculate_minimum_distances_between_celltypes","title":"calculate_minimum_distances_between_celltypes — calculate_minimum_distances_between_celltypes","text":"Returns distance closest cell specific type   reference cell.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_minimum_distances_between_celltypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_minimum_distances_between_celltypes — calculate_minimum_distances_between_celltypes","text":"","code":"calculate_minimum_distances_between_celltypes(   sce_object,   feature_colname,   cell_types_of_interest = NULL )"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_minimum_distances_between_celltypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_minimum_distances_between_celltypes — calculate_minimum_distances_between_celltypes","text":"sce_object SingleCellExperiment object form output format_image_to_sce. feature_colname String feature column cells choose cell types (e.g. Cell.Type, Cell.Type2, etc). cell_types_of_interest String Vector marker combinations consider FALSE.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_minimum_distances_between_celltypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_minimum_distances_between_celltypes — calculate_minimum_distances_between_celltypes","text":"data.frame returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_minimum_distances_between_celltypes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_minimum_distances_between_celltypes — calculate_minimum_distances_between_celltypes","text":"","code":"min_dists <- calculate_minimum_distances_between_celltypes(SPIAT::defined_image,  feature_colname = \"Cell.Type\", cell_types_of_interest = c(\"Tumour\",\"Immune1\")) #> [1] \"Markers had been selected in pair-wise distance calculation: \" #> [1] \"Immune1\" \"Tumour\""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_pairwise_distances_between_celltypes.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_pairwise_distances_between_celltypes — calculate_pairwise_distances_between_celltypes","title":"calculate_pairwise_distances_between_celltypes — calculate_pairwise_distances_between_celltypes","text":"Returns pairwise distances cells different types. none   cell types found, print error message return   vector NAs.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_pairwise_distances_between_celltypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_pairwise_distances_between_celltypes — calculate_pairwise_distances_between_celltypes","text":"","code":"calculate_pairwise_distances_between_celltypes(   sce_object,   cell_types_of_interest = NULL,   feature_colname )"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_pairwise_distances_between_celltypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_pairwise_distances_between_celltypes — calculate_pairwise_distances_between_celltypes","text":"sce_object SingleCellExperiment object form output format_image_to_sce. cell_types_of_interest String Vector containing cell types considered, NULL, cell type combinations calculated. feature_colname String name feature column cell types interest considered.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_pairwise_distances_between_celltypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_pairwise_distances_between_celltypes — calculate_pairwise_distances_between_celltypes","text":"data.frame returned.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_pairwise_distances_between_celltypes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_pairwise_distances_between_celltypes — calculate_pairwise_distances_between_celltypes","text":"","code":"calculate_pairwise_distances_between_celltypes(SPIAT::defined_image,  cell_types_of_interest = c(\"Tumour\",\"Immune1\"), feature_colname = \"Cell.Type\") #>         Cell1   Cell2   Distance            Pair #> 2     Cell_25 Cell_15  119.39827 Immune1_Immune1 #> 3     Cell_30 Cell_15   61.77859 Immune1_Immune1 #> 4     Cell_48 Cell_15  279.84944 Immune1_Immune1 #> 5     Cell_56 Cell_15  237.67335 Immune1_Immune1 #> 6     Cell_61 Cell_15  335.22489 Immune1_Immune1 #> 7     Cell_71 Cell_15  342.60619 Immune1_Immune1 #> 8     Cell_83 Cell_15  301.84395 Immune1_Immune1 #> 9     Cell_86 Cell_15  225.22881 Immune1_Immune1 #> 10    Cell_94 Cell_15  542.32855 Immune1_Immune1 #> 11    Cell_99 Cell_15  405.84255 Immune1_Immune1 #> 12   Cell_105 Cell_15  514.01023 Immune1_Immune1 #> 13   Cell_107 Cell_15  435.39893 Immune1_Immune1 #> 14   Cell_154 Cell_15  706.99725 Immune1_Immune1 #> 15   Cell_155 Cell_15  608.28345 Immune1_Immune1 #> 16   Cell_162 Cell_15  591.03913 Immune1_Immune1 #> 17   Cell_181 Cell_15  911.64023 Immune1_Immune1 #> 18   Cell_195 Cell_15  866.76045 Immune1_Immune1 #> 19   Cell_196 Cell_15  961.34659 Immune1_Immune1 #> 20   Cell_205 Cell_15 1047.02696 Immune1_Immune1 #> 21   Cell_211 Cell_15 1034.07460 Immune1_Immune1 #> 22   Cell_227 Cell_15 1102.73314 Immune1_Immune1 #> 23   Cell_242 Cell_15  984.53051 Immune1_Immune1 #> 24   Cell_244 Cell_15 1026.58735 Immune1_Immune1 #> 25   Cell_251 Cell_15 1250.27644 Immune1_Immune1 #> 26   Cell_252 Cell_15 1230.93722 Immune1_Immune1 #> 27   Cell_262 Cell_15 1343.33578 Immune1_Immune1 #> 28   Cell_271 Cell_15 1394.29934 Immune1_Immune1 #> 29   Cell_284 Cell_15 1291.47258 Immune1_Immune1 #> 30   Cell_309 Cell_15 1484.68671 Immune1_Immune1 #> 31   Cell_310 Cell_15 1461.57290 Immune1_Immune1 #> 32   Cell_321 Cell_15 1475.60228 Immune1_Immune1 #> 33   Cell_324 Cell_15 1550.22397 Immune1_Immune1 #> 34   Cell_326 Cell_15 1533.05486 Immune1_Immune1 #> 35   Cell_331 Cell_15 1552.32839 Immune1_Immune1 #> 36   Cell_333 Cell_15 1441.70710 Immune1_Immune1 #> 37   Cell_336 Cell_15 1457.42721 Immune1_Immune1 #> 38   Cell_352 Cell_15 1597.35446 Immune1_Immune1 #> 39   Cell_366 Cell_15 1645.71833 Immune1_Immune1 #> 40   Cell_410 Cell_15 1970.70975 Immune1_Immune1 #> 41   Cell_432 Cell_15 1886.88350 Immune1_Immune1 #> 42   Cell_464 Cell_15  106.16733 Immune1_Immune1 #> 43   Cell_465 Cell_15  191.51914 Immune1_Immune1 #> 44   Cell_466 Cell_15  196.15280 Immune1_Immune1 #> 45   Cell_469 Cell_15  186.99581 Immune1_Immune1 #> 46   Cell_486 Cell_15  386.12403 Immune1_Immune1 #> 47   Cell_488 Cell_15  217.28974 Immune1_Immune1 #> 48   Cell_490 Cell_15  350.11600 Immune1_Immune1 #> 49   Cell_492 Cell_15  362.94678 Immune1_Immune1 #> 50   Cell_497 Cell_15  380.74370 Immune1_Immune1 #> 51   Cell_498 Cell_15  310.68063 Immune1_Immune1 #> 52   Cell_505 Cell_15  206.15130 Immune1_Immune1 #> 53   Cell_533 Cell_15  347.57692 Immune1_Immune1 #> 54   Cell_563 Cell_15  470.33985 Immune1_Immune1 #> 55   Cell_568 Cell_15  481.44486 Immune1_Immune1 #> 56   Cell_574 Cell_15  474.50684 Immune1_Immune1 #> 57   Cell_613 Cell_15  679.92114 Immune1_Immune1 #> 58   Cell_622 Cell_15  787.19320 Immune1_Immune1 #> 59   Cell_626 Cell_15  663.90680 Immune1_Immune1 #> 60   Cell_645 Cell_15  965.06351 Immune1_Immune1 #> 61   Cell_649 Cell_15  968.63505 Immune1_Immune1 #> 62   Cell_654 Cell_15  912.29932 Immune1_Immune1 #> 63   Cell_663 Cell_15  942.61238 Immune1_Immune1 #> 64   Cell_669 Cell_15  991.26742 Immune1_Immune1 #> 65   Cell_703 Cell_15 1038.46534 Immune1_Immune1 #> 66   Cell_706 Cell_15 1023.87276 Immune1_Immune1 #> 67   Cell_710 Cell_15 1023.22733 Immune1_Immune1 #> 68   Cell_742 Cell_15 1053.17969 Immune1_Immune1 #> 69   Cell_748 Cell_15 1274.64357 Immune1_Immune1 #> 70   Cell_817 Cell_15 1589.61641 Immune1_Immune1 #> 71   Cell_835 Cell_15 1500.45282 Immune1_Immune1 #> 72   Cell_847 Cell_15 1681.61651 Immune1_Immune1 #> 73   Cell_891 Cell_15 1737.45361 Immune1_Immune1 #> 74   Cell_896 Cell_15 1720.25833 Immune1_Immune1 #> 75   Cell_907 Cell_15 1811.04895 Immune1_Immune1 #> 76   Cell_910 Cell_15 1887.10633 Immune1_Immune1 #> 77   Cell_926 Cell_15 1986.01555 Immune1_Immune1 #> 78   Cell_952 Cell_15  397.79650 Immune1_Immune1 #> 79   Cell_959 Cell_15  504.82750 Immune1_Immune1 #> 80  Cell_1004 Cell_15  436.51426 Immune1_Immune1 #> 81  Cell_1006 Cell_15  357.79435 Immune1_Immune1 #> 82  Cell_1015 Cell_15  452.95784 Immune1_Immune1 #> 83  Cell_1018 Cell_15  503.36362 Immune1_Immune1 #> 84  Cell_1021 Cell_15  527.32357 Immune1_Immune1 #> 85  Cell_1027 Cell_15  425.10964 Immune1_Immune1 #> 86  Cell_1036 Cell_15  467.69452 Immune1_Immune1 #> 87  Cell_1067 Cell_15  628.78794 Immune1_Immune1 #> 88  Cell_1104 Cell_15  716.37391 Immune1_Immune1 #> 89  Cell_1108 Cell_15  712.62464 Immune1_Immune1 #> 90  Cell_1114 Cell_15  783.66738 Immune1_Immune1 #> 91  Cell_1136 Cell_15 1011.86062 Immune1_Immune1 #> 92  Cell_1389 Cell_15 1935.00093 Immune1_Immune1 #> 93  Cell_1393 Cell_15 1939.40134 Immune1_Immune1 #> 94  Cell_1396 Cell_15 1967.53615 Immune1_Immune1 #> 95  Cell_1402 Cell_15 1895.27981 Immune1_Immune1 #> 96  Cell_1405 Cell_15 1888.26272 Immune1_Immune1 #> 97  Cell_1412 Cell_15 1948.32303 Immune1_Immune1 #> 98  Cell_1426 Cell_15 1876.60613 Immune1_Immune1 #> 99  Cell_1431 Cell_15 1900.83173 Immune1_Immune1 #> 100 Cell_1455 Cell_15  552.73287 Immune1_Immune1 #> 101 Cell_1463 Cell_15  673.67090 Immune1_Immune1 #> 102 Cell_1465 Cell_15  583.78598 Immune1_Immune1 #> 103 Cell_1467 Cell_15  528.64096 Immune1_Immune1 #> 104 Cell_1475 Cell_15  516.95562 Immune1_Immune1 #> 105 Cell_1479 Cell_15  539.53320 Immune1_Immune1 #> 106 Cell_1490 Cell_15  634.10341 Immune1_Immune1 #> 107 Cell_1515 Cell_15  522.80830 Immune1_Immune1 #> 108 Cell_1524 Cell_15  709.77551 Immune1_Immune1 #> 109 Cell_1688 Cell_15 1146.20574 Immune1_Immune1 #> 110 Cell_1721 Cell_15 1290.72533 Immune1_Immune1 #> 111 Cell_1722 Cell_15 1146.21800 Immune1_Immune1 #> 112 Cell_1888 Cell_15 1879.38698 Immune1_Immune1 #> 113 Cell_1899 Cell_15 1941.01824 Immune1_Immune1 #> 114 Cell_1908 Cell_15 1883.91277 Immune1_Immune1 #> 115 Cell_1912 Cell_15 1932.52669 Immune1_Immune1 #> 116 Cell_1929 Cell_15 1931.73884 Immune1_Immune1 #> 117 Cell_1937 Cell_15 2033.07503 Immune1_Immune1 #> 118 Cell_1939 Cell_15 2039.46600 Immune1_Immune1 #> 119 Cell_1947 Cell_15  892.23909 Immune1_Immune1 #> 120 Cell_1950 Cell_15  796.89490 Immune1_Immune1 #> 121 Cell_1956 Cell_15  815.34079 Immune1_Immune1 #> 122 Cell_1974 Cell_15  792.70396 Immune1_Immune1 #> 123 Cell_1987 Cell_15  811.99958 Immune1_Immune1 #> 124 Cell_2006 Cell_15  727.99883 Immune1_Immune1 #> 125 Cell_2039 Cell_15  779.15222 Immune1_Immune1 #> 126 Cell_2208 Cell_15 1397.86105 Immune1_Immune1 #> 127 Cell_2220 Cell_15 1386.99855 Immune1_Immune1 #> 128 Cell_2243 Cell_15 1446.50924 Immune1_Immune1 #> 129 Cell_2256 Cell_15 1530.24110 Immune1_Immune1 #> 130 Cell_2259 Cell_15 1612.99515 Immune1_Immune1 #> 131 Cell_2262 Cell_15 1498.37579 Immune1_Immune1 #> 132 Cell_2273 Cell_15 1486.91357 Immune1_Immune1 #> 133 Cell_2278 Cell_15 1430.61063 Immune1_Immune1 #> 134 Cell_2297 Cell_15 1703.35470 Immune1_Immune1 #> 135 Cell_2330 Cell_15 1704.61831 Immune1_Immune1 #> 136 Cell_2345 Cell_15 1764.13668 Immune1_Immune1 #> 137 Cell_2352 Cell_15 1779.75394 Immune1_Immune1 #> 138 Cell_2354 Cell_15 1759.20561 Immune1_Immune1 #> 139 Cell_2355 Cell_15 1872.52528 Immune1_Immune1 #> 140 Cell_2396 Cell_15 1964.10273 Immune1_Immune1 #> 141 Cell_2399 Cell_15 1976.22403 Immune1_Immune1 #> 142 Cell_2413 Cell_15 2081.99058 Immune1_Immune1 #> 143 Cell_2420 Cell_15 2020.83573 Immune1_Immune1 #> 144 Cell_2426 Cell_15 2075.31779 Immune1_Immune1 #> 145 Cell_2434 Cell_15 2005.29147 Immune1_Immune1 #> 146 Cell_2462 Cell_15 1037.89033 Immune1_Immune1 #> 147 Cell_2463 Cell_15  918.77474 Immune1_Immune1 #> 148 Cell_2480 Cell_15 1074.40346 Immune1_Immune1 #> 149 Cell_2499 Cell_15  987.44730 Immune1_Immune1 #> 150 Cell_2500 Cell_15  971.97735 Immune1_Immune1 #> 151 Cell_2504 Cell_15  996.65277 Immune1_Immune1 #> 152 Cell_2508 Cell_15 1005.45611 Immune1_Immune1 #> 153 Cell_2536 Cell_15 1022.66563 Immune1_Immune1 #> 154 Cell_2567 Cell_15 1085.27977 Immune1_Immune1 #> 155 Cell_2569 Cell_15 1071.89290 Immune1_Immune1 #> 156 Cell_2582 Cell_15 1208.07205 Immune1_Immune1 #> 157 Cell_2778 Cell_15 1521.20994 Immune1_Immune1 #> 158 Cell_2779 Cell_15 1639.34594 Immune1_Immune1 #> 159 Cell_2793 Cell_15 1638.74555 Immune1_Immune1 #> 160 Cell_2825 Cell_15 1576.37749 Immune1_Immune1 #> 161 Cell_2830 Cell_15 1852.05740 Immune1_Immune1 #> 162 Cell_2834 Cell_15 1816.49965 Immune1_Immune1 #> 163 Cell_2835 Cell_15 1777.81124 Immune1_Immune1 #> 164 Cell_2858 Cell_15 1793.72599 Immune1_Immune1 #> 165 Cell_2882 Cell_15 2052.25334 Immune1_Immune1 #> 166 Cell_2895 Cell_15 1946.54621 Immune1_Immune1 #> 167 Cell_2916 Cell_15 1948.64476 Immune1_Immune1 #> 168 Cell_2925 Cell_15 2030.21670 Immune1_Immune1 #> 169 Cell_2936 Cell_15 2153.62013 Immune1_Immune1 #> 170 Cell_2965 Cell_15 2217.46012 Immune1_Immune1 #> 171 Cell_2986 Cell_15 1251.07717 Immune1_Immune1 #> 172 Cell_2998 Cell_15 1189.55029 Immune1_Immune1 #> 173 Cell_2999 Cell_15 1291.20140 Immune1_Immune1 #> 174 Cell_3011 Cell_15 1181.03533 Immune1_Immune1 #> 175 Cell_3017 Cell_15 1219.83878 Immune1_Immune1 #> 176 Cell_3022 Cell_15 1228.29514 Immune1_Immune1 #> 177 Cell_3035 Cell_15 1254.01220 Immune1_Immune1 #> 178 Cell_3051 Cell_15 1194.40956 Immune1_Immune1 #> 179 Cell_3053 Cell_15 1259.40230 Immune1_Immune1 #> 180 Cell_3057 Cell_15 1137.55045 Immune1_Immune1 #> 181 Cell_3086 Cell_15 1285.68956 Immune1_Immune1 #> 182 Cell_3098 Cell_15 1223.29567 Immune1_Immune1 #> 183 Cell_3115 Cell_15 1215.17120 Immune1_Immune1 #> 184 Cell_3122 Cell_15 1274.72351 Immune1_Immune1 #> 185 Cell_3133 Cell_15 1370.67796 Immune1_Immune1 #> 186 Cell_3306 Cell_15 1780.60681 Immune1_Immune1 #> 187 Cell_3335 Cell_15 1992.54465 Immune1_Immune1 #> 188 Cell_3336 Cell_15 1916.10567 Immune1_Immune1 #> 189 Cell_3349 Cell_15 1985.01477 Immune1_Immune1 #> 190 Cell_3353 Cell_15 1896.64365 Immune1_Immune1 #> 191 Cell_3376 Cell_15 2051.79296 Immune1_Immune1 #> 192 Cell_3379 Cell_15 2137.19287 Immune1_Immune1 #> 193 Cell_3381 Cell_15 2021.25806 Immune1_Immune1 #> 194 Cell_3385 Cell_15 2064.70304 Immune1_Immune1 #> 195 Cell_3399 Cell_15 2023.59299 Immune1_Immune1 #> 196 Cell_3421 Cell_15 2077.69702 Immune1_Immune1 #> 197 Cell_3425 Cell_15 2003.41968 Immune1_Immune1 #> 198 Cell_3431 Cell_15 2163.50939 Immune1_Immune1 #> 199 Cell_3471 Cell_15 2136.17199 Immune1_Immune1 #> 200 Cell_3482 Cell_15 2206.56098 Immune1_Immune1 #> 201 Cell_3494 Cell_15 1478.43441 Immune1_Immune1 #> 202 Cell_3496 Cell_15 1497.24636 Immune1_Immune1 #> 203 Cell_3511 Cell_15 1377.05245 Immune1_Immune1 #> 204 Cell_3538 Cell_15 1476.70492 Immune1_Immune1 #> 205 Cell_3539 Cell_15 1402.16665 Immune1_Immune1 #> 206 Cell_3548 Cell_15 1527.13158 Immune1_Immune1 #> 207 Cell_3549 Cell_15 1478.87546 Immune1_Immune1 #> 208 Cell_3552 Cell_15 1451.87065 Immune1_Immune1 #> 209 Cell_3553 Cell_15 1406.70661 Immune1_Immune1 #> 210 Cell_3564 Cell_15 1353.03657 Immune1_Immune1 #> 211 Cell_3572 Cell_15 1385.11606 Immune1_Immune1 #> 212 Cell_3656 Cell_15 1567.01825 Immune1_Immune1 #> 213 Cell_3658 Cell_15 1531.75939 Immune1_Immune1 #> 214 Cell_3661 Cell_15 1583.25450 Immune1_Immune1 #> 215 Cell_3675 Cell_15 1531.71176 Immune1_Immune1 #> 216 Cell_3698 Cell_15 1646.97589 Immune1_Immune1 #> 217 Cell_3701 Cell_15 1670.12070 Immune1_Immune1 #> 218 Cell_3706 Cell_15 1574.21185 Immune1_Immune1 #> 219 Cell_3713 Cell_15 1590.85245 Immune1_Immune1 #> 220 Cell_3721 Cell_15 1537.34877 Immune1_Immune1 #> 221 Cell_3864 Cell_15 2053.79851 Immune1_Immune1 #> 222 Cell_3882 Cell_15 2047.01429 Immune1_Immune1 #> 223 Cell_3886 Cell_15 1981.11065 Immune1_Immune1 #> 224 Cell_3888 Cell_15 2072.26180 Immune1_Immune1 #> 225 Cell_3905 Cell_15 2088.93542 Immune1_Immune1 #> 226 Cell_3906 Cell_15 2085.28265 Immune1_Immune1 #> 227 Cell_3911 Cell_15 2239.53936 Immune1_Immune1 #> 228 Cell_3912 Cell_15 2223.38917 Immune1_Immune1 #> 229 Cell_3919 Cell_15 2206.70140 Immune1_Immune1 #> 230 Cell_3930 Cell_15 2297.03786 Immune1_Immune1 #> 231 Cell_3942 Cell_15 2201.06633 Immune1_Immune1 #> 232 Cell_3944 Cell_15 2214.02518 Immune1_Immune1 #> 233 Cell_3993 Cell_15 2330.17150 Immune1_Immune1 #> 234 Cell_3996 Cell_15 2351.44299 Immune1_Immune1 #> 235 Cell_4003 Cell_15 1687.94859 Immune1_Immune1 #> 236 Cell_4005 Cell_15 1677.62154 Immune1_Immune1 #> 237 Cell_4022 Cell_15 1537.23092 Immune1_Immune1 #> 238 Cell_4026 Cell_15 1686.00666 Immune1_Immune1 #> 239 Cell_4027 Cell_15 1515.68654 Immune1_Immune1 #> 240 Cell_4030 Cell_15 1592.13804 Immune1_Immune1 #> 241 Cell_4051 Cell_15 1529.31722 Immune1_Immune1 #> 242 Cell_4062 Cell_15 1634.91926 Immune1_Immune1 #> 243 Cell_4068 Cell_15 1549.50088 Immune1_Immune1 #> 244 Cell_4076 Cell_15 1716.53888 Immune1_Immune1 #> 245 Cell_4084 Cell_15 1635.95359 Immune1_Immune1 #> 246 Cell_4105 Cell_15 1704.79760 Immune1_Immune1 #> 247 Cell_4107 Cell_15 1647.96090 Immune1_Immune1 #> 248 Cell_4115 Cell_15 1709.33194 Immune1_Immune1 #> 249 Cell_4126 Cell_15 1745.43320 Immune1_Immune1 #> 250 Cell_4137 Cell_15 1698.37118 Immune1_Immune1 #> 251 Cell_4145 Cell_15 1792.04892 Immune1_Immune1 #>  [ reached 'max' / getOption(\"max.print\") -- omitted 1337242 rows ]"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_percentage_of_grids.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_percentage_of_grids — calculate_percentage_of_grids","title":"calculate_percentage_of_grids — calculate_percentage_of_grids","text":"Takes result grid_metrics (RasterLayer   object) calculates percentage grid squares whose values   specified threshold.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_percentage_of_grids.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_percentage_of_grids — calculate_percentage_of_grids","text":"","code":"calculate_percentage_of_grids(raster_obj, threshold, above)"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_percentage_of_grids.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_percentage_of_grids — calculate_percentage_of_grids","text":"raster_obj Raster object form output grid_metrics. threshold Numeric. threshold defining pattern. Boolean. Indicating whether pattern (TRUE) (FALSE) threshold.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_percentage_of_grids.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_percentage_of_grids — calculate_percentage_of_grids","text":"number returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_percentage_of_grids.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_percentage_of_grids — calculate_percentage_of_grids","text":"","code":"grid <- grid_metrics(SPIAT::defined_image, FUN = calculate_entropy, n_split = 5, cell_types_of_interest=c(\"Tumour\",\"Immune3\"), feature_colname = \"Cell.Type\")  calculate_percentage_of_grids(grid, threshold = 0.75, above = TRUE) #> [1] 96"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_proportions_of_cells_in_structure.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_proportions_of_cells_in_structure — calculate_proportions_of_cells_in_structure","title":"calculate_proportions_of_cells_in_structure — calculate_proportions_of_cells_in_structure","text":"Calculate proportion cells interest defined   tumour structure relative cells structure relative   cell type whole image.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_proportions_of_cells_in_structure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_proportions_of_cells_in_structure — calculate_proportions_of_cells_in_structure","text":"","code":"calculate_proportions_of_cells_in_structure(   sce_object,   cell_types_of_interest,   feature_colname )"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_proportions_of_cells_in_structure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_proportions_of_cells_in_structure — calculate_proportions_of_cells_in_structure","text":"sce_object SingleCellExperiment object form output format_image_to_sce. cell_types_of_interest String Vector immune cells consider. feature_colname String. name column immune cell types .","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_proportions_of_cells_in_structure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_proportions_of_cells_in_structure — calculate_proportions_of_cells_in_structure","text":"data.frame","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_proportions_of_cells_in_structure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_proportions_of_cells_in_structure — calculate_proportions_of_cells_in_structure","text":"","code":"sce_border <- identify_bordering_cells(SPIAT::defined_image,  reference_cell = \"Tumour\", feature_colname = \"Cell.Type\", n_to_exclude = 10) #> [1] \"The alpha of Polygon is: 63.24375\"  sce_dist <- calculate_distance_to_tumour_margin(sce_border) #> [1] \"Markers had been selected in pair-wise distance calculation: \" #> [1] \"Non-border\" \"Border\"     sce_structure <- define_structure(sce_dist,  names_of_immune_cells = c(\"Immune1\",\"Immune2\",\"Immune3\"), feature_colname = \"Cell.Type\", n_margin_layers = 5) calculate_proportions_of_cells_in_structure(sce_structure,  cell_types_of_interest = c(\"Immune1\",\"Immune3\"),feature_colname = \"Cell.Type\") #>               Cell.Type                            Relative_to #> 1               Immune1             All_cells_in_the_structure #> 2               Immune3             All_cells_in_the_structure #> 3               Immune1 All_cells_of_interest_in_the_structure #> 4               Immune3 All_cells_of_interest_in_the_structure #> 5               Immune1  The_same_cell_type_in_the_whole_image #> 6               Immune3  The_same_cell_type_in_the_whole_image #> 7 All_cells_of_interest             All_cells_in_the_structure #>   P.Infiltrated.Immune P.Internal.Margin.Immune P.External.Margin.Immune #> 1           0.00000000               0.00000000              0.005494505 #> 2           0.14385965               0.08780488              2.159340659 #> 3           0.00000000               0.00000000              0.002538071 #> 4           1.00000000               1.00000000              0.997461929 #> 5           0.00000000               0.00000000              0.002958580 #> 6           0.06507937               0.05714286              0.623809524 #> 7           0.14385965               0.08780488              2.170329670 #>   P.Stromal.Immune #> 1       0.11971581 #> 2       0.05683837 #> 3       0.67806841 #> 4       0.32193159 #> 5       0.99704142 #> 6       0.25396825 #> 7       0.23943162"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_spatial_autocorrelation.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_spatial_autocorrelation — calculate_spatial_autocorrelation","title":"calculate_spatial_autocorrelation — calculate_spatial_autocorrelation","text":"Takes result grid_metrics (RasterLayer   object) calculate spatial autocorrelation.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_spatial_autocorrelation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_spatial_autocorrelation — calculate_spatial_autocorrelation","text":"","code":"calculate_spatial_autocorrelation(raster_obj, metric = \"globalmoran\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_spatial_autocorrelation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_spatial_autocorrelation — calculate_spatial_autocorrelation","text":"raster_obj Raster object form output grid_metrics. metric String. method calculating spatial autocorrelation. Choose \"globalmoran\" \"GearyC\".","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_spatial_autocorrelation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_spatial_autocorrelation — calculate_spatial_autocorrelation","text":"number returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_spatial_autocorrelation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_spatial_autocorrelation — calculate_spatial_autocorrelation","text":"","code":"grid <- grid_metrics(SPIAT::defined_image, FUN = calculate_entropy, n_split = 5, cell_types_of_interest=c(\"Tumour\",\"Immune3\"), feature_colname = \"Cell.Type\")  calculate_spatial_autocorrelation(grid, metric = \"globalmoran\") #> [1] -0.1152657"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_summary_distances_between_celltypes.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_summary_distances_between_celltypes — calculate_summary_distances_between_celltypes","title":"calculate_summary_distances_between_celltypes — calculate_summary_distances_between_celltypes","text":"Returns mean, median standard deviation  minimum/pairwise distances phenotypes.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_summary_distances_between_celltypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_summary_distances_between_celltypes — calculate_summary_distances_between_celltypes","text":"","code":"calculate_summary_distances_between_celltypes(df)"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_summary_distances_between_celltypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_summary_distances_between_celltypes — calculate_summary_distances_between_celltypes","text":"df Data.frame containing distance output cell types. functions generate distances can calculate_minimum_distances_between_celltypes calculate_pairwise_distances_between_celltypes.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_summary_distances_between_celltypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_summary_distances_between_celltypes — calculate_summary_distances_between_celltypes","text":"data.frame returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_summary_distances_between_celltypes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_summary_distances_between_celltypes — calculate_summary_distances_between_celltypes","text":"","code":"# for pairwise dist pairwise_dist <- calculate_pairwise_distances_between_celltypes(SPIAT::defined_image,  cell_types_of_interest = c(\"Tumour\",\"Immune1\"), feature_colname = \"Cell.Type\") summary_distances <- calculate_summary_distances_between_celltypes(pairwise_dist)  # for minimum dist min_dists <- calculate_minimum_distances_between_celltypes(SPIAT::defined_image, cell_types_of_interest = c(\"Tumour\",\"Immune1\"), feature_colname = \"Cell.Type\") #> [1] \"Markers had been selected in pair-wise distance calculation: \" #> [1] \"Immune1\" \"Tumour\"  summary_distances <- calculate_summary_distances_between_celltypes(min_dists)"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_summary_distances_of_cells_to_borders.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate_summary_distances_of_cells_to_borders — calculate_summary_distances_of_cells_to_borders","title":"calculate_summary_distances_of_cells_to_borders — calculate_summary_distances_of_cells_to_borders","text":"Returns mean, median standard deviation distances   specified cell type border.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_summary_distances_of_cells_to_borders.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate_summary_distances_of_cells_to_borders — calculate_summary_distances_of_cells_to_borders","text":"","code":"calculate_summary_distances_of_cells_to_borders(   sce_object,   cell_types_of_interest,   feature_colname = \"Cell.Type\" )"},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_summary_distances_of_cells_to_borders.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate_summary_distances_of_cells_to_borders — calculate_summary_distances_of_cells_to_borders","text":"sce_object SingleCellExperiment object whose metadata contains information tumour structure cell distances tumour border (column \"Region\" \"Distance..Border\"). cell_types_of_interest String Vector cell types consider. feature_colname String specifying column interested cell types .","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_summary_distances_of_cells_to_borders.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate_summary_distances_of_cells_to_borders — calculate_summary_distances_of_cells_to_borders","text":"data.frame returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/calculate_summary_distances_of_cells_to_borders.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate_summary_distances_of_cells_to_borders — calculate_summary_distances_of_cells_to_borders","text":"","code":"sce_border <- identify_bordering_cells(SPIAT::defined_image, reference_cell = \"Tumour\", feature_colname = \"Cell.Type\", n_to_exclude = 10) #> [1] \"The alpha of Polygon is: 63.24375\"  sce_dist <- calculate_distance_to_tumour_margin(sce_border) #> [1] \"Markers had been selected in pair-wise distance calculation: \" #> [1] \"Non-border\" \"Border\"     sce_structure <- define_structure(sce_dist, names_of_immune_cells = c(\"Immune1\",\"Immune2\",\"Immune3\"), feature_colname = \"Cell.Type\", n_margin_layers = 5) calculate_summary_distances_of_cells_to_borders(sce_structure, cell_types_of_interest = c(\"Immune1\",\"Immune3\"),feature_colname = \"Cell.Type\") #>                    Cell.Type       Area    Min_d    Max_d    Mean_d  Median_d #> 1 All_cell_types_of_interest Tumor_area 10.93225 192.4094  86.20042  88.23299 #> 2 All_cell_types_of_interest     Stroma 10.02387 971.5638 195.10637 101.95113 #> 3                    Immune1 Tumor_area      Inf     -Inf       NaN        NA #> 4                    Immune1     Stroma 84.20018 970.7749 346.14096 301.01535 #> 5                    Immune3 Tumor_area 10.93225 192.4094  86.20042  88.23299 #> 6                    Immune3     Stroma 10.02387 971.5638 102.79227  68.19218 #>    St.dev_d #> 1  45.27414 #> 2 194.68507 #> 3        NA #> 4 187.04247 #> 5  45.27414 #> 6 131.32714"},{"path":"https://trigosteam.github.io/SPIAT/reference/composition_of_neighborhoods.html","id":null,"dir":"Reference","previous_headings":"","what":"composition_of_neighborhoods — composition_of_neighborhoods","title":"composition_of_neighborhoods — composition_of_neighborhoods","text":"Returns data.frame contains percentages cells   specific marker within neighborhood. number cells   neighborhood.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/composition_of_neighborhoods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"composition_of_neighborhoods — composition_of_neighborhoods","text":"","code":"composition_of_neighborhoods(neighborhoods_df, feature_colname)"},{"path":"https://trigosteam.github.io/SPIAT/reference/composition_of_neighborhoods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"composition_of_neighborhoods — composition_of_neighborhoods","text":"neighborhoods_df Data.frame output identify_neighborhoods. feature_colname String. Column cell types.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/composition_of_neighborhoods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"composition_of_neighborhoods — composition_of_neighborhoods","text":"data.frame returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/composition_of_neighborhoods.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"composition_of_neighborhoods — composition_of_neighborhoods","text":"","code":"neighborhoods <- identify_neighborhoods(image_no_markers, method = \"hierarchical\", min_neighborhood_size = 100, cell_types_of_interest = c(\"Immune\", \"Immune1\", \"Immune2\"), radius = 50, feature_colname = \"Cell.Type\")  neighborhoods_vis <- composition_of_neighborhoods(neighborhoods, feature_colname=\"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/compute_gradient.html","id":null,"dir":"Reference","previous_headings":"","what":"compute_gradient — compute_gradient","title":"compute_gradient — compute_gradient","text":"function sweeps circles range radii surrounding   reference cells calculates metrics radii. Metrics used   function need two conditions: 1) `radius` parameter. 2) return   single number. metrics return single number, users can   wrap new function returns number pass new   function `compute_gradient()`.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/compute_gradient.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"compute_gradient — compute_gradient","text":"","code":"compute_gradient(sce_object, radii, FUN, ...)"},{"path":"https://trigosteam.github.io/SPIAT/reference/compute_gradient.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"compute_gradient — compute_gradient","text":"sce_object SingleCellExperiment object form output format_image_to_sce. radii Numeric Vector specifying range radii metrics calculated. FUN Variable name specifying metric. ... Arguments FUN","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/compute_gradient.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"compute_gradient — compute_gradient","text":"list metrics radii","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/compute_gradient.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"compute_gradient — compute_gradient","text":"","code":"gradient_positions <- c(30, 50, 100) gradient_entropy <- compute_gradient(SPIAT::defined_image, radii = gradient_positions, FUN = calculate_entropy,  cell_types_of_interest = c(\"Immune1\",\"Immune2\"), feature_colname = \"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/crossing_of_crossK.html","id":null,"dir":"Reference","previous_headings":"","what":"crossing_of_crossK — crossing_of_crossK","title":"crossing_of_crossK — crossing_of_crossK","text":"Determine crossing cross K curves,   detect existence potential immune rings. --requires   additional explanation/reference. Cite paper?","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/crossing_of_crossK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"crossing_of_crossK — crossing_of_crossK","text":"","code":"crossing_of_crossK(df.cross)"},{"path":"https://trigosteam.github.io/SPIAT/reference/crossing_of_crossK.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"crossing_of_crossK — crossing_of_crossK","text":"df.cross Data.frame. output calculate_cross_functions. Containing positions two curves. Columns contain \"r\", \"border\" \"theo\".","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/crossing_of_crossK.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"crossing_of_crossK — crossing_of_crossK","text":"number. percentage crossing position specified   distance.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/crossing_of_crossK.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"crossing_of_crossK — crossing_of_crossK","text":"","code":"df_cross <- calculate_cross_functions(SPIAT::defined_image, method = \"Kcross\",               cell_types_of_interest = c(\"Tumour\",\"Immune3\"),               feature_colname =\"Cell.Type\", dist = 100)  crossing_of_crossK(df_cross) #> [1] \"Crossing of cross K function is detected for this image, indicating a potential immune ring.\" #> [1] \"The crossing happens at the 50 % of the specified distance.\" #> [1] 0.5"},{"path":"https://trigosteam.github.io/SPIAT/reference/define_celltypes.html","id":null,"dir":"Reference","previous_headings":"","what":"define_celltypes — define_celltypes","title":"define_celltypes — define_celltypes","text":"Define new cell types based existing cell types   (categories) selected column (e.g. base marker combinations   \"Phenotype\" column). function create new column store   new cell types.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/define_celltypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"define_celltypes — define_celltypes","text":"","code":"define_celltypes(   sce_object,   categories = NULL,   category_colname = \"Phenotype\",   names = NULL,   new_colname = \"Cell.Type\",   print_names = FALSE )"},{"path":"https://trigosteam.github.io/SPIAT/reference/define_celltypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"define_celltypes — define_celltypes","text":"sce_object SingleCellExperiment object form output format_image_to_sce. categories Vector. Names old cell types defined; NULL, function use predefined categories names category_colname (Phenotype) String specifying name column categories defined, default \"Phenotype\". names Vector new names assigned selected categories; NULL, function use predefined categories names. length `categories`. new_colname (Optional) String specifying name column added, default \"Cell.Type\". print_names (Optional) Boolean user wants original new names printed. Default FALSE.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/define_celltypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"define_celltypes — define_celltypes","text":"new SCE object returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/define_celltypes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"define_celltypes — define_celltypes","text":"Users need specify names old cell categories   column old cell categories exist. users specify   names new cell types name new column store new   cell types. cell categories specified `categories` arg   present image defined \"Undefined\" new column.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/define_celltypes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"define_celltypes — define_celltypes","text":"","code":"# the selected column is: category_colname = \"Phenotype\" # define the following marker combinations: categories <- c(\"Tumour_marker\", \"Immune_marker1,Immune_marker2\", \"Immune_marker1,Immune_marker3\", \"Immune_marker1,Immune_marker2,Immune_marker4\", \"OTHER\") # the new defined cell names: names = c(\"Tumour\", \"Immune1\", \"Immune2\",\"Immune3\", \"Others\") # the new names are stored under this column: new_colname <- \"Cell.Type\"  defined_sce <- define_celltypes(SPIAT::simulated_image, categories = categories, category_colname = category_colname, names = names, new_colname = new_colname)"},{"path":"https://trigosteam.github.io/SPIAT/reference/define_structure.html","id":null,"dir":"Reference","previous_headings":"","what":"define_structure — define_structure","title":"define_structure — define_structure","text":"identifying bordering cells tumour regions   calculating distances cell tumour bordering cells,   function identifies cells located inside   outside tumour regions, internal external tumour   margins. also identifies immune cells infiltrated, stromal,   internal margin external margin immune cells.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/define_structure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"define_structure — define_structure","text":"","code":"define_structure(   sce_object,   names_of_immune_cells,   feature_colname = \"Cell.Type\",   n_margin_layers = 5 )"},{"path":"https://trigosteam.github.io/SPIAT/reference/define_structure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"define_structure — define_structure","text":"sce_object SingleCellExperiment object whose metadata information tumour bordering cells cell distances tumour border (columns \"Region\" \"Distance..Border\"). names_of_immune_cells String Vector names immune cells. feature_colname String Specifying column contains names immune cells. n_margin_layers Integer. number layers cells compose internal/external tumour margins.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/define_structure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"define_structure — define_structure","text":"new sce object returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/define_structure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"define_structure — define_structure","text":"","code":"sce_border <- identify_bordering_cells(SPIAT::defined_image, reference_cell = \"Tumour\", feature_colname = \"Cell.Type\", n_to_exclude = 10) #> [1] \"The alpha of Polygon is: 63.24375\"  sce_dist <- calculate_distance_to_tumour_margin(sce_border) #> [1] \"Markers had been selected in pair-wise distance calculation: \" #> [1] \"Non-border\" \"Border\"     sce_structure <- define_structure(sce_dist, names_of_immune_cells = c(\"Immune1\",\"Immune2\",\"Immune3\"), feature_colname = \"Cell.Type\", n_margin_layers = 5) plot_cell_categories(sce_structure, feature_colname = \"Structure\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/defined_image.html","id":null,"dir":"Reference","previous_headings":"","what":"SCE object of a simulated image with defined cell types based on marker\ncombinations. — defined_image","title":"SCE object of a simulated image with defined cell types based on marker\ncombinations. — defined_image","text":"dataset contains formatted sce object  simulated_image cell ids, cell positions, phenotypes, defined cell types metadata marker intensities assays.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/defined_image.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SCE object of a simulated image with defined cell types based on marker\ncombinations. — defined_image","text":"","code":"defined_image"},{"path":"https://trigosteam.github.io/SPIAT/reference/defined_image.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"SCE object of a simulated image with defined cell types based on marker\ncombinations. — defined_image","text":"sce object. Assay contains 5 rows (markers) 4951 columns   (cells); colData contains 4951 rows (cells) 4 columns (metadata).","code":""},{"path":[]},{"path":"https://trigosteam.github.io/SPIAT/reference/dimensionality_reduction_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Dimensionality reduction plot — dimensionality_reduction_plot","title":"Dimensionality reduction plot — dimensionality_reduction_plot","text":"Generates dimensionality reduction plots (UMAP tSNE)   based marker intensities. Cells grouped categories   selected column. -- tried PCA matrix UMAP/tSNE? help? scRNAseq workflows . (?)","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/dimensionality_reduction_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dimensionality reduction plot — dimensionality_reduction_plot","text":"","code":"dimensionality_reduction_plot(   sce_object,   plot_type = \"UMAP\",   scale = TRUE,   feature_colname )"},{"path":"https://trigosteam.github.io/SPIAT/reference/dimensionality_reduction_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dimensionality reduction plot — dimensionality_reduction_plot","text":"sce_object SingleCellExperiment object form output format_image_to_sce. plot_type String. Choose \"UMAP\" \"TSNE\". scale Boolean. Whether scale marker intensities. feature_colname String. Specify column name group cells.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/dimensionality_reduction_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dimensionality reduction plot — dimensionality_reduction_plot","text":"plot","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/dimensionality_reduction_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dimensionality reduction plot — dimensionality_reduction_plot","text":"","code":"dimensionality_reduction_plot(SPIAT::simulated_image, plot_type = \"TSNE\",  feature_colname = \"Phenotype\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/entropy_gradient_aggregated.html","id":null,"dir":"Reference","previous_headings":"","what":"The aggregated gradient of entropy and the peak of the gradient — entropy_gradient_aggregated","title":"The aggregated gradient of entropy and the peak of the gradient — entropy_gradient_aggregated","text":"function first calculates entropy within circles   reference cell radius. radius, entropy   circles surrounding cell aggregated one number. function   sweeps specified radii calculates aggregated entropy   radius.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/entropy_gradient_aggregated.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The aggregated gradient of entropy and the peak of the gradient — entropy_gradient_aggregated","text":"","code":"entropy_gradient_aggregated(   sce_object,   cell_types_of_interest,   feature_colname,   radii )"},{"path":"https://trigosteam.github.io/SPIAT/reference/entropy_gradient_aggregated.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The aggregated gradient of entropy and the peak of the gradient — entropy_gradient_aggregated","text":"sce_object SingleCellExperiment object form output format_image_to_sce. cell_types_of_interest String Vector. cell types entropy computed . feature_colname String. column name interested cell types. radii Numeric Vector. vector radii within circle reference cell entropy computed .","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/entropy_gradient_aggregated.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The aggregated gradient of entropy and the peak of the gradient — entropy_gradient_aggregated","text":"list gradient entropy peak","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/entropy_gradient_aggregated.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The aggregated gradient of entropy and the peak of the gradient — entropy_gradient_aggregated","text":"","code":"gradient_pos <- seq(50, 500, 50) gradient_results <- entropy_gradient_aggregated(SPIAT::defined_image, cell_types_of_interest = c(\"Tumour\",\"Immune3\"), feature_colname = \"Cell.Type\", radii = gradient_pos) plot(1:10,gradient_results$gradient_df[1, 3:12])"},{"path":"https://trigosteam.github.io/SPIAT/reference/format_colData_to_sce.html","id":null,"dir":"Reference","previous_headings":"","what":"format_colData_to_sce — format_colData_to_sce","title":"format_colData_to_sce — format_colData_to_sce","text":"Format dataframe colData singlecellexperiment class   count assay empty every cell (columns), cell phenotype, x   y coordinates stored colData purpose passing   dataframe function requiring sce_object.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/format_colData_to_sce.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"format_colData_to_sce — format_colData_to_sce","text":"","code":"format_colData_to_sce(df)"},{"path":"https://trigosteam.github.io/SPIAT/reference/format_colData_to_sce.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"format_colData_to_sce — format_colData_to_sce","text":"df Dataframe colData sce object.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/format_colData_to_sce.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"format_colData_to_sce — format_colData_to_sce","text":"SingleCellExperiment object","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/format_colData_to_sce.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"format_colData_to_sce — format_colData_to_sce","text":"","code":"df <- data.frame(Cell.ID = c(\"Cell_1\", \"Cell_2\"), Cell.X.Positions = c(2,5),  Cell.Y.Positions = c(3.3, 8), Phenotypes = c(\"CD3\", \"CD3,CD8\")) sce <- format_colData_to_sce(df)"},{"path":"https://trigosteam.github.io/SPIAT/reference/format_image_to_sce.html","id":null,"dir":"Reference","previous_headings":"","what":"Format an image into a SingleCellExperiment object — format_image_to_sce","title":"Format an image into a SingleCellExperiment object — format_image_to_sce","text":"Formats inForm, HALO, Visum, CODEX, cellprofiler outputs   SingleCellExperiment class. Users can also input generic format.   count assay stores intensity level every marker (rows) every   cell (columns). Cell phenotype, x y coordinates cell   properties stored colData. INFORM format, cell properties   Cell.Area, Nucleus.Area, Nucleus.Compactness, Nucleus.Axis.Ratio,   Cell.Axis.Ratio. HALO format, cell properties Cell.Area,   Nucleus.Area Cytoplasm.Area. -- need list output   formats?","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/format_image_to_sce.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format an image into a SingleCellExperiment object — format_image_to_sce","text":"","code":"format_image_to_sce(   format = \"INFORM\",   path = NULL,   markers = NULL,   locations = NULL,   dye_columns_interest = NULL,   intensity_columns_interest = NULL,   path_to_visium_coordinates = NULL,   path_to_codex_cell_phenotypes = NULL,   intensity_matrix = NULL,   phenotypes = NULL,   coord_x = NULL,   coord_y = NULL )"},{"path":"https://trigosteam.github.io/SPIAT/reference/format_image_to_sce.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format an image into a SingleCellExperiment object — format_image_to_sce","text":"format String defining software used cell segmentation. Options: \"INFORM\", \"HALO\", \"Visium\", \"CODEX\" \"cellprofiler, \"general\". path String path location either HALO csv file, INFORM text file CODEX csv file. 10X Visium transcriptomics data, path \"filtered_feature_bc_matrix\" folder generated CellRanger. NULL `format` \"general\". markers INFORM HALO formats. Vector containing markers used staining. Must match order 'markers' parameter locations Vector containing locations markers used staining. Location can either \"Nucleus\", \"Cytoplasm\" \"Membrane\". used select Intensity column can used instead intensity_columns_interest. dye_columns_interest HALO formats. Use locations specified. Vector names columns marker status (.e. indicating 1 0 whether cell positive negative marker). Column names must match order 'markers' parameter. intensity_columns_interest HALO formats. Use locations specified. Vector names columns level marker. Column names must match order 'markers' parameter. path_to_visium_coordinates 10X Visium data. String path \"tissue_positions_list.csv\" generated CellRanger. path_to_codex_cell_phenotypes CODEX data. String path Cluster ID/Cell type file. intensity_matrix \"general\" format. matrix marker intensities gene expression column names Cell IDs, rownames marker genes. phenotypes String Vector cell phenotypes order appear intensity_matrix. phenotypes available, vector NA can used input. Note combination markers (e.g. CD3,CD4) needs used instead cell type name (e.g. helper T cells) coord_x Numeric Vector X coordinates cells. cells must order intensity_matrix. coord_y Numeric Vector Y coordinates cells. cells must order intensity_matrix.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/format_image_to_sce.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format an image into a SingleCellExperiment object — format_image_to_sce","text":"SingleCellExperiment object returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/format_image_to_sce.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Format an image into a SingleCellExperiment object — format_image_to_sce","text":"","code":"# Please refer to the vignette for detailed examples"},{"path":"https://trigosteam.github.io/SPIAT/reference/format_sce_to_ppp.html","id":null,"dir":"Reference","previous_headings":"","what":"format_sce_to_ppp — format_sce_to_ppp","title":"format_sce_to_ppp — format_sce_to_ppp","text":"Formats sce object ppp object x,y coordinates, phenotypes markers  window specifies range x y coordinates","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/format_sce_to_ppp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"format_sce_to_ppp — format_sce_to_ppp","text":"","code":"format_sce_to_ppp(   sce_object,   window_pol = FALSE,   feature_colname = \"Phenotype\" )"},{"path":"https://trigosteam.github.io/SPIAT/reference/format_sce_to_ppp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"format_sce_to_ppp — format_sce_to_ppp","text":"sce_object SingleCellExperiment object form output format_image_to_sce window_pol Optional Boolean Specifying window polygon feature_colname String specifying feature column interest","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/format_sce_to_ppp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"format_sce_to_ppp — format_sce_to_ppp","text":"ppp object returned (defined `spatstat` package)","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/format_sce_to_ppp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"format_sce_to_ppp — format_sce_to_ppp","text":"","code":"ppp_object<-format_sce_to_ppp(SPIAT::defined_image, feature_colname = \"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/grid_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"grid_metrics — grid_metrics","title":"grid_metrics — grid_metrics","text":"Calculates specified metric grid tile image   plots metrics grid tiles.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/grid_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"grid_metrics — grid_metrics","text":"","code":"grid_metrics(sce_object, FUN, n_split, ...)"},{"path":"https://trigosteam.github.io/SPIAT/reference/grid_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"grid_metrics — grid_metrics","text":"sce_object SingleCellExperiment object form output format_image_to_sce. FUN Variable name specifying metric calculated. n_split Integer specifying number splits calculation metrics. number splits side (e.g. `n_split` = 3 means image split 9 tiles.) ... Arguments FUN","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/grid_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"grid_metrics — grid_metrics","text":"list metrics grid tiles","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/grid_metrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"grid_metrics — grid_metrics","text":"","code":"grid <- grid_metrics(SPIAT::defined_image, FUN = calculate_entropy, n_split = 5, cell_types_of_interest=c(\"Tumour\",\"Immune3\"), feature_colname = \"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_bordering_cells.html","id":null,"dir":"Reference","previous_headings":"","what":"identify_bordering_cells — identify_bordering_cells","title":"identify_bordering_cells — identify_bordering_cells","text":"Identify cells bordering group cells particular   phenotype.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_bordering_cells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"identify_bordering_cells — identify_bordering_cells","text":"","code":"identify_bordering_cells(   sce_object,   reference_cell,   feature_colname = \"Cell.Type\",   ahull_alpha = NULL,   n_of_polygons = 1,   draw = FALSE,   n_to_exclude = 10 )"},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_bordering_cells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"identify_bordering_cells — identify_bordering_cells","text":"sce_object SingleCellExperiment object form output format_image_to_sce. reference_cell String. Cells cell type used border detection. feature_colname String speficies column `reference_cell`. ahull_alpha Number specifying parameter alpha hull algorithm. larger number, cells included one cell cluster. n_of_polygons Integer specifying number tumour regions defined user. draw Boolean user chooses manually draw tumour area . Default False. n_to_exclude Integer. Clusters cell count number deleted.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_bordering_cells.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"identify_bordering_cells — identify_bordering_cells","text":"new SCE object returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_bordering_cells.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"identify_bordering_cells — identify_bordering_cells","text":"bordering cell detection algorithm based computing   alpha hull (Hemmer et al., 2020), generalization convex hull (Green   Silverman, 1979). cells detected alpha hull   identified bordering cells.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_bordering_cells.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"identify_bordering_cells — identify_bordering_cells","text":"","code":"sce_border <- identify_bordering_cells(SPIAT::defined_image, reference_cell = \"Tumour\", feature_colname = \"Cell.Type\", n_to_exclude = 10) #> [1] \"The alpha of Polygon is: 63.24375\""},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_neighborhoods.html","id":null,"dir":"Reference","previous_headings":"","what":"identify_neighborhoods — identify_neighborhoods","title":"identify_neighborhoods — identify_neighborhoods","text":"Uses Euclidean distances identify neighborhoods cells.   Three clustering methods available, including hierarchical clustering,   dbscan, Rphenograph.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_neighborhoods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"identify_neighborhoods — identify_neighborhoods","text":"","code":"identify_neighborhoods(   sce_object,   method = \"hierarchical\",   cell_types_of_interest,   radius,   min_neighborhood_size = 10,   k = 100,   feature_colname,   no_pheno = NULL )"},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_neighborhoods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"identify_neighborhoods — identify_neighborhoods","text":"sce_object SingleCellExperiment object form output format_image_to_sce. method String. clustering method. Choose \"hierarchical\", \"dbscan\" \"Rphenograph\". cell_types_of_interest String Vector phenotypes consider. radius Numeric specifying radius search. Need specify `method` \"hierarchical\" \"dbscan\". min_neighborhood_size Numeric. minimum number cells within cluster. Need specify `method` \"hierarchical\" \"dbscan\". k Numeric. parameter \"Rphenograph\" method. feature_colname String. Column cell types selected. no_pheno Cell type corresponding cells without known phenotype (e.g. \"None\", \"\")","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_neighborhoods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"identify_neighborhoods — identify_neighborhoods","text":"data.frame plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/identify_neighborhoods.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"identify_neighborhoods — identify_neighborhoods","text":"","code":"neighborhoods <- identify_neighborhoods(image_no_markers, method = \"hierarchical\", min_neighborhood_size = 100, cell_types_of_interest = c(\"Immune\", \"Immune1\", \"Immune2\"), radius = 50, feature_colname = \"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/image_no_markers.html","id":null,"dir":"Reference","previous_headings":"","what":"SCE object of a formatted image without marker intensities (simulated by\n`spaSim` package) — image_no_markers","title":"SCE object of a formatted image without marker intensities (simulated by\n`spaSim` package) — image_no_markers","text":"dataset contains formatted sce object cell ids, cell positions, cell types metadata. dataset contain assays (marker intensities).","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/image_no_markers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SCE object of a formatted image without marker intensities (simulated by\n`spaSim` package) — image_no_markers","text":"","code":"image_no_markers"},{"path":"https://trigosteam.github.io/SPIAT/reference/image_no_markers.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"SCE object of a formatted image without marker intensities (simulated by\n`spaSim` package) — image_no_markers","text":"sce object. colData contains 4951 rows (cells) 4 columns   (metadata).","code":""},{"path":[]},{"path":"https://trigosteam.github.io/SPIAT/reference/image_splitter.html","id":null,"dir":"Reference","previous_headings":"","what":"Split a large image into sub images — image_splitter","title":"Split a large image into sub images — image_splitter","text":"Takes image SingleCellExperiment format, splits   image specified sections. Users can choose plot cell positions   sub image.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/image_splitter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split a large image into sub images — image_splitter","text":"","code":"image_splitter(   sce_object,   number_of_splits,   plot = FALSE,   cut_labels = TRUE,   colour_vector = NULL,   x_position_min = NULL,   x_position_max = NULL,   y_position_min = NULL,   y_position_max = NULL,   feature_colname = \"Cell.Type\" )"},{"path":"https://trigosteam.github.io/SPIAT/reference/image_splitter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split a large image into sub images — image_splitter","text":"sce_object SingleCellExperiment object form output format_image_to_sce. number_of_splits Numeric. specifying number segments (e.g. 2 = 2x2, 3 = 3x3). plot Boolean. Specifies whether splitted images printed pdf. cut_labels Boolean. Specifies whether plot image segmented. colour_vector String Vector. specified, colours used plotting. NULL, colors generated automatically x_position_min Integer used specify minimum x boundary splitted. x_position_max Integer used specify maximum x boundary splitted. y_position_min Integer used specify minimum y boundary splitted. y_position_max Integer used specify maximum y boundary splitted. feature_colname String specifying column colouring based . Specify plot TRUE.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/image_splitter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split a large image into sub images — image_splitter","text":"list data.frames returned. data frame represents   image without assay data.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/image_splitter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Split a large image into sub images — image_splitter","text":"","code":"split_image <- image_splitter(SPIAT::simulated_image, number_of_splits=3, plot = FALSE)"},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_intensity_boxplot.html","id":null,"dir":"Reference","previous_headings":"","what":"marker_intensity_boxplot — marker_intensity_boxplot","title":"marker_intensity_boxplot — marker_intensity_boxplot","text":"Produces boxplots marker levels cells phenotyped   positive marker, phenotyped negative.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_intensity_boxplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"marker_intensity_boxplot — marker_intensity_boxplot","text":"","code":"marker_intensity_boxplot(sce_object, marker)"},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_intensity_boxplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"marker_intensity_boxplot — marker_intensity_boxplot","text":"sce_object SingleCellExperiment object form output format_image_to_sce. marker String. Marker queried.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_intensity_boxplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"marker_intensity_boxplot — marker_intensity_boxplot","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_intensity_boxplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"marker_intensity_boxplot — marker_intensity_boxplot","text":"","code":"marker_intensity_boxplot(SPIAT::simulated_image, \"Immune_marker1\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_permutation.html","id":null,"dir":"Reference","previous_headings":"","what":"marker_permutation — marker_permutation","title":"marker_permutation — marker_permutation","text":"Creates random combinations phenotypes shuffling markers.   calculates enrichment depletion p values. -- p values based hypothesis? need explanation context use ?(?)","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_permutation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"marker_permutation — marker_permutation","text":"","code":"marker_permutation(sce_object, num_iter)"},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_permutation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"marker_permutation — marker_permutation","text":"sce_object SingleCellExperiment object form output format_image_to_sce. num_iter Integer specifying number iterations bootstrapping.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_permutation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"marker_permutation — marker_permutation","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_permutation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"marker_permutation — marker_permutation","text":"","code":"sig <- marker_permutation(SPIAT::simulated_image, num_iter = 100)"},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_prediction_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"marker_prediction_plot — marker_prediction_plot","title":"marker_prediction_plot — marker_prediction_plot","text":"Takes returned dataframe marker_threshold_plot generates .pdf file containing scatter plots actual intensity predicted intensity every marker.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_prediction_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"marker_prediction_plot — marker_prediction_plot","text":"","code":"marker_prediction_plot(predicted_data, marker)"},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_prediction_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"marker_prediction_plot — marker_prediction_plot","text":"predicted_data Output predict_phenotypes. marker String. Marker plot","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_prediction_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"marker_prediction_plot — marker_prediction_plot","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_prediction_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"marker_prediction_plot — marker_prediction_plot","text":"","code":"predicted_result <- predict_phenotypes(sce_object = simulated_image, thresholds = NULL, tumour_marker = \"Tumour_marker\",baseline_markers = c(\"Immune_marker1\", \"Immune_marker2\",  \"Immune_marker3\", \"Immune_marker4\"), reference_phenotypes = TRUE) #> [1] \"Tumour_marker\"  #> [1] \"Immune_marker1\"  #> [1] \"Immune_marker2\"  #> [1] \"Immune_marker3\"  #> [1] \"Immune_marker4\"  marker_prediction_plot(predicted_result, marker = \"Tumour_marker\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_surface_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"marker_surface_plot — marker_surface_plot","title":"marker_surface_plot — marker_surface_plot","text":"Generates 3D surface plot level selected marker.   Note image blurred based 'num_splits' parameter.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_surface_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"marker_surface_plot — marker_surface_plot","text":"","code":"marker_surface_plot(   sce_object,   num_splits,   marker,   x_position_min = NULL,   x_position_max = NULL,   y_position_min = NULL,   y_position_max = NULL )"},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_surface_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"marker_surface_plot — marker_surface_plot","text":"sce_object SingleCellExperiment object form output format_image_to_sce. num_splits Integer specifying number splits image, higher splits equal higher resolution. Recommendation: 10-100 marker Marker plot x_position_min Integer specifying minimum x boundary splitted x_position_max Integer specifying maximum x boundary splitted y_position_min Integer specifying minimum y boundary splitted y_position_max Integer specifying maximum y boundary splitted","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_surface_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"marker_surface_plot — marker_surface_plot","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_surface_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"marker_surface_plot — marker_surface_plot","text":"","code":"marker_surface_plot(SPIAT::simulated_image, num_splits=15, marker=\"Immune_marker1\")  {\"x\":{\"visdat\":{\"5b76635fe706\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"5b76635fe706\",\"attrs\":{\"5b76635fe706\":{\"z\":{},\"reversescale\":true,\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"surface\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"zaxis\":{\"title\":\"mean_marker_level\"}},\"hovermode\":\"closest\",\"showlegend\":false,\"legend\":{\"yanchor\":\"top\",\"y\":0.5}},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"colorbar\":{\"title\":\"mean_marker_level\",\"ticklen\":2,\"len\":0.5,\"lenmode\":\"fraction\",\"y\":1,\"yanchor\":\"top\"},\"colorscale\":[[\"0\",\"rgba(68,1,84,1)\"],[\"0.0416666666666667\",\"rgba(70,19,97,1)\"],[\"0.0833333333333333\",\"rgba(72,32,111,1)\"],[\"0.125\",\"rgba(71,45,122,1)\"],[\"0.166666666666667\",\"rgba(68,58,128,1)\"],[\"0.208333333333333\",\"rgba(64,70,135,1)\"],[\"0.25\",\"rgba(60,82,138,1)\"],[\"0.291666666666667\",\"rgba(56,93,140,1)\"],[\"0.333333333333333\",\"rgba(49,104,142,1)\"],[\"0.375\",\"rgba(46,114,142,1)\"],[\"0.416666666666667\",\"rgba(42,123,142,1)\"],[\"0.458333333333333\",\"rgba(38,133,141,1)\"],[\"0.5\",\"rgba(37,144,140,1)\"],[\"0.541666666666667\",\"rgba(33,154,138,1)\"],[\"0.583333333333333\",\"rgba(39,164,133,1)\"],[\"0.625\",\"rgba(47,174,127,1)\"],[\"0.666666666666667\",\"rgba(53,183,121,1)\"],[\"0.708333333333333\",\"rgba(79,191,110,1)\"],[\"0.75\",\"rgba(98,199,98,1)\"],[\"0.791666666666667\",\"rgba(119,207,85,1)\"],[\"0.833333333333333\",\"rgba(147,214,70,1)\"],[\"0.875\",\"rgba(172,220,52,1)\"],[\"0.916666666666667\",\"rgba(199,225,42,1)\"],[\"0.958333333333333\",\"rgba(226,228,40,1)\"],[\"1\",\"rgba(253,231,37,1)\"]],\"showscale\":true,\"z\":[[0.125191269449563,0.103297779571842,0.232369497412571,0.0968945116132624,0.245821000833457,0.108477854473062,0.188146284275383,0.0855663819124098,0.106455956082798,0.0836729185088256,0.000972979947507266,0.10908774321612,0.260752105013254,0.111616877549738,0.117809323826204],[0.0669737780795037,0.168060523887042,0.123851788914708,0.0652160787707617,0.137064226696656,0.167068895218269,0.208839929597127,0.217182045989476,0.153028953542062,0.101908558478961,0.250905472871684,0.115608800289016,0.0630869672554789,0.15422507013329,0.137118143525146],[0.0770731825392935,0.18223555342772,0.169863248004556,0.110457345154145,0.123683528322369,0.256666242236807,0.197535585914841,0.205175367670763,0.398368067483609,0.236723314631125,0.0921097911024096,0.0978113581362956,0.120486987320687,0.0714347491849658,0.128579403279495],[0.183355378346475,0.0840211821824499,0.156470975345885,0.109512691255049,0.311836113672822,0.10638965303937,0.0846213201462295,0.0951629225032657,0.320900460901452,0.0607645190380459,0.075970068833066,0.0422723798563832,0.110473067429388,0.174383616384122,0.16930590675519],[0.117877788087379,0.0911246744037992,0.0888451311745254,0.450799536318174,0.0498348344735443,0.0384403640090901,0.0949617840358235,0.101323236585494,0.442350201187526,0.263699293499997,0.0116412082569235,0.0937181497899453,0.0688630559250375,0.140349561935985,0.159157279819624],[0.115713955376862,0.0388572424520531,0.0543304237813087,0.489338523250679,0.118302998866826,0.10970227111712,0.115691392000113,0.106851413216416,0.183470199276786,0.252552831996042,0.1605141681016,0.0142415064822186,0.167589273920608,0.0904070966333553,0.1740785502486],[0.0952941817438256,0.223295437327991,0.167151897909475,0.327782294394654,0.26780563805236,0.17487806539248,0.106737297496695,0.0287479069077426,0.0937404116761288,0.187116121898025,0.203468481184648,0.153318012035664,0.172397496910186,0.217984044432595,0.0952723853825924],[0.241178607217228,0.177820935350879,0.244369010372094,0.191777521256513,0.385462385119794,0.346025486834137,0.164994207379299,0.176637683478463,0.0705853825999823,0.220301507076569,0.280284328364283,0.23191874221366,0.3092057024028,0.161892367470978,0.138105270173174],[0.108001416131626,0.200479652746015,0.401684525730659,0.256915239520428,0.15767280944718,0.128175848453201,0.401128881144876,0.115848787692859,0.236011038387042,0.396842825796158,0.14924992613937,0.0129725199785328,0.283823173693404,0.060697934929718,0.177885166700364],[0.13298499440072,0.421830953947071,0.12565773010779,0.0791210181457949,0.125600077609211,0.23434170517727,0.21357120759885,0.165429839705615,0.138426775190248,0.238750767050283,0.159108911257583,0.271948774317281,0.300170139716372,0.209090433706112,0.138218104509174],[0.223843203182142,0.180047622196063,0.271168802419273,0.0367470980959641,0.168180114790674,0.148463696123383,0.467917012822402,0.0751965478251806,0.154491144484662,0.280272938093047,0.401455401154963,0.114634047354788,0.0776464819452332,0.0720094143334626,0.0956282410346853],[0.252875808354409,0.194031214295524,0.180685074577672,0.114705239082631,0.036255174856877,0.21755259457899,0.240142831767568,0.11362898344352,0.0718210075456046,0.138115933744268,0.0566231260482997,0.0947171380509093,0.128337771728004,0.150706805389431,0.132334860649472],[0.0866704892744729,0.137229959819496,0.42339521794549,0.0858841310919905,0.0625237264301085,0.390716905486056,0.0733413303474559,0.00697395576001184,0.105811612488265,0.191381278133629,0.176903611361948,0.0548309092529789,0.167217284399899,0.0907089227369907,0.153290760308997],[0.0797358129408459,0.0857224292781979,0.145216351144814,0.316097404433341,0.242343727228578,0.272932980294295,0.0651623089244037,0.201266366496379,0.0708396839835418,0.0947943677313092,0.153418837358351,0.101721639754777,0.0985657533228083,0.230277673675945,0.123820337362842],[0.106480704408356,0.12738995546878,0.0819096247731764,0.206481977486273,0.220235953826918,0.107590904033367,0.084461669623901,0.057107137384521,0.134485421778619,0.0627530258517664,0.0468683369589003,0.185071134820385,0.100040051594318,0.0519429462990737,0.211956827804863]],\"reversescale\":true,\"type\":\"surface\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}"},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_surface_plot_stack.html","id":null,"dir":"Reference","previous_headings":"","what":"marker_surface_plot_stack — marker_surface_plot_stack","title":"marker_surface_plot_stack — marker_surface_plot_stack","text":"Generates stacked 3D surface plots showing normalized intensity   level specified markers.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_surface_plot_stack.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"marker_surface_plot_stack — marker_surface_plot_stack","text":"","code":"marker_surface_plot_stack(   sce_object,   num_splits,   markers_to_plot,   sep = 1,   x_position_min = NULL,   x_position_max = NULL,   y_position_min = NULL,   y_position_max = NULL )"},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_surface_plot_stack.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"marker_surface_plot_stack — marker_surface_plot_stack","text":"sce_object SingleCellExperiment object form output format_image_to_sce. num_splits Integer specifying number splits image, higher splits equal higher resolution. Recommendation: 10-100. markers_to_plot Vector marker names plotting. sep Integer specifying distance separation surface plot. recommend values 1-2 range. x_position_min Integer specifying minimum x boundary splitted. x_position_max Integer specifying maximum x boundary splitted. y_position_min Integer specifying minimum y boundary splitted. y_position_max Integer specifying maximum y boundary splitted.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_surface_plot_stack.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"marker_surface_plot_stack — marker_surface_plot_stack","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/marker_surface_plot_stack.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"marker_surface_plot_stack — marker_surface_plot_stack","text":"","code":"marker_surface_plot_stack(SPIAT::simulated_image, num_splits=15,  markers=c(\"Tumour_marker\", \"Immune_marker4\"))  {\"x\":{\"visdat\":{\"5b769f026f6\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"5b769f026f6\",\"attrs\":{\"5b769f026f6\":{\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"z\":[[0.0667121967610992,0.283630675803424,0.112754006000685,0.234775612894574,0.0796015465093539,0.248077253661392,0.0253149237342597,0.0451236395981605,0.0946014872596146,0.119735752951837,0.0760694504897262,0.152538078795834,0.0688038111818676,0.0529597999325873,0.0887946903773845],[0.172680136622811,0.074078741228831,0.169366481855747,0.0468160088480532,0.131275421809517,0.153548601495502,0.0542377569621041,0.086317231902356,0.0943201152042358,0.140833466014991,0.0869613366433822,0.143270086588369,0.0889805506433455,0.192434679225336,0.054907757543153],[0.029070964636436,0.0961604341554385,0.039174292984745,0.135584933964907,0.0766066258975714,0.418654960757314,0.682891732790788,0.520107058434695,0.18476542681917,0.0619614704562987,0.102434694842037,0.168318635292263,0.0744561523455201,0.083947657624439,0.109629751918594],[0.179564605020606,0.179370269671532,0.0679081905630976,0.0657471170786242,0.39448676999966,0.992323413922979,0.963175193652883,0.824048973975986,0.223097407853188,0.164726929152674,0.117211032733841,0.128279832656747,0.0888895065429606,0.113060142127466,0.0570759272100496],[0.155126565030244,0.108091165065675,0.0378263767781359,0.0429306062590208,0.797310058479897,0.884873996192985,0.791663250785058,0.951233775337799,0.0925008019132936,0.0327204766642381,0.179953823694684,0.0405845752017644,0.0694861256853885,0.168578171681113,0.201901339721787],[0.192859358608764,0.0579813451001589,0.245495510294604,0.0705588108828678,0.917938170125817,0.946065468500667,0.931529587213757,0.863388436097001,0.775580780127284,0.290472130351181,0.118798298008694,0.149711914009191,0.0103663719175952,0.116637170557147,0.231651503031122],[0.0415206327308158,0.207304051505547,0.0788876550316076,0.0982868233705891,0.418190156034581,0.622034734608503,0.942730878475008,1,0.808259656557183,0.701840899664097,0.0860593691752759,0.120805733514622,0.102137249729526,0.0272888463999916,0.0963950256083411],[0.0971865033691279,0.0844365005163432,0.0982605593786862,0.274935533188152,0.146699831941568,0.0281143300485473,0.676904519469364,0.824397399064985,0.796650055460852,0.52886640415436,0.207616763959548,0.455802048482518,0.278128864232699,0.0704179678088165,0.136295889209102],[0.0554833274548579,0.095632774707128,0.394956641664033,0.787108608622592,0.64511473847833,0.139875264308995,0.143726096995548,0.693894223348995,0.393643286942211,0.176539664129911,0.876485452894585,0.997310308820912,0.361758402307964,0.122087594430063,0.0490072657583349],[0.209264459518433,0.173294323186741,0.748273244898906,0.964660000128666,0.869595461933072,0.468454282027372,0.150408573120283,0.0807499619057284,0.103462595404715,0.127719543212204,0.758509271817272,0.614912180376541,0.144665580755262,0.270371784102769,0.168947824055886],[0.272743408060306,0.218812797086556,0.695621443830594,0.894743302900533,0.823563467418436,0.686708159778526,0.0906801719969054,0.121530880842101,0.210676365125582,0.0924368194812089,0.0705948220160682,0.0493662062902429,0.0512214701534304,0.106771406821427,0.102269078225316],[0.162666164914993,0.0923754748466673,0.199876299947495,0.898143044921837,0.939599423031274,0.417448180245486,0.0633877085729595,0,0.0444049937492901,0.0348969767711506,0.229588631306728,0.0329077392961837,0.0897690471581768,0.189437466758341,0.174301598277323],[0.0828580812062836,0.243181360161585,0.17237788161065,0.715125612578973,0.857508380078494,0.123497180557699,0.0268687840411867,0.0822197854911925,0.167465736031817,0.139054596443811,0.0923835941379704,0.0846237774249925,0.172210065491038,0.113079761478431,0.0220435133164901],[0.06364352834345,0.119195015172604,0.0382388935331727,0.234286877292706,0.145669177404662,0.078432271353091,0.206914810209141,0.165791399580525,0.089427691596664,0.0952156587533696,0.0945706205606575,0.0305698771405312,0.208470891691743,0.103544942353813,0.0510917632504402],[0.150600453786915,0.0909322289034476,0.180722984233276,0.0626489273908985,0.0624979015257676,0.13682940395187,0.233653164205698,0.200142387788189,0.166728954272254,0.11126878998798,0.128854157922411,0.136603676068912,0.173345976207736,0.145446950016326,0.175753590146365]],\"type\":\"surface\",\"colorscale\":[[0,1],[\"rgb(255,255,255)\",\"rgb(230,159,0)\"]],\"colorbar\":{\"title\":\"Tumour_marker\"},\"inherit\":true},\"5b769f026f6.1\":{\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"z\":[[1.15285031440488,1.24981058681801,1.42408484482229,1.12831843026174,1.16927854130049,1.21063424180776,1.19963207244563,1.09034824452759,1.13755975504359,1.08370035239497,1.07685731273502,1.25575005074606,1.23473272667562,1.14133744845756,1.21327027483695],[1.12015234484426,1.21585003165165,1.31766207493188,1.05348408371466,1.06619359801248,1.13964829076597,1.29606950206786,1.26563833564422,1.14618099728547,1.15324498762682,1.17862905608314,1.22444085974736,1.16094452747033,1.16405726940299,1.07982545305642],[1.09300050655731,1.08155284731111,1.15660811144588,1.12672808749875,1.16510957304177,1.4856963163381,1.40963897165876,1.55202432342117,2,1.10251704963639,1.11407599777425,1.09303917792595,1.15736342037335,1.13759273086349,1.18224011470083],[1.22294508652401,1.16687301890267,1.32716535348333,1.30810865845525,1.59800340517847,1.14794649912262,1.29088713136546,1.20495741870368,1.64880447342848,1.21548719467395,1.30500524446519,1.21109970259044,1.12509991443122,1.14596795989467,1.15057667137589],[1.14808104516889,1.11717179003455,1.11911666207141,1.69349356966327,1.19223444589356,1.13295946479982,1.26277727577135,1.26128273862683,1.87226261922614,1.24284420503227,1.0370877660157,1.21618204800596,1.18202839045296,1.02493612088353,1.12270383363969],[1.12148167438353,1.1660211039896,1.26973034520323,1.87319577034611,1.21628828076279,1.29715662033813,1.3086848284995,1.35843225069569,1.44839863218495,1.59788506376537,1.30356650698459,1.13405027302112,1.1819593586483,1.18448246785503,1.16533986183761],[1.0729471091357,1.34403466725307,1.14872131887262,1.5480035746253,1.65285374144141,1.35652556992611,1.19707765596108,1.26410149335428,1.2287629828789,1.43653069381347,1.42026073482498,1.16203689994174,1.37925447943363,1.11715764528762,1.16022270407154],[1.2375130043695,1.1675317432984,1.44330586868833,1.40805965905721,1.57246889459874,1.62364003264163,1.41102840344457,1.40953228257936,1.23187594159894,1.48674387949701,1.71372517284041,1.52106139226459,1.66264811729733,1.26579419937638,1.2615159936257],[1.05229101324565,1.29562665069869,1.65828370753818,1.47367948713088,1.35910010788379,1.35268763166705,1.74826463886039,1.24581124637615,1.51706955198658,1.78836113936046,1.19933190827437,1.15550049108759,1.68222123819974,1.22004040493692,1.07077802249738],[1.07824494188993,1.5970089551913,1.38088973350649,1.25475306053372,1.44658325281516,1.54005414291575,1.16666244314406,1.23118386349368,1.12394910225739,1.45638902900412,1.42743071798877,1.61857200659219,1.43266439679022,1.20866481554562,1.10252917340885],[1.04645453805869,1.34571729251439,1.59599436751779,1.11399505281889,1.33037326203652,1.33529627006178,1.75269500138976,1.14725073123981,1.15152267655559,1.40573119814267,1.62364242641435,1.15186626888292,1.18821563262227,1.0137256067723,1.18321028727247],[1.25862678846951,1.19676616782219,1.62382337563919,1.27934791464426,1.10860519763018,1.58771236893211,1.52750499613304,1.14870441674115,1.21979122885472,1.16365772238129,1.09960709898064,1.21011349374264,1.26184345850977,1.10388133412007,1.12791664325234],[1.15988729386126,1.14273511982052,1.63518455080426,1.3470642102132,1.30148819250988,1.76825789311455,1.19946525119905,1.09901434394896,1.11280412324014,1.27220069223301,1.14438225787675,1.11859440422619,1.10023276927872,1.22950628490687,1.1285169607586],[1.12300422798274,1.1830711558167,1.42726821639061,1.64448135080347,1.39501408104744,1.24520758395495,1.17341436923605,1.19762309068131,1.10679319602552,1.15057537967258,1.27784597341953,1.10071485432336,1.13614309230583,1,1.14739738908345],[1.15140429783054,1.09644364801957,1.13923060724556,1.16071284914068,1.07063067897219,1.09098543966822,1.11140877540759,1.21849119896514,1.15844182935574,1.14997771621915,1.05540456252619,1.10049020236151,1.09350400689362,1.22923236034252,1.249332446738]],\"type\":\"surface\",\"colorscale\":[[0,1],[\"rgb(255,255,255)\",\"rgb(86,180,233)\"]],\"colorbar\":{\"title\":\"Immune_marker4\"},\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"zaxis\":{\"title\":[]}},\"hovermode\":\"closest\",\"showlegend\":false,\"legend\":{\"yanchor\":\"top\",\"y\":0.333333333333333}},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"colorbar\":{\"title\":\"Tumour_marker\",\"ticklen\":2,\"len\":0.333333333333333,\"lenmode\":\"fraction\",\"y\":1,\"yanchor\":\"top\"},\"colorscale\":[[0,\"rgb(255,255,255)\"],[1,\"rgb(230,159,0)\"]],\"showscale\":true,\"z\":[[0.0667121967610992,0.283630675803424,0.112754006000685,0.234775612894574,0.0796015465093539,0.248077253661392,0.0253149237342597,0.0451236395981605,0.0946014872596146,0.119735752951837,0.0760694504897262,0.152538078795834,0.0688038111818676,0.0529597999325873,0.0887946903773845],[0.172680136622811,0.074078741228831,0.169366481855747,0.0468160088480532,0.131275421809517,0.153548601495502,0.0542377569621041,0.086317231902356,0.0943201152042358,0.140833466014991,0.0869613366433822,0.143270086588369,0.0889805506433455,0.192434679225336,0.054907757543153],[0.029070964636436,0.0961604341554385,0.039174292984745,0.135584933964907,0.0766066258975714,0.418654960757314,0.682891732790788,0.520107058434695,0.18476542681917,0.0619614704562987,0.102434694842037,0.168318635292263,0.0744561523455201,0.083947657624439,0.109629751918594],[0.179564605020606,0.179370269671532,0.0679081905630976,0.0657471170786242,0.39448676999966,0.992323413922979,0.963175193652883,0.824048973975986,0.223097407853188,0.164726929152674,0.117211032733841,0.128279832656747,0.0888895065429606,0.113060142127466,0.0570759272100496],[0.155126565030244,0.108091165065675,0.0378263767781359,0.0429306062590208,0.797310058479897,0.884873996192985,0.791663250785058,0.951233775337799,0.0925008019132936,0.0327204766642381,0.179953823694684,0.0405845752017644,0.0694861256853885,0.168578171681113,0.201901339721787],[0.192859358608764,0.0579813451001589,0.245495510294604,0.0705588108828678,0.917938170125817,0.946065468500667,0.931529587213757,0.863388436097001,0.775580780127284,0.290472130351181,0.118798298008694,0.149711914009191,0.0103663719175952,0.116637170557147,0.231651503031122],[0.0415206327308158,0.207304051505547,0.0788876550316076,0.0982868233705891,0.418190156034581,0.622034734608503,0.942730878475008,1,0.808259656557183,0.701840899664097,0.0860593691752759,0.120805733514622,0.102137249729526,0.0272888463999916,0.0963950256083411],[0.0971865033691279,0.0844365005163432,0.0982605593786862,0.274935533188152,0.146699831941568,0.0281143300485473,0.676904519469364,0.824397399064985,0.796650055460852,0.52886640415436,0.207616763959548,0.455802048482518,0.278128864232699,0.0704179678088165,0.136295889209102],[0.0554833274548579,0.095632774707128,0.394956641664033,0.787108608622592,0.64511473847833,0.139875264308995,0.143726096995548,0.693894223348995,0.393643286942211,0.176539664129911,0.876485452894585,0.997310308820912,0.361758402307964,0.122087594430063,0.0490072657583349],[0.209264459518433,0.173294323186741,0.748273244898906,0.964660000128666,0.869595461933072,0.468454282027372,0.150408573120283,0.0807499619057284,0.103462595404715,0.127719543212204,0.758509271817272,0.614912180376541,0.144665580755262,0.270371784102769,0.168947824055886],[0.272743408060306,0.218812797086556,0.695621443830594,0.894743302900533,0.823563467418436,0.686708159778526,0.0906801719969054,0.121530880842101,0.210676365125582,0.0924368194812089,0.0705948220160682,0.0493662062902429,0.0512214701534304,0.106771406821427,0.102269078225316],[0.162666164914993,0.0923754748466673,0.199876299947495,0.898143044921837,0.939599423031274,0.417448180245486,0.0633877085729595,0,0.0444049937492901,0.0348969767711506,0.229588631306728,0.0329077392961837,0.0897690471581768,0.189437466758341,0.174301598277323],[0.0828580812062836,0.243181360161585,0.17237788161065,0.715125612578973,0.857508380078494,0.123497180557699,0.0268687840411867,0.0822197854911925,0.167465736031817,0.139054596443811,0.0923835941379704,0.0846237774249925,0.172210065491038,0.113079761478431,0.0220435133164901],[0.06364352834345,0.119195015172604,0.0382388935331727,0.234286877292706,0.145669177404662,0.078432271353091,0.206914810209141,0.165791399580525,0.089427691596664,0.0952156587533696,0.0945706205606575,0.0305698771405312,0.208470891691743,0.103544942353813,0.0510917632504402],[0.150600453786915,0.0909322289034476,0.180722984233276,0.0626489273908985,0.0624979015257676,0.13682940395187,0.233653164205698,0.200142387788189,0.166728954272254,0.11126878998798,0.128854157922411,0.136603676068912,0.173345976207736,0.145446950016326,0.175753590146365]],\"type\":\"surface\",\"frame\":null},{\"colorbar\":{\"title\":\"Immune_marker4\",\"ticklen\":2,\"len\":0.333333333333333,\"lenmode\":\"fraction\",\"y\":0.666666666666667,\"yanchor\":\"top\"},\"colorscale\":[[0,\"rgb(255,255,255)\"],[1,\"rgb(86,180,233)\"]],\"showscale\":true,\"z\":[[1.15285031440488,1.24981058681801,1.42408484482229,1.12831843026174,1.16927854130049,1.21063424180776,1.19963207244563,1.09034824452759,1.13755975504359,1.08370035239497,1.07685731273502,1.25575005074606,1.23473272667562,1.14133744845756,1.21327027483695],[1.12015234484426,1.21585003165165,1.31766207493188,1.05348408371466,1.06619359801248,1.13964829076597,1.29606950206786,1.26563833564422,1.14618099728547,1.15324498762682,1.17862905608314,1.22444085974736,1.16094452747033,1.16405726940299,1.07982545305642],[1.09300050655731,1.08155284731111,1.15660811144588,1.12672808749875,1.16510957304177,1.4856963163381,1.40963897165876,1.55202432342117,2,1.10251704963639,1.11407599777425,1.09303917792595,1.15736342037335,1.13759273086349,1.18224011470083],[1.22294508652401,1.16687301890267,1.32716535348333,1.30810865845525,1.59800340517847,1.14794649912262,1.29088713136546,1.20495741870368,1.64880447342848,1.21548719467395,1.30500524446519,1.21109970259044,1.12509991443122,1.14596795989467,1.15057667137589],[1.14808104516889,1.11717179003455,1.11911666207141,1.69349356966327,1.19223444589356,1.13295946479982,1.26277727577135,1.26128273862683,1.87226261922614,1.24284420503227,1.0370877660157,1.21618204800596,1.18202839045296,1.02493612088353,1.12270383363969],[1.12148167438353,1.1660211039896,1.26973034520323,1.87319577034611,1.21628828076279,1.29715662033813,1.3086848284995,1.35843225069569,1.44839863218495,1.59788506376537,1.30356650698459,1.13405027302112,1.1819593586483,1.18448246785503,1.16533986183761],[1.0729471091357,1.34403466725307,1.14872131887262,1.5480035746253,1.65285374144141,1.35652556992611,1.19707765596108,1.26410149335428,1.2287629828789,1.43653069381347,1.42026073482498,1.16203689994174,1.37925447943363,1.11715764528762,1.16022270407154],[1.2375130043695,1.1675317432984,1.44330586868833,1.40805965905721,1.57246889459874,1.62364003264163,1.41102840344457,1.40953228257936,1.23187594159894,1.48674387949701,1.71372517284041,1.52106139226459,1.66264811729733,1.26579419937638,1.2615159936257],[1.05229101324565,1.29562665069869,1.65828370753818,1.47367948713088,1.35910010788379,1.35268763166705,1.74826463886039,1.24581124637615,1.51706955198658,1.78836113936046,1.19933190827437,1.15550049108759,1.68222123819974,1.22004040493692,1.07077802249738],[1.07824494188993,1.5970089551913,1.38088973350649,1.25475306053372,1.44658325281516,1.54005414291575,1.16666244314406,1.23118386349368,1.12394910225739,1.45638902900412,1.42743071798877,1.61857200659219,1.43266439679022,1.20866481554562,1.10252917340885],[1.04645453805869,1.34571729251439,1.59599436751779,1.11399505281889,1.33037326203652,1.33529627006178,1.75269500138976,1.14725073123981,1.15152267655559,1.40573119814267,1.62364242641435,1.15186626888292,1.18821563262227,1.0137256067723,1.18321028727247],[1.25862678846951,1.19676616782219,1.62382337563919,1.27934791464426,1.10860519763018,1.58771236893211,1.52750499613304,1.14870441674115,1.21979122885472,1.16365772238129,1.09960709898064,1.21011349374264,1.26184345850977,1.10388133412007,1.12791664325234],[1.15988729386126,1.14273511982052,1.63518455080426,1.3470642102132,1.30148819250988,1.76825789311455,1.19946525119905,1.09901434394896,1.11280412324014,1.27220069223301,1.14438225787675,1.11859440422619,1.10023276927872,1.22950628490687,1.1285169607586],[1.12300422798274,1.1830711558167,1.42726821639061,1.64448135080347,1.39501408104744,1.24520758395495,1.17341436923605,1.19762309068131,1.10679319602552,1.15057537967258,1.27784597341953,1.10071485432336,1.13614309230583,1,1.14739738908345],[1.15140429783054,1.09644364801957,1.13923060724556,1.16071284914068,1.07063067897219,1.09098543966822,1.11140877540759,1.21849119896514,1.15844182935574,1.14997771621915,1.05540456252619,1.10049020236151,1.09350400689362,1.22923236034252,1.249332446738]],\"type\":\"surface\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}"},{"path":"https://trigosteam.github.io/SPIAT/reference/measure_association_to_cell_properties.html","id":null,"dir":"Reference","previous_headings":"","what":"measure_association_to_cell_properties — measure_association_to_cell_properties","title":"measure_association_to_cell_properties — measure_association_to_cell_properties","text":"Plots density boxplot property two cell celltypes   compares using t test/wilcoxon rank sum test.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/measure_association_to_cell_properties.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"measure_association_to_cell_properties — measure_association_to_cell_properties","text":"","code":"measure_association_to_cell_properties(   sce_object,   property = \"Cell.Area\",   celltypes,   feature_colname = \"Cell.Type\",   method = \"density\",   Nucleus.Ratio = FALSE,   log.scale = FALSE )"},{"path":"https://trigosteam.github.io/SPIAT/reference/measure_association_to_cell_properties.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"measure_association_to_cell_properties — measure_association_to_cell_properties","text":"sce_object SingleCellExperiment object form output format_image_to_sce. property String name column interest. celltypes String Vector celltypes interest. feature_colname String speficies column cell types. method String. analysis perform selected cell types property. Options \"density\", \"box\", \"t\", \"wilcox\". Nucleus.Ratio Boolean whether ratio nucleus size interest. log.scale Boolean whether log data.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/measure_association_to_cell_properties.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"measure_association_to_cell_properties — measure_association_to_cell_properties","text":"method \"box\" \"density plot returned. method \"t\"   \"wilcox\", text output test returned.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/measure_association_to_cell_properties.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"measure_association_to_cell_properties — measure_association_to_cell_properties","text":"","code":"measure_association_to_cell_properties(image_no_markers,                                       celltypes = c(\"Tumour\", \"Immune1\"),                                       feature_colname = \"Cell.Type\",                                       property = \"Cell.Size\",                                       method = \"box\")  measure_association_to_cell_properties(image_no_markers,                                       celltypes = c(\"Tumour\", \"Immune2\"),                                       feature_colname=\"Cell.Type\",                                       property = \"Cell.Size\",                                       method = \"t\") #>  #> \tWelch Two Sample t-test #>  #> data:  Tumour and Immune2 #> t = 27.397, df = 230.97, p-value < 2.2e-16 #> alternative hypothesis: true difference in means is not equal to 0 #> 95 percent confidence interval: #>  5.448048 6.292373 #> sample estimates: #> mean of x mean of y  #> 14.797360  8.927149  #>"},{"path":"https://trigosteam.github.io/SPIAT/reference/mixing_score_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the (normalised) mixing score for interested cell types — mixing_score_summary","title":"Calculate the (normalised) mixing score for interested cell types — mixing_score_summary","text":"Produces data.frame mixing scores input reference   target cells SingleCellExperiment object. calculates   reference-target interactions reference-reference interactions based   radius. derives mixing score normalised mixing score.   Function returns NA mixing score calculated cells   type.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/mixing_score_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the (normalised) mixing score for interested cell types — mixing_score_summary","text":"","code":"mixing_score_summary(   sce_object,   reference_celltype,   target_celltype,   radius = 20,   feature_colname )"},{"path":"https://trigosteam.github.io/SPIAT/reference/mixing_score_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the (normalised) mixing score for interested cell types — mixing_score_summary","text":"sce_object SingleCellExperiment object form output format_image_to_sce. reference_celltype String Vector. Cell types reference cells. target_celltype String Vector. Cell types target cells. radius maximum radius around reference cell type another cell considered interaction. feature_colname String specifying column desired cell type annotations.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/mixing_score_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the (normalised) mixing score for interested cell types — mixing_score_summary","text":"data.frame cell numbers, mixing scores, normalised mixing   scores.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/mixing_score_summary.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate the (normalised) mixing score for interested cell types — mixing_score_summary","text":"mixing score originally defined number   immune-tumour interactions divided number immune-immune   interactions within defined radius (Keren et al., 2018). normalised   mixing score normalises immune-tumour interactions immune-immune   interactions within radius total number immune-tumour   immune-immune interactions image, respectively. generalized   score allow calculation two cell phenotypes defined   user.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/mixing_score_summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the (normalised) mixing score for interested cell types — mixing_score_summary","text":"","code":"mixing_score_summary(SPIAT::defined_image, reference_celltype = \"Tumour\", target_celltype=\"Immune1\", radius = 50, feature_colname = \"Cell.Type\") #>   Reference  Target Number_of_reference_cells Number_of_target_cells #> 2    Tumour Immune1                       819                    338 #>   Reference_target_interaction Reference_reference_interaction Mixing_score #> 2                           80                            5026   0.01591723 #>   Normalised_mixing_score #> 2              0.07704316"},{"path":"https://trigosteam.github.io/SPIAT/reference/number_of_cells_within_radius.html","id":null,"dir":"Reference","previous_headings":"","what":"number_of_cells_within_radius — number_of_cells_within_radius","title":"number_of_cells_within_radius — number_of_cells_within_radius","text":"Calculates number cells target cell type   within pre-defined radius around cells reference cell type.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/number_of_cells_within_radius.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"number_of_cells_within_radius — number_of_cells_within_radius","text":"","code":"number_of_cells_within_radius(   sce_object,   reference_celltype,   target_celltype,   radius = 20,   feature_colname )"},{"path":"https://trigosteam.github.io/SPIAT/reference/number_of_cells_within_radius.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"number_of_cells_within_radius — number_of_cells_within_radius","text":"sce_object SingleCellExperiment object form output format_image_to_sce. reference_celltype String. Cell type used reference cells. target_celltype String. Cell type used target cells. radius Numeric. Radius around reference cells. feature_colname String specifying column desired cell type annotations.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/number_of_cells_within_radius.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"number_of_cells_within_radius — number_of_cells_within_radius","text":"list dataframes number target cells   reference cells","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/number_of_cells_within_radius.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"number_of_cells_within_radius — number_of_cells_within_radius","text":"","code":"n_in_radius <- number_of_cells_within_radius(SPIAT::defined_image, reference_celltype = \"Tumour\", target_celltype=\"Immune1\", radius = 50, feature_colname = \"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_average_intensity.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_average_intensity — plot_average_intensity","title":"plot_average_intensity — plot_average_intensity","text":"Takes vector radii calculates average intensity   target marker using average_intensity function. plots intensity   level line graph.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_average_intensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_average_intensity — plot_average_intensity","text":"","code":"plot_average_intensity(sce_object, reference_marker, target_marker, radii)"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_average_intensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_average_intensity — plot_average_intensity","text":"sce_object SingleCellExperiment object form output format_image_to_sce. reference_marker String specifying reference marker. target_marker String specifying marker calculate average intensity. radii Numeric Vector specifying search radius around reference cells.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_average_intensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot_average_intensity — plot_average_intensity","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_average_intensity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot_average_intensity — plot_average_intensity","text":"","code":"plot_average_intensity(SPIAT::simulated_image, reference_marker=\"Immune_marker3\",  target_marker=\"Immune_marker2\", c(30, 35, 40, 45, 50, 75, 100))"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_categories.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_cell_categories — plot_cell_categories","title":"plot_cell_categories — plot_cell_categories","text":"Produces scatter plot cells x-y positions   tissue. Cells coloured categorically phenotype. Cells part   phenotypes interest coloured \"lightgrey\".","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_categories.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_cell_categories — plot_cell_categories","text":"","code":"plot_cell_categories(   sce_object,   categories_of_interest = NULL,   colour_vector = NULL,   feature_colname = \"Cell.Type\",   cex = 1,   layered = FALSE )"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_categories.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_cell_categories — plot_cell_categories","text":"sce_object SingleCellExperiment object form output format_image_to_sce. categories_of_interest Vector cell categories coloured colour_vector Vector specifying colours cell phenotype feature_colname String specifying column cell categories belong cex Numeric. size plot points. Default 1. layered Boolean. Whether plot cells layer layer (cell categories). default FALSE.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_categories.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot_cell_categories — plot_cell_categories","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_categories.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot_cell_categories — plot_cell_categories","text":"","code":"categories_of_interest <- c(\"Tumour\", \"Immune1\",\"Immune2\",\"Immune3\") colour_vector <- c(\"red\",\"darkblue\",\"blue\",\"darkgreen\") plot_cell_categories(SPIAT::defined_image, categories_of_interest, colour_vector, feature_colname = \"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_distances_violin.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_cell_distances_violin — plot_cell_distances_violin","title":"plot_cell_distances_violin — plot_cell_distances_violin","text":"Plots distances cells violin plot","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_distances_violin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_cell_distances_violin — plot_cell_distances_violin","text":"","code":"plot_cell_distances_violin(cell_to_cell_dist)"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_distances_violin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_cell_distances_violin — plot_cell_distances_violin","text":"cell_to_cell_dist Data.frame containing distance output cell types. functions generate distances can calculate_minimum_distances_between_celltypes calculate_pairwise_distances_between_celltypes.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_distances_violin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot_cell_distances_violin — plot_cell_distances_violin","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_distances_violin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot_cell_distances_violin — plot_cell_distances_violin","text":"","code":"distances <- calculate_pairwise_distances_between_celltypes(SPIAT::defined_image, cell_types_of_interest = c(\"Immune1\", \"Immune2\"), feature_colname=\"Cell.Type\") plot_cell_distances_violin(distances)"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_marker_levels.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_cell_marker_levels — plot_cell_marker_levels","title":"plot_cell_marker_levels — plot_cell_marker_levels","text":"Produces scatter plot level marker cell.   level marker cells shown, x-y positions, matter   cells phenotyped positive negative particular   marker.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_marker_levels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_cell_marker_levels — plot_cell_marker_levels","text":"","code":"plot_cell_marker_levels(sce_object, marker)"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_marker_levels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_cell_marker_levels — plot_cell_marker_levels","text":"sce_object Singlecellexperiment object form output format_image_to_sce. marker String. Marker plot.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_marker_levels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot_cell_marker_levels — plot_cell_marker_levels","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_marker_levels.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot_cell_marker_levels — plot_cell_marker_levels","text":"","code":"plot_cell_marker_levels(SPIAT::simulated_image, \"Immune_marker1\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_percentages.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_cell_percentages — plot_cell_percentages","title":"plot_cell_percentages — plot_cell_percentages","text":"Plots cells proportions barplots.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_percentages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_cell_percentages — plot_cell_percentages","text":"","code":"plot_cell_percentages(   cell_proportions,   cells_to_exclude = NULL,   cellprop_colname = \"Proportion_name\" )"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_percentages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_cell_percentages — plot_cell_percentages","text":"cell_proportions Data Frame. Output calculate_cell_proportions. cells_to_exclude String Vector. Markers exclude. cellprop_colname String. Column use y axis names. Default \"Proportion_name\".","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_percentages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot_cell_percentages — plot_cell_percentages","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_cell_percentages.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot_cell_percentages — plot_cell_percentages","text":"","code":"p_cells <- calculate_cell_proportions(SPIAT::simulated_image)  plot_cell_percentages(p_cells)"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_composition_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_composition_heatmap — plot_composition_heatmap","title":"plot_composition_heatmap — plot_composition_heatmap","text":"Produces heatmap showing marker percentages within   cluster cluster sizes.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_composition_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_composition_heatmap — plot_composition_heatmap","text":"","code":"plot_composition_heatmap(   composition,   pheno_to_exclude = NULL,   log_values = FALSE,   feature_colname )"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_composition_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_composition_heatmap — plot_composition_heatmap","text":"composition Data.frame. Output composition_of_neighborhoods. pheno_to_exclude String Vector phenotype exclude. log_values Boolean. TRUE percentages logged (base 10). feature_colname String. Column cell types.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_composition_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot_composition_heatmap — plot_composition_heatmap","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_composition_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot_composition_heatmap — plot_composition_heatmap","text":"","code":"neighborhoods <- identify_neighborhoods(image_no_markers, method = \"hierarchical\", min_neighborhood_size = 100, cell_types_of_interest = c(\"Immune\", \"Immune1\", \"Immune2\"), radius = 50, feature_colname = \"Cell.Type\")  neighborhoods_vis <- composition_of_neighborhoods(neighborhoods, feature_colname=\"Cell.Type\") plot_composition_heatmap(neighborhoods_vis, feature_colname=\"Cell.Type\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_distance_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_distance_heatmap — plot_distance_heatmap","title":"plot_distance_heatmap — plot_distance_heatmap","text":"Takes output cell_distances plot distances   heatmap.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_distance_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_distance_heatmap — plot_distance_heatmap","text":"","code":"plot_distance_heatmap(phenotype_distances_result, metric = \"mean\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_distance_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_distance_heatmap — plot_distance_heatmap","text":"phenotype_distances_result Dataframe output `calculate_summary_distances_between_celltypes` `calculate_minimum_distances_between_celltypes`. metric Metric plotted. One \"mean\", \"std.dev\", \"median\", \"min\" \"max\".","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_distance_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot_distance_heatmap — plot_distance_heatmap","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_distance_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot_distance_heatmap — plot_distance_heatmap","text":"","code":"dists <- calculate_pairwise_distances_between_celltypes(SPIAT::defined_image,  cell_types_of_interest = c(\"Tumour\",\"Immune1\"), feature_colname = \"Cell.Type\") summary_distances <- calculate_summary_distances_between_celltypes(dists) plot_distance_heatmap(summary_distances)"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_marker_level_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_marker_level_heatmap — plot_marker_level_heatmap","title":"plot_marker_level_heatmap — plot_marker_level_heatmap","text":"Blurs image splitting images small squares.   marker levels averaged within square. cells   considered, regardless phenotype status.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_marker_level_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_marker_level_heatmap — plot_marker_level_heatmap","text":"","code":"plot_marker_level_heatmap(sce_object, num_splits, marker)"},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_marker_level_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_marker_level_heatmap — plot_marker_level_heatmap","text":"sce_object SingleCellExperiment object form output format_image_to_sce. num_splits Integer specifying blurring level (number splits) image. Higher numbers result higher resolution. marker String. Marker plot.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_marker_level_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot_marker_level_heatmap — plot_marker_level_heatmap","text":"plot returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/plot_marker_level_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot_marker_level_heatmap — plot_marker_level_heatmap","text":"","code":"plot_marker_level_heatmap(SPIAT::simulated_image, num_splits = 100, \"Tumour_marker\")"},{"path":"https://trigosteam.github.io/SPIAT/reference/predict_phenotypes.html","id":null,"dir":"Reference","previous_headings":"","what":"predict_phenotypes — predict_phenotypes","title":"predict_phenotypes — predict_phenotypes","text":"Predicts cell phenotypes based marker intensity levels.   prior cell phenotypes available, adds phenotypes   SingleCellExperiment object used input. reference cell phenotypes   available, produces density plot showing predicted cutoff   positive reading marker intensity returns dataframe containing   predicted intensity status particular marker.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/predict_phenotypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"predict_phenotypes — predict_phenotypes","text":"","code":"predict_phenotypes(   sce_object,   thresholds = NULL,   tumour_marker,   baseline_markers,   nuclear_marker = NULL,   reference_phenotypes = FALSE,   markers_to_phenotype = NULL,   plot_distribution = TRUE )"},{"path":"https://trigosteam.github.io/SPIAT/reference/predict_phenotypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"predict_phenotypes — predict_phenotypes","text":"sce_object SingleCellExperiment object generated format_image_to_sce. thresholds (Optional) Numeric Vector specifying cutoff positive reading. order must match marker order, NA DAPI. tumour_marker String containing tumour_marker used image. tumor cells known, annotate tumor cells 1 non-tumor cells 0, include rowname. baseline_markers String Vector. Markers found tumour cells refine threshold used tumour cell phenotying. nuclear_marker String. Nuclear marker used. reference_phenotypes Boolean. TRUE FALSE value whether reference phenotypes sample obtained user means (e.g. HALO InForm). reference phenotypes available, matrix predicted phenotypes, intensities, reference phenotypes returned, can used input \"marker_prediction_plot\". reference phenotype available, result function added sce object used input. Note reference phenotype used, phenotypes must explicit combination positive markers (e.g. AMACR,PDL1), opposed descriptive (PDL1+ tumour cells). markers_to_phenotype String Vector. Markers included phenotyping. NULL, markers used. DAPI needs excluded. plot_distribution Boolean. TRUE, plots marker intensities distributions cutoffs plotted.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/predict_phenotypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"predict_phenotypes — predict_phenotypes","text":"updated sce object cell phenotypes data.frame   predicted phenotypes","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/predict_phenotypes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"predict_phenotypes — predict_phenotypes","text":"","code":"# keep the original phenotypes predicted_result <- predict_phenotypes(sce_object = simulated_image, thresholds = NULL, tumour_marker = \"Tumour_marker\",baseline_markers = c(\"Immune_marker1\", \"Immune_marker2\", \"Immune_marker3\", \"Immune_marker4\"), reference_phenotypes = TRUE) #> [1] \"Tumour_marker\"  #> [1] \"Immune_marker1\"  #> [1] \"Immune_marker2\"  #> [1] \"Immune_marker3\"  #> [1] \"Immune_marker4\"  # update the predicted phenotypes predicted_sce_image <- predict_phenotypes(sce_object = simulated_image, thresholds = NULL, tumour_marker = \"Tumour_marker\",baseline_markers = c(\"Immune_marker1\", \"Immune_marker2\", \"Immune_marker3\", \"Immune_marker4\"), reference_phenotypes = FALSE) #> [1] \"Tumour_marker  threshold intensity:  0.445450443784465\"  #> [1] \"Immune_marker1  threshold intensity:  0.116980867970434\"  #> [1] \"Immune_marker2  threshold intensity:  0.124283809517202\"  #> [1] \"Immune_marker3  threshold intensity:  0.0166413130263845\"  #> [1] \"Immune_marker4  threshold intensity:  0.00989731350898589\""},{"path":"https://trigosteam.github.io/SPIAT/reference/print_feature.html","id":null,"dir":"Reference","previous_headings":"","what":"Print the unique values of a specified column — print_feature","title":"Print the unique values of a specified column — print_feature","text":"Print unique values specified column (feature).","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/print_feature.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print the unique values of a specified column — print_feature","text":"","code":"print_feature(sce_object, feature_colname)"},{"path":"https://trigosteam.github.io/SPIAT/reference/print_feature.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print the unique values of a specified column — print_feature","text":"sce_object SingleCellExperiment object generated format_image_to_sce. feature_colname String specified column.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/print_feature.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print the unique values of a specified column — print_feature","text":"character vector returned","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/print_feature.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print the unique values of a specified column — print_feature","text":"","code":"feature_colname <- \"Phenotype\" print_feature(SPIAT::simulated_image, feature_colname) #> [1] \"OTHER\"                                        #> [2] \"Immune_marker1,Immune_marker2\"                #> [3] \"Tumour_marker\"                                #> [4] \"Immune_marker1,Immune_marker2,Immune_marker4\" #> [5] \"Immune_marker1,Immune_marker3\""},{"path":"https://trigosteam.github.io/SPIAT/reference/select_celltypes.html","id":null,"dir":"Reference","previous_headings":"","what":"select_celltypes — select_celltypes","title":"select_celltypes — select_celltypes","text":"Select cell types keep exclude analysis. output   function also includes original image size cell count.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/select_celltypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"select_celltypes — select_celltypes","text":"","code":"select_celltypes(   sce_object,   celltypes,   feature_colname = \"Phenotype\",   keep = TRUE )"},{"path":"https://trigosteam.github.io/SPIAT/reference/select_celltypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"select_celltypes — select_celltypes","text":"sce_object SingleCellExperiment object generated format_image_to_sce. celltypes String Vector celltypes keep exclude. feature_colname String. column interested cell types. cells interest specified rownames, use \"rowname\" arg. keep Boolean. TRUE vector `celltypes` cells going kept, FALSE removed.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/select_celltypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"select_celltypes — select_celltypes","text":"SingleCellExperiment object returned. original image size   cell count can accessed `attr(slim_sce, \"original_cell_number\")`   `attr(slim_sce, \"range_of_coords\")`.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/select_celltypes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"select_celltypes — select_celltypes","text":"","code":"data_subset <- select_celltypes(SPIAT::simulated_image, celltypes = c(\"Tumour_marker\",\"Immune_marker1\",\"Immune_marker2\",\"Immune_marker3\",\"Immune_marker4\"), feature_colname = \"Phenotype\", keep=TRUE) attr(data_subset, \"original_cell_number\") #cell number in the original image #> [1] 4951 attr(data_subset, \"range_of_coords\") #> [1]    0.1869877 1999.9512939    0.3243161 1998.9921875 dim(data_subset)[2] # this is the new image cell number #> [1] 819"},{"path":"https://trigosteam.github.io/SPIAT/reference/simulated_image.html","id":null,"dir":"Reference","previous_headings":"","what":"SCE object of a formatted image (simulated by `spaSim` package) — simulated_image","title":"SCE object of a formatted image (simulated by `spaSim` package) — simulated_image","text":"dataset contains formatted sce object cell ids, cell positions, phenotypes metadata marker intensities assays.","code":""},{"path":"https://trigosteam.github.io/SPIAT/reference/simulated_image.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SCE object of a formatted image (simulated by `spaSim` package) — simulated_image","text":"","code":"simulated_image"},{"path":"https://trigosteam.github.io/SPIAT/reference/simulated_image.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"SCE object of a formatted image (simulated by `spaSim` package) — simulated_image","text":"sce object. Assay contains 5 rows (markers) 4951 columns   (cells); colData contains 4951 rows (cells) 3 columns (metadata).","code":""},{"path":[]},{"path":"https://trigosteam.github.io/SPIAT/news/index.html","id":"spiat-02","dir":"Changelog","previous_headings":"","what":"SPIAT 0.2","title":"SPIAT 0.2","text":"Version submitted BioRxiv","code":""}]
