<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spatial heterogeneity with SPIAT • SPIAT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spatial heterogeneity with SPIAT">
<meta property="og:description" content="SPIAT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPIAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SPIAT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic_analysis.html">Basic analyses with SPIAT</a>
    </li>
    <li>
      <a href="../articles/cell-colocalisation.html">Quantifying cell colocalisation with SPIAT</a>
    </li>
    <li>
      <a href="../articles/data_reading-formatting.html">Reading in data and data formatting in SPIAT</a>
    </li>
    <li>
      <a href="../articles/neighborhood.html">Identifying cellular neighborhood with SPIAT</a>
    </li>
    <li>
      <a href="../articles/quality-control_visualisation.html">Quality control and visualisation with SPIAT</a>
    </li>
    <li>
      <a href="../articles/spatial-heterogeneity.html">Spatial heterogeneity with SPIAT</a>
    </li>
    <li>
      <a href="../articles/tissue-structure.html">Characterising tissue structure with SPIAT</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/trigosteam/SPIAT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spatial heterogeneity with SPIAT</h1>
                        <h4 data-toc-skip class="author">Yuzhou
Feng</h4>
            
            <h4 data-toc-skip class="date">2023-04-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/trigosteam/SPIAT/blob/HEAD/vignettes/spatial-heterogeneity.Rmd" class="external-link"><code>vignettes/spatial-heterogeneity.Rmd</code></a></small>
      <div class="hidden name"><code>spatial-heterogeneity.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://trigosteam.github.io/SPIAT/" class="external-link">SPIAT</a></span><span class="op">)</span></span></code></pre></div>
<p>Cell colocalisation metrics allow capturing a dominant spatial
pattern in an image. However, patterns are unlikely to be distributed
evenly in a tissue, but rather there will be spatial heterogeneity of
patterns. To measure this, SPIAT splits the image into smaller images
(either using a grid or concentric circles around a reference cell
population), followed by calculation of a spatial metric of a pattern of
interest (e.g. cell colocalisation, entropy), and then measures the
Prevalence and Distinctiveness of the pattern.</p>
<p>In this vignette we will use an inForm data file that’s already been
formatted for SPIAT with <code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code>, which we
can load with <code><a href="https://rdrr.io/r/utils/data.html" class="external-link">data()</a></code>. We will use
<code><a href="../reference/define_celltypes.html">define_celltypes()</a></code> to define the cells with certain
combinations of markers.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simulated_image"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define cell types</span></span>
<span><span class="va">formatted_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_celltypes.html">define_celltypes</a></span><span class="op">(</span></span>
<span>    <span class="va">simulated_image</span>, </span>
<span>    categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour_marker"</span>,<span class="st">"Immune_marker1,Immune_marker2"</span>, </span>
<span>                   <span class="st">"Immune_marker1,Immune_marker3"</span>, </span>
<span>                   <span class="st">"Immune_marker1,Immune_marker2,Immune_marker4"</span>, <span class="st">"OTHER"</span><span class="op">)</span>, </span>
<span>    category_colname <span class="op">=</span> <span class="st">"Phenotype"</span>, </span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Immune3"</span>, <span class="st">"Others"</span><span class="op">)</span>,</span>
<span>    new_colname <span class="op">=</span> <span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="localised-entropy">Localised Entropy<a class="anchor" aria-label="anchor" href="#localised-entropy"></a>
</h2>
<p>Entropy in spatial analysis refers to the balance in the number of
cells of distinct populations. An entropy score can be obtained for an
entire image. However, the entropy of one image does not provide us
spatial information of the image.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_entropy.html">calculate_entropy</a></span><span class="op">(</span><span class="va">formatted_image</span>, cell_types_of_interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>,<span class="st">"Immune2"</span><span class="op">)</span>, </span>
<span>                  feature_colname <span class="op">=</span> <span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9294873</span></span></code></pre>
<p>We therefore propose the concept of Localised Entropy which
calculates an entropy score for a predefined local region. These local
regions can be calculated as defined in the next two sections.</p>
<div class="section level3">
<h3 id="fishnet-grid">Fishnet grid<a class="anchor" aria-label="anchor" href="#fishnet-grid"></a>
</h3>
<p>One approach to calculate localised metric is to split the image into
fishnet grid squares. For each grid square, <code><a href="../reference/grid_metrics.html">grid_metrics()</a></code>
calculates the metric for that square and visualise the raster image.
Users can choose any metric as the localised metric. Here we use entropy
as an example.</p>
<p>For cases where the localised metric is not symmetrical (requires
specifying a target and reference cell type), the first item in the
vector used for <code>cell_types_of_interest</code> marks the reference
cells and the second item the target cells. Here we are using Entropy,
which is symmetrical, so we can use any order of cell types in the
input.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"defined_image"</span><span class="op">)</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grid_metrics.html">grid_metrics</a></span><span class="op">(</span><span class="va">defined_image</span>, FUN <span class="op">=</span> <span class="va">calculate_entropy</span>, n_split <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                     cell_types_of_interest<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>,<span class="st">"Immune3"</span><span class="op">)</span>, </span>
<span>                     feature_colname <span class="op">=</span> <span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-heterogeneity_files/figure-html/unnamed-chunk-4-1.png" width="70%"></p>
<p>After calculating the localised entropy for each of the grid squares,
we can apply metrics like percentages of grid squares with patterns
(Prevalence) and Moran’s I (Distinctiveness).</p>
<p>For the Prevalence, we need to select a threshold over which grid
squares are considered ‘positive’ for the pattern. The selection of
threshold depends on the pattern and metric the user chooses to find the
localised pattern. Here we chose 0.75 for entropy because 0.75 is
roughly the entropy of two cell types when their ratio is 1:5 or
5:1.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_percentage_of_grids.html">calculate_percentage_of_grids</a></span><span class="op">(</span><span class="va">grid</span>, threshold <span class="op">=</span> <span class="fl">0.75</span>, above <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 13</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_spatial_autocorrelation.html">calculate_spatial_autocorrelation</a></span><span class="op">(</span><span class="va">grid</span>, metric <span class="op">=</span> <span class="st">"globalmoran"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.09446964</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="gradients-based-on-concentric-circles">Gradients (based on concentric circles)<a class="anchor" aria-label="anchor" href="#gradients-based-on-concentric-circles"></a>
</h3>
<p>We can use the <code><a href="../reference/compute_gradient.html">compute_gradient()</a></code> function to calculate
metrics (entropy, mixing score, percentage of cells within radius,
marker intensity) for a range of radii from reference cells. Here, an
increasing circle is drawn around each cell of the reference cell type
and the desired score is calculated for cells within each circle.</p>
<p>The first item in the vector used for
<code>cell_types_of_interest</code> marks the reference cells and the
second item the target cells. Here, Immune1 cells are reference cells
and Immune2 are target cells.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gradient_positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">gradient_entropy</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/compute_gradient.html">compute_gradient</a></span><span class="op">(</span><span class="va">defined_image</span>, radii <span class="op">=</span> <span class="va">gradient_positions</span>, </span>
<span>                   FUN <span class="op">=</span> <span class="va">calculate_entropy</span>,  cell_types_of_interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>,<span class="st">"Immune2"</span><span class="op">)</span>,</span>
<span>                   feature_colname <span class="op">=</span> <span class="st">"Cell.Type"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gradient_entropy</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gradient_entropy</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         Cell.X.Position Cell.Y.Position Immune1 Immune2 total Immune1_log2</span></span>
<span><span class="co">## Cell_15       109.67027        17.12956       1       0     1            0</span></span>
<span><span class="co">## Cell_25       153.22795       128.29915       1       0     1            0</span></span>
<span><span class="co">## Cell_30        57.29037        49.88533       1       0     1            0</span></span>
<span><span class="co">## Cell_48        83.47798       295.75058       2       0     2            1</span></span>
<span><span class="co">## Cell_56        35.24227       242.84862       1       0     1            0</span></span>
<span><span class="co">## Cell_61       156.39943       349.08154       2       0     2            1</span></span>
<span><span class="co">##         Immune2_log2 total_log2 Immune1ratio Immune1_entropy Immune2ratio</span></span>
<span><span class="co">## Cell_15            0          0            1               0            0</span></span>
<span><span class="co">## Cell_25            0          0            1               0            0</span></span>
<span><span class="co">## Cell_30            0          0            1               0            0</span></span>
<span><span class="co">## Cell_48            0          1            1               0            0</span></span>
<span><span class="co">## Cell_56            0          0            1               0            0</span></span>
<span><span class="co">## Cell_61            0          1            1               0            0</span></span>
<span><span class="co">##         Immune2_entropy entropy</span></span>
<span><span class="co">## Cell_15               0       0</span></span>
<span><span class="co">## Cell_25               0       0</span></span>
<span><span class="co">## Cell_30               0       0</span></span>
<span><span class="co">## Cell_48               0       0</span></span>
<span><span class="co">## Cell_56               0       0</span></span>
<span><span class="co">## Cell_61               0       0</span></span></code></pre>
<p>The <code><a href="../reference/compute_gradient.html">compute_gradient()</a></code> function outputs the numbers
cells within each radii for each reference cell. The output is formatted
as a list of data.frames, one for each specified radii. In each
data.frame, the rows show the reference cells. The last column of the
data.frame is the entropy calculated for cells in the circle of the
reference cell. Users can then an average score or another aggregation
metric to report the results.</p>
<p>An alternative approach is to combine the results of all the circles
(rather than have one for each individual reference cell). Here, for
each radii, we simultaneously identify all the cells in the circles
surrounding each reference cell, and calculate a single entropy score.
We have created a specific function for this -
<code><a href="../reference/entropy_gradient_aggregated.html">entropy_gradient_aggregated()</a></code>. The output of this function
is an overall entropy score for each radii.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gradient_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">500</span>, <span class="fl">50</span><span class="op">)</span> <span class="co">##radii</span></span>
<span><span class="va">gradient_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/entropy_gradient_aggregated.html">entropy_gradient_aggregated</a></span><span class="op">(</span><span class="va">defined_image</span>, cell_types_of_interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune3"</span>,<span class="st">"Tumour"</span><span class="op">)</span>,</span>
<span>                                                feature_colname <span class="op">=</span> <span class="st">"Cell.Type"</span>, radii <span class="op">=</span> <span class="va">gradient_pos</span><span class="op">)</span></span>
<span><span class="co"># plot the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="va">gradient_results</span><span class="op">$</span><span class="va">gradient_df</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-heterogeneity_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="you-can-access-the-vignettes-for-other-modules-of-spiat-here">You can access the vignettes for other modules of SPIAT here:<a class="anchor" aria-label="anchor" href="#you-can-access-the-vignettes-for-other-modules-of-spiat-here"></a>
</h2>
<ul>
<li><a href="SPIAT.html">Overview of SPIAT</a></li>
<li><a href="data_reading-formatting.html">Data reading and
formatting</a></li>
<li><a href="quality-control_visualisation.html">Quality control and
visualisation</a></li>
<li><a href="basic_analysis.html">Basic analysis</a></li>
<li><a href="cell-colocalisation.html">Cell colocalisation</a></li>
<li><a href="tissue-structure.html">Tissue structure</a></li>
<li><a href="neighborhood.html">Cellular neighborhood</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.0 (2023-04-21)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] SPIAT_1.1.6                 SpatialExperiment_1.9.5    </span></span>
<span><span class="co">##  [3] SingleCellExperiment_1.21.1 SummarizedExperiment_1.29.1</span></span>
<span><span class="co">##  [5] Biobase_2.59.0              GenomicRanges_1.51.4       </span></span>
<span><span class="co">##  [7] GenomeInfoDb_1.35.17        IRanges_2.33.1             </span></span>
<span><span class="co">##  [9] S4Vectors_0.37.7            BiocGenerics_0.45.3        </span></span>
<span><span class="co">## [11] MatrixGenerics_1.11.1       matrixStats_0.63.0         </span></span>
<span><span class="co">## [13] BiocStyle_2.27.2           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] bitops_1.0-7              deldir_1.0-6             </span></span>
<span><span class="co">##  [3] gridExtra_2.3             rlang_1.1.0              </span></span>
<span><span class="co">##  [5] magrittr_2.0.3            compiler_4.3.0           </span></span>
<span><span class="co">##  [7] spatstat.geom_3.1-0       DelayedMatrixStats_1.21.0</span></span>
<span><span class="co">##  [9] systemfonts_1.0.4         vctrs_0.6.2              </span></span>
<span><span class="co">## [11] stringr_1.5.0             pkgconfig_2.0.3          </span></span>
<span><span class="co">## [13] fastmap_1.1.1             magick_2.7.4             </span></span>
<span><span class="co">## [15] XVector_0.39.0            scuttle_1.9.4            </span></span>
<span><span class="co">## [17] utf8_1.2.3                rmarkdown_2.21           </span></span>
<span><span class="co">## [19] ragg_1.2.5                purrr_1.0.1              </span></span>
<span><span class="co">## [21] xfun_0.39                 zlibbioc_1.45.0          </span></span>
<span><span class="co">## [23] cachem_1.0.7              beachmat_2.15.2          </span></span>
<span><span class="co">## [25] jsonlite_1.8.4            goftest_1.2-3            </span></span>
<span><span class="co">## [27] highr_0.10                rhdf5filters_1.11.3      </span></span>
<span><span class="co">## [29] DelayedArray_0.25.0       spatstat.utils_3.0-2     </span></span>
<span><span class="co">## [31] Rhdf5lib_1.21.1           BiocParallel_1.33.12     </span></span>
<span><span class="co">## [33] terra_1.7-28              parallel_4.3.0           </span></span>
<span><span class="co">## [35] R6_2.5.1                  bslib_0.4.2              </span></span>
<span><span class="co">## [37] stringi_1.7.12            spatstat.data_3.0-1      </span></span>
<span><span class="co">## [39] limma_3.55.8              jquerylib_0.1.4          </span></span>
<span><span class="co">## [41] Rcpp_1.0.10               bookdown_0.33            </span></span>
<span><span class="co">## [43] knitr_1.42                tensor_1.5               </span></span>
<span><span class="co">## [45] R.utils_2.12.2            Matrix_1.5-4             </span></span>
<span><span class="co">## [47] tidyselect_1.2.0          abind_1.4-5              </span></span>
<span><span class="co">## [49] yaml_2.3.7                codetools_0.2-19         </span></span>
<span><span class="co">## [51] spatstat.random_3.1-4     spatstat.explore_3.1-0   </span></span>
<span><span class="co">## [53] lattice_0.21-8            tibble_3.2.1             </span></span>
<span><span class="co">## [55] evaluate_0.20             desc_1.4.2               </span></span>
<span><span class="co">## [57] polyclip_1.10-4           elsa_1.1-28              </span></span>
<span><span class="co">## [59] pillar_1.9.0              BiocManager_1.30.20      </span></span>
<span><span class="co">## [61] dbscan_1.1-11             generics_0.1.3           </span></span>
<span><span class="co">## [63] sp_1.6-0                  rprojroot_2.0.3          </span></span>
<span><span class="co">## [65] RCurl_1.98-1.12           ggplot2_3.4.2            </span></span>
<span><span class="co">## [67] sparseMatrixStats_1.11.1  munsell_0.5.0            </span></span>
<span><span class="co">## [69] scales_1.2.1              glue_1.6.2               </span></span>
<span><span class="co">## [71] tools_4.3.0               locfit_1.5-9.7           </span></span>
<span><span class="co">## [73] fs_1.6.1                  rhdf5_2.43.5             </span></span>
<span><span class="co">## [75] grid_4.3.0                DropletUtils_1.19.3      </span></span>
<span><span class="co">## [77] edgeR_3.41.8              colorspace_2.1-0         </span></span>
<span><span class="co">## [79] nlme_3.1-162              GenomeInfoDbData_1.2.10  </span></span>
<span><span class="co">## [81] raster_3.6-20             HDF5Array_1.27.0         </span></span>
<span><span class="co">## [83] cli_3.6.1                 spatstat.sparse_3.0-1    </span></span>
<span><span class="co">## [85] textshaping_0.3.6         fansi_1.0.4              </span></span>
<span><span class="co">## [87] dplyr_1.1.2               gtable_0.3.3             </span></span>
<span><span class="co">## [89] R.methodsS3_1.8.2         sass_0.4.5               </span></span>
<span><span class="co">## [91] digest_0.6.31             dqrng_0.3.0              </span></span>
<span><span class="co">## [93] rjson_0.2.21              memoise_2.0.1            </span></span>
<span><span class="co">## [95] htmltools_0.5.5           pkgdown_2.0.7            </span></span>
<span><span class="co">## [97] R.oo_1.25.0               lifecycle_1.0.3</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="author-contributions">Author Contributions<a class="anchor" aria-label="anchor" href="#author-contributions"></a>
</h2>
<p>AT, YF, TY, ML, JZ, VO, MD are authors of the package code. MD and YF
wrote the vignette. AT, YF and TY designed the package.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anna Trigos, Yuzhou Feng, Tianpei Yang, Mabel Li, John Zhu, Volkan Ozcoban, Maria Doyle.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
