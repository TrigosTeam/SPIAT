<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quantifying cell colocalisation with SPIAT • SPIAT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quantifying cell colocalisation with SPIAT">
<meta property="og:description" content="SPIAT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPIAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SPIAT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic_analysis.html">Basic analyses with SPIAT</a>
    </li>
    <li>
      <a href="../articles/cell-colocalisation.html">Quantifying cell colocalisation with SPIAT</a>
    </li>
    <li>
      <a href="../articles/data_reading-formatting.html">Reading in data and data formatting in SPIAT</a>
    </li>
    <li>
      <a href="../articles/neighborhood.html">Identifying cellular neighborhood with SPIAT</a>
    </li>
    <li>
      <a href="../articles/quality-control_visualisation.html">Quality control and visualisation with SPIAT</a>
    </li>
    <li>
      <a href="../articles/spatial-heterogeneity.html">Spatial heterogeneity with SPIAT</a>
    </li>
    <li>
      <a href="../articles/tissue-structure.html">Characterising tissue structure with SPIAT</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/trigosteam/SPIAT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quantifying cell colocalisation with SPIAT</h1>
                        <h4 data-toc-skip class="author">Yuzhou
Feng</h4>
            
            <h4 data-toc-skip class="date">2023-05-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/trigosteam/SPIAT/blob/HEAD/vignettes/cell-colocalisation.Rmd" class="external-link"><code>vignettes/cell-colocalisation.Rmd</code></a></small>
      <div class="hidden name"><code>cell-colocalisation.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://trigosteam.github.io/SPIAT/" class="external-link">SPIAT</a></span><span class="op">)</span></span></code></pre></div>
<p>With SPIAT we can quantify cell colocalisation, which refers to how
much two cell types are colocalising and thus potentially
interacting.</p>
<p>In this vignette we will use an inForm data file that’s already been
formatted for SPIAT with <code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code>, which we
can load with <code><a href="https://rdrr.io/r/utils/data.html" class="external-link">data()</a></code>. We will use
<code><a href="../reference/define_celltypes.html">define_celltypes()</a></code> to define the cells with certain
combinations of markers.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simulated_image"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define cell types</span></span>
<span><span class="va">formatted_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_celltypes.html">define_celltypes</a></span><span class="op">(</span></span>
<span>    <span class="va">simulated_image</span>, </span>
<span>    categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour_marker"</span>,<span class="st">"Immune_marker1,Immune_marker2"</span>, </span>
<span>                   <span class="st">"Immune_marker1,Immune_marker3"</span>, </span>
<span>                   <span class="st">"Immune_marker1,Immune_marker2,Immune_marker4"</span>, <span class="st">"OTHER"</span><span class="op">)</span>, </span>
<span>    category_colname <span class="op">=</span> <span class="st">"Phenotype"</span>, </span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Immune3"</span>, <span class="st">"Others"</span><span class="op">)</span>,</span>
<span>    new_colname <span class="op">=</span> <span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="cells-in-neighbourhood-cin">Cells In Neighbourhood (CIN)<a class="anchor" aria-label="anchor" href="#cells-in-neighbourhood-cin"></a>
</h2>
<p>We can calculate the average percentage of cells of one cell type
(target) within a radius of another cell type (reference) using
<code><a href="../reference/average_percentage_of_cells_within_radius.html">average_percentage_of_cells_within_radius()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/average_percentage_of_cells_within_radius.html">average_percentage_of_cells_within_radius</a></span><span class="op">(</span>spe_object <span class="op">=</span> <span class="va">formatted_image</span>, </span>
<span>                                          reference_celltype <span class="op">=</span> <span class="st">"Immune1"</span>, </span>
<span>                                          target_celltype <span class="op">=</span> <span class="st">"Immune2"</span>, </span>
<span>                                          radius<span class="op">=</span><span class="fl">100</span>, feature_colname<span class="op">=</span><span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4.768123</span></span></code></pre>
<p>Alternatively, this analysis can also be performed based on marker
intensities rather than cell types. Here, we use
<code><a href="../reference/average_marker_intensity_within_radius.html">average_marker_intensity_within_radius()</a></code> to calculate the
average intensity of the target_marker within a radius from the cells
positive for the reference marker. Note that it pools all cells with the
target marker that are within the specific radius of any reference cell.
Results represent the average intensities within a radius.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/average_marker_intensity_within_radius.html">average_marker_intensity_within_radius</a></span><span class="op">(</span>spe_object <span class="op">=</span> <span class="va">formatted_image</span>,</span>
<span>                                       reference_marker <span class="op">=</span><span class="st">"Immune_marker3"</span>,</span>
<span>                                       target_marker <span class="op">=</span> <span class="st">"Immune_marker2"</span>,</span>
<span>                                       radius<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.5995357</span></span></code></pre>
<p>To help identify suitable radii for
<code><a href="../reference/average_percentage_of_cells_within_radius.html">average_percentage_of_cells_within_radius()</a></code> and
<code><a href="../reference/average_marker_intensity_within_radius.html">average_marker_intensity_within_radius()</a></code> users can use
<code><a href="../reference/plot_average_intensity.html">plot_average_intensity()</a></code>. This function calculates the
average intensity of a target marker for a number of user-supplied radii
values, and plots the intensity level at each specified radius as a line
graph. The radius unit is pixels.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_average_intensity.html">plot_average_intensity</a></span><span class="op">(</span>spe_object<span class="op">=</span><span class="va">formatted_image</span>, reference_marker<span class="op">=</span><span class="st">"Immune_marker3"</span>, </span>
<span>                       target_marker<span class="op">=</span><span class="st">"Immune_marker2"</span>, radii<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">35</span>, <span class="fl">40</span>, <span class="fl">45</span>, <span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="cell-colocalisation_files/figure-html/unnamed-chunk-5-1.png" width="384"></p>
<p>This plot shows low levels of Immune_marker3 were observed in cells
near Immune_marker2+ cells and these levels increased at larger radii.
This suggests Immune_marker2+ and Immune_marker3+ cells may not be
closely interacting and are actually repelled.</p>
</div>
<div class="section level2">
<h2 id="mixing-score-ms-and-normalised-mixing-score-nms">Mixing Score (MS) and Normalised Mixing Score (NMS)<a class="anchor" aria-label="anchor" href="#mixing-score-ms-and-normalised-mixing-score-nms"></a>
</h2>
<p>This score was originally defined as the number of immune-tumour
interactions divided by the number of immune-immune interactions <span class="citation">(Keren et al. 2018)</span>. SPIAT generalises this
method for any user-defined pair of cell types.
<code><a href="../reference/mixing_score_summary.html">mixing_score_summary()</a></code> returns the mixing score between a
reference cell type and a target cell type. This mixing score is defined
as the number of target-reference interactions/number of
reference-reference interactions within a specified radius. The higher
the score the greater the mixing of the two cell types. The normalised
score is normalised for the number of target and reference cells in the
image.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mixing_score_summary.html">mixing_score_summary</a></span><span class="op">(</span>spe_object <span class="op">=</span> <span class="va">formatted_image</span>, reference_celltype <span class="op">=</span> <span class="st">"Immune1"</span>, </span>
<span>                     target_celltype <span class="op">=</span> <span class="st">"Immune2"</span>, radius<span class="op">=</span><span class="fl">100</span>, feature_colname <span class="op">=</span><span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Reference  Target Number_of_reference_cells Number_of_target_cells</span></span>
<span><span class="co">## 2   Immune1 Immune2                       338                    178</span></span>
<span><span class="co">##   Reference_target_interaction Reference_reference_interaction Mixing_score</span></span>
<span><span class="co">## 2                          583                             592    0.9847973</span></span>
<span><span class="co">##   Normalised_mixing_score</span></span>
<span><span class="co">## 2               0.9322379</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="cross-k-function">Cross K function<a class="anchor" aria-label="anchor" href="#cross-k-function"></a>
</h2>
<p>Cross K function calculates the number of target cell types across a
range of radii from a reference cell type, and compares the behaviour of
the input image with an image of randomly distributed points using a
Poisson point process. There are four patterns that can be distinguished
from K-cross function, as illustrated in the plots below. (taken from <a href="https://blog.jlevente.com/understanding-the-cross-k-function/" class="external-link">here</a>
in April 2021).</p>
<p><img src="cross-k-function.jpg" width="100%"></p>
<p>Here, the black line represents the input image, the red line
represents a randomly distributed point pattern.</p>
<ul>
<li>1st plot: The red line and black line are close to each other,
meaning the two types of points are randomly independently
distributed.<br>
</li>
<li>2nd plot: The red line is under the black line, with a large
difference in the middle of the plot, meaning the points are mixed and
split into clusters.<br>
</li>
<li>3rd plot: With the increase of radius, the black line diverges
further from the red line, meaning that there is one mixed cluster of
two types of points.<br>
</li>
<li>4th plot: The red line is above the black line, meaning that the two
types of points form separated clusters.</li>
</ul>
<p>We can calculate the cross K-function using SPIAT. Here, we need to
define which are the cell types of interest. In this example, we are
using Tumour cells as the reference population, and Immune3 cells as the
target population.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_cross</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_cross_functions.html">calculate_cross_functions</a></span><span class="op">(</span><span class="va">formatted_image</span>, method <span class="op">=</span> <span class="st">"Kcross"</span>, </span>
<span>                                      cell_types_of_interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>,<span class="st">"Immune2"</span><span class="op">)</span>, </span>
<span>                                      feature_colname <span class="op">=</span><span class="st">"Cell.Type"</span>,</span>
<span>                                      dist <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="cell-colocalisation_files/figure-html/unnamed-chunk-8-1.png" width="403.2"></p>
<p>The results shows similar pattern as the 4th plot in the cross K
diagram. This means “Tumour” cells and “Immune2” cells are not
colocalised (or form separate clusters).</p>
<p>We can calculate the area under the curve (AUC) of the cross
K-function. In general, this tells us the two types of cells are:</p>
<ul>
<li>negative values: separate clusters</li>
<li>positive values: mixing of cell types</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/AUC_of_cross_function.html">AUC_of_cross_function</a></span><span class="op">(</span><span class="va">df_cross</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.2836735</span></span></code></pre>
<p>The AUC score is close to zero so this tells us that the two types of
cells either do not have a relationship or they form a ring surrounding
a cluster.</p>
</div>
<div class="section level2">
<h2 id="cross-k-intersection-cki">Cross-K Intersection (CKI)<a class="anchor" aria-label="anchor" href="#cross-k-intersection-cki"></a>
</h2>
<p>There is another pattern in cross K curve which has not been
previously appreciated, which is when there is a “ring” of one cell
type, generally immune cells, surrounding the area of another cell type,
generally tumour cells. For this pattern, the observed and expected
curves in cross K function cross or intersect, such as the cross K plot
above.</p>
<p>We note that crossing is not exclusively present in cases where there
is an immune ring. When separate clusters of two cell types are close,
there can be a crossing at a small radius. In images with infiltration,
crossing may also happen at an extremely low distances due to
randomness. To use the CKI to detect a ring pattern, users need to
determine a threshold for when there is a true immune ring. Based on our
tests, these generally fall within at a quarter to half of the image
size, but users are encouraged to experiment with their datasets.</p>
<p>Here we use the colocalisation of “Tumour” and “Immune3” cells as an
example. Let’s revisit the example image.</p>
<p><img src="cell-colocalisation_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Compute the cross K function between “Tumour” and “Immune3”:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_cross</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_cross_functions.html">calculate_cross_functions</a></span><span class="op">(</span><span class="va">formatted_image</span>, method <span class="op">=</span> <span class="st">"Kcross"</span>, </span>
<span>                                      cell_types_of_interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>,<span class="st">"Immune3"</span><span class="op">)</span>, </span>
<span>                                      feature_colname <span class="op">=</span><span class="st">"Cell.Type"</span>,</span>
<span>                                      dist <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="cell-colocalisation_files/figure-html/unnamed-chunk-11-1.png" width="384"></p>
<p>Then find the intersection of the observed and expected cross K
curves.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/crossing_of_crossK.html">crossing_of_crossK</a></span><span class="op">(</span><span class="va">df_cross</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Crossing of cross K function is detected for this image, indicating a potential immune ring."</span></span>
<span><span class="co">## [1] "The crossing happens at the 50% of the specified distance."</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0.5</span></span></code></pre>
<p>The result shows that the crossing happens at 50% of the specified
distance (100) of the cross K function, which is very close to the edge
of the tumour cluster. This means that the crossing is not due to the
randomness in cell distribution, nor due to two close located immune and
tumour clusters. This result aligns with the observation that there is
an immune ring surrounding the tumour cluster.</p>
</div>
<div class="section level2">
<h2 id="you-can-access-the-vignettes-for-other-modules-of-spiat-here">You can access the vignettes for other modules of SPIAT here:<a class="anchor" aria-label="anchor" href="#you-can-access-the-vignettes-for-other-modules-of-spiat-here"></a>
</h2>
<ul>
<li><a href="SPIAT.html">Overview of SPIAT</a></li>
<li><a href="data_reading-formatting.html">Data reading and
formatting</a></li>
<li><a href="quality-control_visualisation.html">Quality control and
visualisation</a></li>
<li><a href="basic_analysis.html">Basic analysis</a></li>
<li><a href="spatial-heterogeneity.html">Spatial heterogeneity</a></li>
<li><a href="tissue-structure.html">Tissue structure</a></li>
<li><a href="neighborhood.html">Cellular neighborhood</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.0 (2023-04-21)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] SPIAT_1.2.2                 SpatialExperiment_1.10.0   </span></span>
<span><span class="co">##  [3] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.1</span></span>
<span><span class="co">##  [5] Biobase_2.60.0              GenomicRanges_1.52.0       </span></span>
<span><span class="co">##  [7] GenomeInfoDb_1.36.0         IRanges_2.34.0             </span></span>
<span><span class="co">##  [9] S4Vectors_0.38.1            BiocGenerics_0.46.0        </span></span>
<span><span class="co">## [11] MatrixGenerics_1.12.0       matrixStats_0.63.0         </span></span>
<span><span class="co">## [13] BiocStyle_2.28.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] bitops_1.0-7              deldir_1.0-9             </span></span>
<span><span class="co">##   [3] gridExtra_2.3             rlang_1.1.1              </span></span>
<span><span class="co">##   [5] magrittr_2.0.3            compiler_4.3.0           </span></span>
<span><span class="co">##   [7] spatstat.geom_3.2-1       DelayedMatrixStats_1.22.0</span></span>
<span><span class="co">##   [9] systemfonts_1.0.4         vctrs_0.6.2              </span></span>
<span><span class="co">##  [11] stringr_1.5.0             pkgconfig_2.0.3          </span></span>
<span><span class="co">##  [13] crayon_1.5.2              fastmap_1.1.1            </span></span>
<span><span class="co">##  [15] magick_2.7.4              XVector_0.40.0           </span></span>
<span><span class="co">##  [17] labeling_0.4.2            scuttle_1.10.1           </span></span>
<span><span class="co">##  [19] utf8_1.2.3                rmarkdown_2.21           </span></span>
<span><span class="co">##  [21] pracma_2.4.2              ragg_1.2.5               </span></span>
<span><span class="co">##  [23] purrr_1.0.1               xfun_0.39                </span></span>
<span><span class="co">##  [25] zlibbioc_1.46.0           cachem_1.0.8             </span></span>
<span><span class="co">##  [27] beachmat_2.16.0           jsonlite_1.8.4           </span></span>
<span><span class="co">##  [29] goftest_1.2-3             highr_0.10               </span></span>
<span><span class="co">##  [31] rhdf5filters_1.12.1       DelayedArray_0.26.3      </span></span>
<span><span class="co">##  [33] spatstat.utils_3.0-3      Rhdf5lib_1.22.0          </span></span>
<span><span class="co">##  [35] BiocParallel_1.34.2       parallel_4.3.0           </span></span>
<span><span class="co">##  [37] R6_2.5.1                  bslib_0.4.2              </span></span>
<span><span class="co">##  [39] stringi_1.7.12            spatstat.data_3.0-1      </span></span>
<span><span class="co">##  [41] limma_3.56.1              jquerylib_0.1.4          </span></span>
<span><span class="co">##  [43] Rcpp_1.0.10               bookdown_0.34            </span></span>
<span><span class="co">##  [45] knitr_1.42                tensor_1.5               </span></span>
<span><span class="co">##  [47] R.utils_2.12.2            Matrix_1.5-4             </span></span>
<span><span class="co">##  [49] tidyselect_1.2.0          abind_1.4-5              </span></span>
<span><span class="co">##  [51] yaml_2.3.7                codetools_0.2-19         </span></span>
<span><span class="co">##  [53] spatstat.random_3.1-5     spatstat.explore_3.2-1   </span></span>
<span><span class="co">##  [55] lattice_0.21-8            tibble_3.2.1             </span></span>
<span><span class="co">##  [57] withr_2.5.0               evaluate_0.21            </span></span>
<span><span class="co">##  [59] desc_1.4.2                polyclip_1.10-4          </span></span>
<span><span class="co">##  [61] pillar_1.9.0              BiocManager_1.30.20      </span></span>
<span><span class="co">##  [63] dbscan_1.1-11             generics_0.1.3           </span></span>
<span><span class="co">##  [65] rprojroot_2.0.3           RCurl_1.98-1.12          </span></span>
<span><span class="co">##  [67] ggplot2_3.4.2             sparseMatrixStats_1.12.0 </span></span>
<span><span class="co">##  [69] munsell_0.5.0             scales_1.2.1             </span></span>
<span><span class="co">##  [71] glue_1.6.2                tools_4.3.0              </span></span>
<span><span class="co">##  [73] locfit_1.5-9.7            fs_1.6.2                 </span></span>
<span><span class="co">##  [75] rhdf5_2.44.0              grid_4.3.0               </span></span>
<span><span class="co">##  [77] DropletUtils_1.20.0       edgeR_3.42.2             </span></span>
<span><span class="co">##  [79] colorspace_2.1-0          nlme_3.1-162             </span></span>
<span><span class="co">##  [81] GenomeInfoDbData_1.2.10   HDF5Array_1.28.1         </span></span>
<span><span class="co">##  [83] cli_3.6.1                 spatstat.sparse_3.0-1    </span></span>
<span><span class="co">##  [85] textshaping_0.3.6         fansi_1.0.4              </span></span>
<span><span class="co">##  [87] S4Arrays_1.0.4            dplyr_1.1.2              </span></span>
<span><span class="co">##  [89] gtable_0.3.3              R.methodsS3_1.8.2        </span></span>
<span><span class="co">##  [91] sass_0.4.6                digest_0.6.31            </span></span>
<span><span class="co">##  [93] dqrng_0.3.0               farver_2.1.1             </span></span>
<span><span class="co">##  [95] rjson_0.2.21              memoise_2.0.1            </span></span>
<span><span class="co">##  [97] htmltools_0.5.5           pkgdown_2.0.7            </span></span>
<span><span class="co">##  [99] R.oo_1.25.0               lifecycle_1.0.3</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="author-contributions">Author Contributions<a class="anchor" aria-label="anchor" href="#author-contributions"></a>
</h2>
<p>AT, YF, TY, ML, JZ, VO, MD are authors of the package code. MD and YF
wrote the vignette. AT, YF and TY designed the package.</p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-keren2018structured" class="csl-entry">
Keren, Leeat, Marc Bosse, Diana Marquez, Roshan Angoshtari, Samir Jain,
Sushama Varma, Soo-Ryum Yang, et al. 2018. <span>“A Structured
Tumor-Immune Microenvironment in Triple Negative Breast Cancer Revealed
by Multiplexed Ion Beam Imaging.”</span> <em>Cell</em> 174 (6): 1373–87.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anna Trigos, Yuzhou Feng, Tianpei Yang, Mabel Li, John Zhu, Volkan Ozcoban, Maria Doyle.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
