<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic analyses with SPIAT • SPIAT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic analyses with SPIAT">
<meta property="og:description" content="SPIAT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPIAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SPIAT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic_analysis.html">Basic analyses with SPIAT</a>
    </li>
    <li>
      <a href="../articles/cell-colocalisation.html">Quantifying cell colocalisation with SPIAT</a>
    </li>
    <li>
      <a href="../articles/data_reading-formatting.html">Reading in data and data formatting in SPIAT</a>
    </li>
    <li>
      <a href="../articles/neighborhood.html">Identifying cellular neighborhood with SPIAT</a>
    </li>
    <li>
      <a href="../articles/quality-control_visualisation.html">Quality control and visualisation with SPIAT</a>
    </li>
    <li>
      <a href="../articles/spatial-heterogeneity.html">Spatial heterogeneity with SPIAT</a>
    </li>
    <li>
      <a href="../articles/tissue-structure.html">Characterising tissue structure with SPIAT</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/trigosteam/SPIAT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic analyses with SPIAT</h1>
                        <h4 data-toc-skip class="author">Yuzhou
Feng</h4>
            
            <h4 data-toc-skip class="date">2023-05-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/trigosteam/SPIAT/blob/HEAD/vignettes/basic_analysis.Rmd" class="external-link"><code>vignettes/basic_analysis.Rmd</code></a></small>
      <div class="hidden name"><code>basic_analysis.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://trigosteam.github.io/SPIAT/" class="external-link">SPIAT</a></span><span class="op">)</span></span></code></pre></div>
<p>In this vignette we will use an inForm data file that’s already been
formatted for SPIAT with <code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code>, which we
can load with <code><a href="https://rdrr.io/r/utils/data.html" class="external-link">data()</a></code>. We will use
<code><a href="../reference/define_celltypes.html">define_celltypes()</a></code> to define the cells with certain
combinations of markers.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simulated_image"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define cell types</span></span>
<span><span class="va">formatted_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_celltypes.html">define_celltypes</a></span><span class="op">(</span></span>
<span>    <span class="va">simulated_image</span>, </span>
<span>    categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour_marker"</span>,<span class="st">"Immune_marker1,Immune_marker2"</span>, </span>
<span>                   <span class="st">"Immune_marker1,Immune_marker3"</span>, </span>
<span>                   <span class="st">"Immune_marker1,Immune_marker2,Immune_marker4"</span>, <span class="st">"OTHER"</span><span class="op">)</span>, </span>
<span>    category_colname <span class="op">=</span> <span class="st">"Phenotype"</span>, </span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Immune3"</span>, <span class="st">"Others"</span><span class="op">)</span>,</span>
<span>    new_colname <span class="op">=</span> <span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
<p>We will be performing some basic analyses on this image. Here is the
visualisation of the cell coordinates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkcyan"</span>, <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="../reference/plot_cell_categories.html">plot_cell_categories</a></span><span class="op">(</span>spe_object <span class="op">=</span> <span class="va">formatted_image</span>, </span>
<span>                     categories_of_interest <span class="op">=</span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Immune3"</span><span class="op">)</span>, </span>
<span>                     colour_vector <span class="op">=</span> <span class="va">my_colors</span>, </span>
<span>                     feature_colname <span class="op">=</span> <span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
<p><img src="basic_analysis_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="section level2">
<h2 id="cell-percentages">Cell percentages<a class="anchor" aria-label="anchor" href="#cell-percentages"></a>
</h2>
<p>We can obtain the number and proportion of each cell type with
<code><a href="../reference/calculate_cell_proportions.html">calculate_cell_proportions()</a></code>. We can use
<code>reference_celltypes</code> to specify cell types to use as the
reference. For example, “Total” will calculate the proportion of each
cell type against all cells. We can exclude any cell types that are not
of interest e.g. “Undefined” with <code>celltypes_to_exclude</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_cell_proportions.html">calculate_cell_proportions</a></span><span class="op">(</span><span class="va">formatted_image</span>, </span>
<span>                                      reference_celltypes <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                                      feature_colname <span class="op">=</span><span class="st">"Cell.Type"</span>,</span>
<span>                                      celltypes_to_exclude <span class="op">=</span> <span class="st">"Others"</span>,</span>
<span>                                      plot.image <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="basic_analysis_files/figure-html/unnamed-chunk-4-1.png" width="288"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_cells</span></span></code></pre></div>
<pre><code><span><span class="co">##   Cell_type Number_of_celltype Proportion Percentage Proportion_name</span></span>
<span><span class="co">## 5    Tumour                819 0.41679389  41.679389          /Total</span></span>
<span><span class="co">## 3   Immune3                630 0.32061069  32.061069          /Total</span></span>
<span><span class="co">## 1   Immune1                338 0.17201018  17.201018          /Total</span></span>
<span><span class="co">## 2   Immune2                178 0.09058524   9.058524          /Total</span></span></code></pre>
<p>Alternatively, we can also visualise cell type proportions as
barplots using <code><a href="../reference/plot_cell_percentages.html">plot_cell_percentages()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_cell_percentages.html">plot_cell_percentages</a></span><span class="op">(</span>cell_proportions <span class="op">=</span> <span class="va">p_cells</span>, </span>
<span>                      cells_to_exclude <span class="op">=</span> <span class="st">"Tumour"</span>, cellprop_colname<span class="op">=</span><span class="st">"Proportion_name"</span><span class="op">)</span></span></code></pre></div>
<p><img src="basic_analysis_files/figure-html/unnamed-chunk-5-1.png" width="364.8"><img src="basic_analysis_files/figure-html/unnamed-chunk-5-2.png" width="364.8"><img src="basic_analysis_files/figure-html/unnamed-chunk-5-3.png" width="364.8"></p>
</div>
<div class="section level2">
<h2 id="cell-distances">Cell distances<a class="anchor" aria-label="anchor" href="#cell-distances"></a>
</h2>
<div class="section level3">
<h3 id="pairwise-cell-distances">Pairwise cell distances<a class="anchor" aria-label="anchor" href="#pairwise-cell-distances"></a>
</h3>
<p>We can calculate the pairwise distances between two cell types (cell
type A and cell type B) with
<code>calculate_pairwise_distances_between_cell_types()</code>. This
function calculates the distances of all cells of type A against all
cells of type B.</p>
<p>This function returns a data frame that contains all the pairwise
distances between each cell of cell type A and cell type B.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_pairwise_distances_between_celltypes.html">calculate_pairwise_distances_between_celltypes</a></span><span class="op">(</span></span>
<span>  spe_object <span class="op">=</span> <span class="va">formatted_image</span>, </span>
<span>  cell_types_of_interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune3"</span><span class="op">)</span>,</span>
<span>  feature_colname <span class="op">=</span> <span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
<p>The pairwise distances can be visualised as a violin plot with
<code><a href="../reference/plot_cell_distances_violin.html">plot_cell_distances_violin()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_cell_distances_violin.html">plot_cell_distances_violin</a></span><span class="op">(</span><span class="va">distances</span><span class="op">)</span></span></code></pre></div>
<p><img src="basic_analysis_files/figure-html/unnamed-chunk-7-1.png" width="75%"></p>
<p>We can also calculate summary statistics for the distances between
each combination of cell types, the mean, median, min, max and standard
deviation, with
<code><a href="../reference/calculate_summary_distances_between_celltypes.html">calculate_summary_distances_between_celltypes()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_distances</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_summary_distances_between_celltypes.html">calculate_summary_distances_between_celltypes</a></span><span class="op">(</span><span class="va">distances</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_distances</span></span></code></pre></div>
<pre><code><span><span class="co">##              Pair      Mean      Min      Max    Median  Std.Dev Reference</span></span>
<span><span class="co">## 1 Immune1/Immune1 1164.7096 10.84056 2729.120 1191.3645 552.0154   Immune1</span></span>
<span><span class="co">## 2 Immune1/Immune3 1034.4960 10.23688 2691.514 1026.4414 442.2515   Immune1</span></span>
<span><span class="co">## 3  Immune1/Tumour 1013.3697 13.59204 2708.343 1004.6579 413.7815   Immune1</span></span>
<span><span class="co">## 4 Immune3/Immune1 1034.4960 10.23688 2691.514 1026.4414 442.2515   Immune3</span></span>
<span><span class="co">## 5 Immune3/Immune3  794.7765 10.17353 2645.302  769.9948 397.8863   Immune3</span></span>
<span><span class="co">## 6  Immune3/Tumour  758.2732 10.02387 2670.861  733.4501 380.7703   Immune3</span></span>
<span><span class="co">## 7  Tumour/Immune1 1013.3697 13.59204 2708.343 1004.6579 413.7815    Tumour</span></span>
<span><span class="co">## 8  Tumour/Immune3  758.2732 10.02387 2670.861  733.4501 380.7703    Tumour</span></span>
<span><span class="co">## 9   Tumour/Tumour  711.2657 10.00348 2556.332  703.9096 380.3293    Tumour</span></span>
<span><span class="co">##    Target</span></span>
<span><span class="co">## 1 Immune1</span></span>
<span><span class="co">## 2 Immune3</span></span>
<span><span class="co">## 3  Tumour</span></span>
<span><span class="co">## 4 Immune1</span></span>
<span><span class="co">## 5 Immune3</span></span>
<span><span class="co">## 6  Tumour</span></span>
<span><span class="co">## 7 Immune1</span></span>
<span><span class="co">## 8 Immune3</span></span>
<span><span class="co">## 9  Tumour</span></span></code></pre>
<p>An example of the interpretation of this result is: “average pairwise
distance between cells of Immune3 and Immune1 is 1034.496”.</p>
<p>These pairwise cell distances can then be visualised as a heatmap
with <code><a href="../reference/plot_distance_heatmap.html">plot_distance_heatmap()</a></code>. This example shows the
average pairwise distances between cell types. Note that the pairwise
distances are symmetrical (the average distance between cell type A and
cell type B is the same as the average distance between cell Type B and
cell Type A).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_distance_heatmap.html">plot_distance_heatmap</a></span><span class="op">(</span>phenotype_distances_result <span class="op">=</span> <span class="va">summary_distances</span>, metric <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<p><img src="basic_analysis_files/figure-html/unnamed-chunk-9-1.png" width="75%"></p>
<p>This plot shows that Tumour cells are interacting most closely with
Tumour cells and Immune3 cells.</p>
</div>
<div class="section level3">
<h3 id="minimum-cell-distances">Minimum cell distances<a class="anchor" aria-label="anchor" href="#minimum-cell-distances"></a>
</h3>
<p>We can also calculate the minimum distances between cell types with
<code><a href="../reference/calculate_minimum_distances_between_celltypes.html">calculate_minimum_distances_between_celltypes()</a></code>. Unlike the
pairwise distance where we calculate the distances between all cell
types of interest, here we only identify the distance to the closest
cell of type B to each of the reference cells of type A.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">min_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_minimum_distances_between_celltypes.html">calculate_minimum_distances_between_celltypes</a></span><span class="op">(</span></span>
<span>  spe_object <span class="op">=</span> <span class="va">formatted_image</span>, </span>
<span>  cell_types_of_interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>,<span class="st">"Immune3"</span>, <span class="st">"Others"</span><span class="op">)</span>,</span>
<span>  feature_colname <span class="op">=</span> <span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Markers had been selected in minimum distance calculation: "</span></span>
<span><span class="co">## [1] "Others"  "Immune1" "Tumour"  "Immune3" "Immune2"</span></span></code></pre>
<p>The minimum distances can be visualised as a violin plot with
<code><a href="../reference/plot_cell_distances_violin.html">plot_cell_distances_violin()</a></code>. Visualisation of this
distribution often reveals whether pairs of cells are evenly spaced
across the image, or whether there are clusters of pairs of cell
types.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_cell_distances_violin.html">plot_cell_distances_violin</a></span><span class="op">(</span>cell_to_cell_dist <span class="op">=</span> <span class="va">min_dist</span><span class="op">)</span></span></code></pre></div>
<p><img src="basic_analysis_files/figure-html/unnamed-chunk-11-1.png" width="75%"></p>
<p>We can also calculate summary statistics for the distances between
each combination of cell types, the mean, median, min, max and standard
deviation, with
<code><a href="../reference/calculate_summary_distances_between_celltypes.html">calculate_summary_distances_between_celltypes()</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">min_summary_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_summary_distances_between_celltypes.html">calculate_summary_distances_between_celltypes</a></span><span class="op">(</span><span class="va">min_dist</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show the first five rows</span></span>
<span><span class="va">min_summary_dist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##              Pair     Mean      Min       Max   Median  Std.Dev Reference</span></span>
<span><span class="co">## 1 Immune1/Immune2 63.65211 10.33652 158.80504 59.01846 32.58482   Immune1</span></span>
<span><span class="co">## 2 Immune1/Immune3 88.46152 10.23688 256.30328 77.21765 53.73164   Immune1</span></span>
<span><span class="co">## 3  Immune1/Others 19.24038 10.05203  49.86409 17.49196  7.19293   Immune1</span></span>
<span><span class="co">## 4  Immune1/Tumour 85.84773 13.59204 223.15809 80.80592 40.72454   Immune1</span></span>
<span><span class="co">## 5 Immune2/Immune1 48.45885 10.33652 132.31086 43.71936 27.43245   Immune2</span></span>
<span><span class="co">##    Target</span></span>
<span><span class="co">## 1 Immune2</span></span>
<span><span class="co">## 2 Immune3</span></span>
<span><span class="co">## 3  Others</span></span>
<span><span class="co">## 4  Tumour</span></span>
<span><span class="co">## 5 Immune1</span></span></code></pre>
<p>Unlike the pairwise distance, the minimum distances are not
symmetrical, and therefore we output a summary of the minimum distances
specifying the reference and target cell types used.</p>
<p>An example of the interpretation of this result is: “average minimum
distance between cells of Immune1 and Tumour is 85.84773”.</p>
<p>Similarly, the summary statistics of the minimum distances can also
be visualised by a heatmap. This example shows the average minimum
distance between cell types.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_distance_heatmap.html">plot_distance_heatmap</a></span><span class="op">(</span>phenotype_distances_result <span class="op">=</span> <span class="va">min_summary_dist</span>, metric <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<p><img src="basic_analysis_files/figure-html/unnamed-chunk-13-1.png" width="75%"></p>
</div>
</div>
<div class="section level2">
<h2 id="you-can-access-the-vignettes-for-other-modules-of-spiat-here">You can access the vignettes for other modules of SPIAT here:<a class="anchor" aria-label="anchor" href="#you-can-access-the-vignettes-for-other-modules-of-spiat-here"></a>
</h2>
<ul>
<li><a href="SPIAT.html">Overview of SPIAT</a></li>
<li><a href="data_reading-formatting.html">Data reading and
formatting</a></li>
<li><a href="quality-control_visualisation.html">Quality control and
visualisation</a></li>
<li><a href="cell-colocalisation.html">Cell colocalisation</a></li>
<li><a href="spatial-heterogeneity.html">Spatial heterogeneity</a></li>
<li><a href="tissue-structure.html">Tissue structure</a></li>
<li><a href="neighborhood.html">Cellular neighborhood</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.0 (2023-04-21)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] SPIAT_1.3.1                 SpatialExperiment_1.10.0   </span></span>
<span><span class="co">##  [3] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.1</span></span>
<span><span class="co">##  [5] Biobase_2.60.0              GenomicRanges_1.52.0       </span></span>
<span><span class="co">##  [7] GenomeInfoDb_1.36.0         IRanges_2.34.0             </span></span>
<span><span class="co">##  [9] S4Vectors_0.38.1            BiocGenerics_0.46.0        </span></span>
<span><span class="co">## [11] MatrixGenerics_1.12.0       matrixStats_0.63.0         </span></span>
<span><span class="co">## [13] BiocStyle_2.28.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] bitops_1.0-7              deldir_1.0-9             </span></span>
<span><span class="co">##   [3] gridExtra_2.3             rlang_1.1.1              </span></span>
<span><span class="co">##   [5] magrittr_2.0.3            compiler_4.3.0           </span></span>
<span><span class="co">##   [7] spatstat.geom_3.2-1       DelayedMatrixStats_1.22.0</span></span>
<span><span class="co">##   [9] reshape2_1.4.4            systemfonts_1.0.4        </span></span>
<span><span class="co">##  [11] vctrs_0.6.2               stringr_1.5.0            </span></span>
<span><span class="co">##  [13] pkgconfig_2.0.3           crayon_1.5.2             </span></span>
<span><span class="co">##  [15] fastmap_1.1.1             magick_2.7.4             </span></span>
<span><span class="co">##  [17] XVector_0.40.0            labeling_0.4.2           </span></span>
<span><span class="co">##  [19] scuttle_1.10.1            utf8_1.2.3               </span></span>
<span><span class="co">##  [21] rmarkdown_2.21            ragg_1.2.5               </span></span>
<span><span class="co">##  [23] purrr_1.0.1               xfun_0.39                </span></span>
<span><span class="co">##  [25] zlibbioc_1.46.0           cachem_1.0.8             </span></span>
<span><span class="co">##  [27] beachmat_2.16.0           jsonlite_1.8.4           </span></span>
<span><span class="co">##  [29] goftest_1.2-3             highr_0.10               </span></span>
<span><span class="co">##  [31] rhdf5filters_1.12.1       DelayedArray_0.26.2      </span></span>
<span><span class="co">##  [33] spatstat.utils_3.0-3      Rhdf5lib_1.22.0          </span></span>
<span><span class="co">##  [35] BiocParallel_1.34.1       parallel_4.3.0           </span></span>
<span><span class="co">##  [37] R6_2.5.1                  bslib_0.4.2              </span></span>
<span><span class="co">##  [39] stringi_1.7.12            spatstat.data_3.0-1      </span></span>
<span><span class="co">##  [41] limma_3.56.1              jquerylib_0.1.4          </span></span>
<span><span class="co">##  [43] Rcpp_1.0.10               bookdown_0.34            </span></span>
<span><span class="co">##  [45] knitr_1.42                tensor_1.5               </span></span>
<span><span class="co">##  [47] R.utils_2.12.2            Matrix_1.5-4             </span></span>
<span><span class="co">##  [49] tidyselect_1.2.0          abind_1.4-5              </span></span>
<span><span class="co">##  [51] yaml_2.3.7                codetools_0.2-19         </span></span>
<span><span class="co">##  [53] spatstat.random_3.1-5     spatstat.explore_3.2-1   </span></span>
<span><span class="co">##  [55] plyr_1.8.8                lattice_0.21-8           </span></span>
<span><span class="co">##  [57] tibble_3.2.1              withr_2.5.0              </span></span>
<span><span class="co">##  [59] evaluate_0.21             desc_1.4.2               </span></span>
<span><span class="co">##  [61] polyclip_1.10-4           pillar_1.9.0             </span></span>
<span><span class="co">##  [63] BiocManager_1.30.20       generics_0.1.3           </span></span>
<span><span class="co">##  [65] rprojroot_2.0.3           RCurl_1.98-1.12          </span></span>
<span><span class="co">##  [67] ggplot2_3.4.2             sparseMatrixStats_1.12.0 </span></span>
<span><span class="co">##  [69] munsell_0.5.0             scales_1.2.1             </span></span>
<span><span class="co">##  [71] gtools_3.9.4              apcluster_1.4.10         </span></span>
<span><span class="co">##  [73] glue_1.6.2                tools_4.3.0              </span></span>
<span><span class="co">##  [75] locfit_1.5-9.7            RANN_2.6.1               </span></span>
<span><span class="co">##  [77] fs_1.6.2                  rhdf5_2.44.0             </span></span>
<span><span class="co">##  [79] grid_4.3.0                DropletUtils_1.20.0      </span></span>
<span><span class="co">##  [81] edgeR_3.42.2              colorspace_2.1-0         </span></span>
<span><span class="co">##  [83] nlme_3.1-162              GenomeInfoDbData_1.2.10  </span></span>
<span><span class="co">##  [85] HDF5Array_1.28.1          cli_3.6.1                </span></span>
<span><span class="co">##  [87] spatstat.sparse_3.0-1     textshaping_0.3.6        </span></span>
<span><span class="co">##  [89] fansi_1.0.4               viridisLite_0.4.2        </span></span>
<span><span class="co">##  [91] S4Arrays_1.0.4            dplyr_1.1.2              </span></span>
<span><span class="co">##  [93] gtable_0.3.3              R.methodsS3_1.8.2        </span></span>
<span><span class="co">##  [95] sass_0.4.6                digest_0.6.31            </span></span>
<span><span class="co">##  [97] dqrng_0.3.0               farver_2.1.1             </span></span>
<span><span class="co">##  [99] rjson_0.2.21              memoise_2.0.1            </span></span>
<span><span class="co">## [101] htmltools_0.5.5           pkgdown_2.0.7            </span></span>
<span><span class="co">## [103] R.oo_1.25.0               lifecycle_1.0.3</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="author-contributions">Author Contributions<a class="anchor" aria-label="anchor" href="#author-contributions"></a>
</h2>
<p>AT, YF, TY, ML, JZ, VO, MD are authors of the package code. MD and YF
wrote the vignette. AT, YF and TY designed the package.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anna Trigos, Yuzhou Feng, Tianpei Yang, Mabel Li, John Zhu, Volkan Ozcoban, Maria Doyle.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
