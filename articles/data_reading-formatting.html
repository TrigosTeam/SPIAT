<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reading in data and data formatting in SPIAT • SPIAT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reading in data and data formatting in SPIAT">
<meta property="og:description" content="SPIAT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPIAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SPIAT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic_analysis.html">Basic analyses with SPIAT</a>
    </li>
    <li>
      <a href="../articles/cell-colocalisation.html">Quantifying cell colocalisation with SPIAT</a>
    </li>
    <li>
      <a href="../articles/data_reading-formatting.html">Reading in data and data formatting in SPIAT</a>
    </li>
    <li>
      <a href="../articles/neighborhood.html">Identifying cellular neighborhood with SPIAT</a>
    </li>
    <li>
      <a href="../articles/quality-control_visualisation.html">Quality control and visualisation with SPIAT</a>
    </li>
    <li>
      <a href="../articles/spatial-heterogeneity.html">Spatial heterogeneity with SPIAT</a>
    </li>
    <li>
      <a href="../articles/tissue-structure.html">Characterising tissue structure with SPIAT</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/trigosteam/SPIAT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reading in data and data formatting in
SPIAT</h1>
                        <h4 data-toc-skip class="author">Yuzhou
Feng</h4>
            
            <h4 data-toc-skip class="date">2023-04-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/trigosteam/SPIAT/blob/HEAD/vignettes/data_reading-formatting.Rmd" class="external-link"><code>vignettes/data_reading-formatting.Rmd</code></a></small>
      <div class="hidden name"><code>data_reading-formatting.Rmd</code></div>

    </div>

    
    
<p>First we load the SPIAT library.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://trigosteam.github.io/SPIAT/" class="external-link">SPIAT</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="reading-in-data">Reading in data<a class="anchor" aria-label="anchor" href="#reading-in-data"></a>
</h2>
<p><code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code> is the main function to read in
data to SPIAT. <code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code> creates a
<code>SpatialExperiment</code> object which is used in all subsequent
functions. The key data points of interest for SPIAT are cell
coordinates, marker intensities and cell phenotypes for each cell.</p>
<p><code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code> has specific options to read in
data generated from inForm, HALO, CODEX and cellprofiler. However, we
advise pre-formatting the data before input to SPIAT so that accepted by
the ‘general’ option (shown below). This is due to often inconsistencies
in the column names or data formats across different versions or as a
result of different user options when using the other platforms.</p>
<div class="section level3">
<h3 id="reading-in-data-through-the-general-option-recommended">Reading in data through the ‘general’ option (RECOMMENDED)<a class="anchor" aria-label="anchor" href="#reading-in-data-through-the-general-option-recommended"></a>
</h3>
<p>Format “general” allows you to input a matrix of intensities
(<code>intensity_matrix</code>), and a vector of
<code>phenotypes</code>, which should be in the same order in which they
appear in the <code>intensity_matrix</code>. They must be of the form of
marker combinations (e.g. “CD3,CD8”), as opposed to cell names
(e.g. “cytotoxic T cells”), as SPIAT does matching with the marker
names. <code>phenotypes</code> is an optional parameter and can be set
as <code>NULL</code> if no phenotypes are available. The user also needs
to provide separate vectors with the X and Y coordinates of the cells
(<code>coord_x</code> and <code>coord_y</code>). The cells must be in
the same order as in the <code>intensity_matrix</code>. If you have
<code>Xmin</code>, <code>Xmax</code>,<code>Ymin</code> and
<code>Ymax</code> columns in the raw data, we advise calculating the
average to obtain a single X and Y coordinate, which you can then use as
input to <code>coord_x</code> and <code>coord_y</code>.</p>
<p>Specifically, if <code>intensity_matrix</code> is available, please
make sure the <code>colnames</code> of the intensity matrix are the cell
IDs as some SPIAT functions (like
<code><a href="../reference/identify_bordering_cells.html">identify_bordering_cells()</a></code>) require the constructed image
object to have cell IDs as <code>rownames</code> of the colData and
<code>colnames</code> of the intensity matrix. If
<code>intensity_matrix</code> is <code>NULL</code>, the function will
automatically assign IDs to the cells.</p>
<p>Here we use some dummy data to illustrate how to read “general”
format.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Construct a dummy marker intensity matrix</span></span>
<span><span class="co">## rows are markers, columns are cells</span></span>
<span><span class="va">intensity_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14.557</span>, <span class="fl">0.169</span>, <span class="fl">1.655</span>, <span class="fl">0.054</span>,</span>
<span>                             <span class="fl">17.588</span>, <span class="fl">0.229</span>, <span class="fl">1.188</span>, <span class="fl">2.074</span>, </span>
<span>                             <span class="fl">21.262</span>, <span class="fl">4.206</span>,  <span class="fl">5.924</span>, <span class="fl">0.021</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># define marker names as rownames</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">intensity_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DAPI"</span>, <span class="st">"CD3"</span>, <span class="st">"CD4"</span>, <span class="st">"AMACR"</span><span class="op">)</span></span>
<span><span class="co"># define cell IDs as colnames</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">intensity_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cell_1"</span>, <span class="st">"Cell_2"</span>, <span class="st">"Cell_3"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Construct a dummy metadata (phenotypes, x/y coordinates)</span></span>
<span><span class="co"># the order of the elements in these vectors correspond to the cell order </span></span>
<span><span class="co"># in `intensity matrix`</span></span>
<span><span class="va">phenotypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OTHER"</span>,  <span class="st">"AMACR"</span>, <span class="st">"CD3,CD4"</span><span class="op">)</span></span>
<span><span class="va">coord_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">82</span>, <span class="fl">171</span>, <span class="fl">184</span><span class="op">)</span></span>
<span><span class="va">coord_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">22</span>, <span class="fl">38</span><span class="op">)</span></span>
<span></span>
<span><span class="va">general_format_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_image_to_spe.html">format_image_to_spe</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"general"</span>, </span>
<span>                                            intensity_matrix <span class="op">=</span> <span class="va">intensity_matrix</span>,</span>
<span>                                            phenotypes <span class="op">=</span> <span class="va">phenotypes</span>, </span>
<span>                                            coord_x <span class="op">=</span> <span class="va">coord_x</span>,coord_y <span class="op">=</span> <span class="va">coord_y</span><span class="op">)</span></span></code></pre></div>
<p>The formatted image now contains phenotypes, locations, and marker
intensity information of 3 cells. Note that if users want to define cell
IDs, the cell IDs should be defined as the colnames of the intensity
matrix. The order of the rows of the metadata should correspond to the
order of the colnames of the intensity matrix. The function will
automatically assign rownames to the <code><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment-methods.html" class="external-link">spatialCoords()</a></code> and
<code>colData()</code> of the image (now as a
<code>spatialExperiment</code> object).</p>
<p>Use the following code to inspect the formatted SpatialExperiment
object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># phenotypes and cell properties (if available)</span></span>
<span><span class="fu">colData</span><span class="op">(</span><span class="va">general_format_image</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 3 rows and 3 columns</span></span>
<span><span class="co">##            Cell.ID   Phenotype   sample_id</span></span>
<span><span class="co">##        &lt;character&gt; &lt;character&gt; &lt;character&gt;</span></span>
<span><span class="co">## Cell_1      Cell_1       OTHER    sample01</span></span>
<span><span class="co">## Cell_2      Cell_2       AMACR    sample01</span></span>
<span><span class="co">## Cell_3      Cell_3     CD3,CD4    sample01</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># cell coordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment-methods.html" class="external-link">spatialCoords</a></span><span class="op">(</span><span class="va">general_format_image</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      Cell.X.Position Cell.Y.Position</span></span>
<span><span class="co">## [1,]              82              30</span></span>
<span><span class="co">## [2,]             171              22</span></span>
<span><span class="co">## [3,]             184              38</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># marker intensities</span></span>
<span><span class="fu">assay</span><span class="op">(</span><span class="va">general_format_image</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       Cell_1 Cell_2 Cell_3</span></span>
<span><span class="co">## DAPI  14.557 17.588 21.262</span></span>
<span><span class="co">## CD3    0.169  0.229  4.206</span></span>
<span><span class="co">## CD4    1.655  1.188  5.924</span></span>
<span><span class="co">## AMACR  0.054  2.074  0.021</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="reading-in-data-pre-formatted-by-other-software">Reading in data pre-formatted by other software<a class="anchor" aria-label="anchor" href="#reading-in-data-pre-formatted-by-other-software"></a>
</h3>
<p>If you prefer to use data directly generated from inForm, HALO, CODEX
or cellprofiler, these can be specified by <code>format</code> param in
<code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code>. We will show examples for the inForm
and HALO formats.</p>
<p>For reading in input generated with CODEX or cellprofiler see the
documentations (<code><a href="../reference/format_image_to_spe.html">?format_image_to_spe</a></code>).</p>
<div class="section level4">
<h4 id="reading-in-data-from-inform">Reading in data from inForm<a class="anchor" aria-label="anchor" href="#reading-in-data-from-inform"></a>
</h4>
<p>To read in data from inForm, you need the table file generated by
inForm containing the cell IDs, cell locations, phenotypes (if
available) and marker intensities. You also need to extract a vector of
marker names and marker locations (“Nucleus”, “Cytoplasm”, or
“Membrane”). <code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code> uses the “Cell X
Position” and “Cell Y Position” columns and the “Phenotype” column in
the inForm raw data. The phenotype of a cell can be a single marker, for
example, “CD3”, or a combination of markers, such as “CD3,CD4”. As a
convention, SPIAT assumes that cells marked as “OTHER” in “inForm” refer
to cells positive for DAPI but no other marker. The phenotypes must be
based on the markers (e.g. CD3,CD4), rather than names of cells
(e.g. cytotoxic T cells). The names of the cells (e.g. cytotoxic T
cells) can be added later using the <code><a href="../reference/define_celltypes.html">define_celltypes()</a></code>
function. The following cell properties columns are also required to be
present in the inForm input file: Entire Cell Area (pixels), Nucleus
Area (pixels), Nucleus Compactness, Nucleus Axis Ratio, and Entire Cell
Axis Ratio. If not present in the raw data, these can be columns with
NAs.</p>
<p>To read in inForm data, you need to specify the following
parameters:</p>
<ul>
<li>
<code>format</code>: “inForm”</li>
<li>
<code>path</code>: path to the raw inForm image data file</li>
<li>
<code>markers</code>: names of markers used in the OPAL staining.
These must be in the same order as the marker columns in the input file,
and must match the marker names used in the input file. One of the
markers must be “DAPI”.</li>
<li>
<code>locations</code>: locations of the markers in cells, either
“Nucleus”, “Cytoplasm” or “Membrane.” These must be in the same order as
<code>markers</code>. The locations are used to auto-detect the
intensity (and dye) columns.</li>
</ul>
<p>A small example of inForm input is included in SPIAT containing dummy
marker intensity values and all the other required columns (see below).
This example file is just for demonstrating importing a raw data file,
later in the <a href="#example-data">Inspecting the SpaitalExperiment
object</a> section we will load a larger preformatted dataset. Users are
welcome to use this formatting option (<code>format = 'inForm'</code>)
if it is closer to the format of their files.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raw_inform_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tiny_inform.txt.gz"</span>, package <span class="op">=</span> <span class="st">"SPIAT"</span><span class="op">)</span></span>
<span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DAPI"</span>, <span class="st">"CD3"</span>, <span class="st">"PD-L1"</span>, <span class="st">"CD4"</span>, <span class="st">"CD8"</span>, <span class="st">"AMACR"</span><span class="op">)</span></span>
<span><span class="va">locations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nucleus"</span>,<span class="st">"Cytoplasm"</span>, <span class="st">"Membrane"</span>,<span class="st">"Cytoplasm"</span>,<span class="st">"Cytoplasm"</span>,</span>
<span>               <span class="st">"Cytoplasm"</span><span class="op">)</span> <span class="co"># The order is the same as `markers`.</span></span>
<span><span class="va">formatted_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_image_to_spe.html">format_image_to_spe</a></span><span class="op">(</span>format<span class="op">=</span><span class="st">"inForm"</span>, path<span class="op">=</span><span class="va">raw_inform_data</span>, </span>
<span>                                       markers<span class="op">=</span><span class="va">markers</span>, locations<span class="op">=</span><span class="va">locations</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, rather than specifying the <code>locations</code>, you
can also specify the specific intensity columns with the parameter
<code>intensity_columns_interest</code> as shown below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raw_inform_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tiny_inform.txt.gz"</span>, package <span class="op">=</span> <span class="st">"SPIAT"</span><span class="op">)</span></span>
<span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DAPI"</span>, <span class="st">"CD3"</span>, <span class="st">"PD-L1"</span>, <span class="st">"CD4"</span>, <span class="st">"CD8"</span>, <span class="st">"AMACR"</span><span class="op">)</span></span>
<span><span class="va">intensity_columns_interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Nucleus DAPI (DAPI) Mean (Normalized Counts, Total Weighting)"</span>,</span>
<span>  <span class="st">"Cytoplasm CD3 (Opal 520) Mean (Normalized Counts, Total Weighting)"</span>, </span>
<span>  <span class="st">"Membrane PD-L1 (Opal 540) Mean (Normalized Counts, Total Weighting)"</span>,</span>
<span>  <span class="st">"Cytoplasm CD4 (Opal 620) Mean (Normalized Counts, Total Weighting)"</span>,</span>
<span>  <span class="st">"Cytoplasm CD8 (Opal 650) Mean (Normalized Counts, Total Weighting)"</span>, </span>
<span>  <span class="st">"Cytoplasm AMACR (Opal 690) Mean (Normalized Counts, Total Weighting)"</span></span>
<span>  <span class="op">)</span> <span class="co"># The order is the same as `markers`.</span></span>
<span><span class="va">formatted_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_inform_to_spe.html">format_inform_to_spe</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">raw_inform_data</span>, markers<span class="op">=</span><span class="va">markers</span>,</span>
<span>                     intensity_columns_interest<span class="op">=</span><span class="va">intensity_columns_interest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">formatted_image</span><span class="op">)</span> <span class="co"># The formatted image is a SpatialExperiment object</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "SpatialExperiment"</span></span>
<span><span class="co">## attr(,"package")</span></span>
<span><span class="co">## [1] "SpatialExperiment"</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">formatted_image</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 9 7</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">formatted_image</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6 9</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="reading-in-data-from-halo">Reading in data from HALO<a class="anchor" aria-label="anchor" href="#reading-in-data-from-halo"></a>
</h4>
<p>To read in data from HALO, you need the table file generated by HALO.
The biggest difference between inForm and HALO formats is the coding of
the cell phenotypes. While inForm encodes phenotypes as the combination
of positive markers (e.g. “CD3,CD4”), HALO uses a binary system where 1
means the cell is positive for the marker and 0 otherwise.</p>
<p><code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code> for “HALO” format collapses HALO
encoded phenotypes into an inForm-like format to create the
<code>Phenotype</code> column. For example, if HALO has assigned a cell
a marker status of 1 for CD3 and 1 for CD4, SPIAT will give it the
Phenotype “CD3,CD4”. Cells that have a marker status of 1 for DAPI but
no other marker are given the phenotype “OTHER”.</p>
<p><code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code> takes the average of the HALO X
min and X max columns for each cell to create the
<code>Cell.X.Position</code> column. It takes the average of the Y min
and Y max to create the <code>Cell.Y.Position</code> column.</p>
<p>To read in HALO data, you need to specify the following
parameters:</p>
<ul>
<li>
<code>format</code>: “HALO”</li>
<li>
<code>path</code>: path to the raw HALO image data file</li>
<li>
<code>markers</code>: names of markers used in the OPAL staining.
These must be in the same order as the marker columns in the input file,
and must match the marker names used in the input file. One of the
markers must be DAPI.</li>
<li>
<code>locations</code>: locations of the markers in cells, either
“Nucleus”, “Cytoplasm” or “Membrane.” These must be in the order of the
<code>markers</code>. The locations are used to auto-detect the
intensity (and dye) columns.</li>
<li>
<code>intensity_columns_interest</code> use if
<code>locations</code> is not specified. Vector with the names of the
columns with the level of each marker. Column names must match the order
of the <code>markers</code> parameter.</li>
<li>
<code>dye_columns_interest</code> Use if locations is not specified.
Vector of names of the columns with the marker status (i.e. those
indicating 1 or 0 for whether the cell is positive or negative for the
marker). Column names must match the order of the <code>markers</code>
parameter.</li>
</ul>
<p>Users can specify the <code>locations</code> to auto-detect the
columns as shown above for inForm. Alternatively, if users want to
specify the columns instead, you can do so with
<code>intensity_columns_interest</code>, as shown in the example below.
Note that then you also must specify <code>dye_columns_interest</code>.
The following cell properties columns are also required to be present in
the HALO input file: Cell Area, Nucleus Area, Cytoplasm Area. If these
are not present in the user’s data, we recommend adding these columns
with NA values.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raw_halo_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tiny_halo.csv.gz"</span>, package <span class="op">=</span> <span class="st">"SPIAT"</span><span class="op">)</span></span>
<span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DAPI"</span>, <span class="st">"CD3"</span>, <span class="st">"PD-L1"</span>, <span class="st">"CD4"</span>, <span class="st">"CD8"</span>, <span class="st">"AMACR"</span><span class="op">)</span></span>
<span><span class="va">intensity_columns_interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dye 1 Nucleus Intensity"</span>,</span>
<span>                                <span class="st">"Dye 2 Cytoplasm Intensity"</span>,</span>
<span>                                <span class="st">"Dye 3 Membrane Intensity"</span>,</span>
<span>                                <span class="st">"Dye 4 Cytoplasm Intensity"</span>,</span>
<span>                                <span class="st">"Dye 5 Cytoplasm Intensity"</span>,</span>
<span>                                <span class="st">"Dye 6 Cytoplasm Intensity"</span><span class="op">)</span></span>
<span><span class="va">dye_columns_interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dye 1 Positive Nucleus"</span>,</span>
<span>                          <span class="st">"Dye 2 Positive Cytoplasm"</span>,</span>
<span>                          <span class="st">"Dye 3 Positive Membrane"</span>,</span>
<span>                          <span class="st">"Dye 4 Positive Cytoplasm"</span>,</span>
<span>                          <span class="st">"Dye 5 Positive Cytoplasm"</span>,</span>
<span>                          <span class="st">"Dye 6 Positive Cytoplasm"</span><span class="op">)</span></span>
<span><span class="va">formatted_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_halo_to_spe.html">format_halo_to_spe</a></span><span class="op">(</span></span>
<span>  path<span class="op">=</span><span class="va">raw_halo_data</span>, markers<span class="op">=</span><span class="va">markers</span>,</span>
<span>  intensity_columns_interest<span class="op">=</span><span class="va">intensity_columns_interest</span>,</span>
<span>  dye_columns_interest<span class="op">=</span><span class="va">dye_columns_interest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">formatted_image</span><span class="op">)</span> <span class="co"># The formatted image is a SpatialExperiment object</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "SpatialExperiment"</span></span>
<span><span class="co">## attr(,"package")</span></span>
<span><span class="co">## [1] "SpatialExperiment"</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">formatted_image</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 10  5</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">formatted_image</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  6 10</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="inspecting-the-spaitalexperiment-object">Inspecting the SpaitalExperiment object<a class="anchor" aria-label="anchor" href="#inspecting-the-spaitalexperiment-object"></a>
</h2>
<div class="section level3">
<h3 id="example-data">Structure of a SPIAT SpatialExperiment object<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>In this vignette we will use an inForm data file that’s already been
formatted for SPIAT with <code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code>, which we
can load with <code>data</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simulated_image"</span><span class="op">)</span></span></code></pre></div>
<p>This is in <code>SpatialExperiment</code> format.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">simulated_image</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "SpatialExperiment"</span></span>
<span><span class="co">## attr(,"package")</span></span>
<span><span class="co">## [1] "SpatialExperiment"</span></span></code></pre>
<p>This example data has 5 markers and 4951 cells.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">simulated_image</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]    5 4951</span></span></code></pre>
<p><code>assay()</code> stores the intensity level of every marker
(rows) for every cell (columns).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take a look at first 5 columns</span></span>
<span><span class="fu">assay</span><span class="op">(</span><span class="va">simulated_image</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                      Cell_1       Cell_2      Cell_3       Cell_4       Cell_5</span></span>
<span><span class="co">## Tumour_marker  4.466925e-01 1.196802e-04 0.235435887 1.125552e-01 1.600443e-02</span></span>
<span><span class="co">## Immune_marker1 1.143640e-05 4.360881e-19 0.120582510 2.031554e-13 1.685832e-01</span></span>
<span><span class="co">## Immune_marker2 1.311175e-15 5.678623e-02 0.115769761 5.840184e-12 9.025254e-05</span></span>
<span><span class="co">## Immune_marker3 6.342341e-09 2.862823e-06 0.053107792 6.289501e-04 4.912962e-13</span></span>
<span><span class="co">## Immune_marker4 2.543406e-04 4.702311e-04 0.005878394 4.582812e-03 2.470984e-03</span></span></code></pre>
<p><code>colData()</code> stores the phenotype and cell properties. Note
that the <code>sample_id</code> column was added by
<code>SpatialExperiment</code> data structure and can be ignored
here.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take a look at first 5 rows</span></span>
<span><span class="fu">colData</span><span class="op">(</span><span class="va">simulated_image</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 5 rows and 2 columns</span></span>
<span><span class="co">##          Phenotype   sample_id</span></span>
<span><span class="co">##        &lt;character&gt; &lt;character&gt;</span></span>
<span><span class="co">## Cell_1       OTHER    sample01</span></span>
<span><span class="co">## Cell_2       OTHER    sample01</span></span>
<span><span class="co">## Cell_3       OTHER    sample01</span></span>
<span><span class="co">## Cell_4       OTHER    sample01</span></span>
<span><span class="co">## Cell_5       OTHER    sample01</span></span></code></pre>
<p><code><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment-methods.html" class="external-link">spatialCoords()</a></code> stores cell coordinates.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take a look at first 5 rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment-methods.html" class="external-link">spatialCoords</a></span><span class="op">(</span><span class="va">simulated_image</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##        Cell.X.Position Cell.Y.Position</span></span>
<span><span class="co">## Cell_1       139.77484       86.704079</span></span>
<span><span class="co">## Cell_2        77.86721       80.096527</span></span>
<span><span class="co">## Cell_3        84.44626       19.238638</span></span>
<span><span class="co">## Cell_4       110.19857        5.656004</span></span>
<span><span class="co">## Cell_5       167.89558      171.926407</span></span></code></pre>
<p>We can check what phenotypes are there.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">simulated_image</span><span class="op">$</span><span class="va">Phenotype</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "OTHER"                                       </span></span>
<span><span class="co">## [2] "Immune_marker1,Immune_marker2"               </span></span>
<span><span class="co">## [3] "Tumour_marker"                               </span></span>
<span><span class="co">## [4] "Immune_marker1,Immune_marker2,Immune_marker4"</span></span>
<span><span class="co">## [5] "Immune_marker1,Immune_marker3"</span></span></code></pre>
<p>The phenotypes in this example data can be interpreted as
follows:</p>
<ul>
<li>Tumour_marker = cancer cells</li>
<li>Immune_marker1,Immune_marker2 = immune cell type 1</li>
<li>Immune_marker1,Immune_marker3 = immune cell type 2</li>
<li>Immune_marker1,Immune_marker2,Immune_marker4 = immune cell type
3</li>
<li>OTHER = other cell types</li>
</ul>
</div>
<div class="section level3">
<h3 id="nomenclature">Nomenclature<a class="anchor" aria-label="anchor" href="#nomenclature"></a>
</h3>
<p>In SPIAT We define as <strong>markers</strong> proteins whose levels
where queried by OPAL, CODEX or other platforms.</p>
<p>Examples of markers are “AMACR” for prostate cancer cells, “panCK”
for epithelial tumour cells, “CD3” for T cells or “CD20” for B
cells.</p>
<p>The combination of markers results in a specific <strong>cell
phenotype</strong>. For example, a cell positive for both “CD3” and
“CD4” markers has the “CD3,CD4” <strong>cell phenotype</strong>.
<strong>The phenotype has to be strictly formatted in such</strong>
<strong>way where each positive marker has to be separated by a comma,
with no space in</strong> <strong>between, and the order of the positive
markers has to be the same as the order </strong> <strong>in
<code>assay()</code>.</strong></p>
<p>Finally, we define a <strong>cell type</strong> as a name assigned by
the user to a cell phenotype. For example, a user can name “CD3,CD4”
cells as “helper T cells”. We would refer to “helper T cells” therefore
as a <strong>cell type</strong>.</p>
</div>
<div class="section level3">
<h3 id="splitting-images">Splitting images<a class="anchor" aria-label="anchor" href="#splitting-images"></a>
</h3>
<p>In the case of large images, or images where there are two
independent tissue sections, it is recommended to split images into
sections defined by the user. This can be performed with
<code><a href="../reference/image_splitter.html">image_splitter()</a></code> after
<code><a href="../reference/format_image_to_spe.html">format_image_to_spe()</a></code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">split_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_splitter.html">image_splitter</a></span><span class="op">(</span><span class="va">simulated_image</span>, number_of_splits<span class="op">=</span><span class="fl">3</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="predicting-cell-phenotypes">Predicting cell phenotypes<a class="anchor" aria-label="anchor" href="#predicting-cell-phenotypes"></a>
</h3>
<p>SPIAT can predict cell phenotypes using marker intensity levels with
<code><a href="../reference/predict_phenotypes.html">predict_phenotypes()</a></code>. This can be used to check the
phenotypes that have been assigned by inForm and HALO. It can also
potentially be used to automate the manual phenotyping performed with
inForm/HALO. The underlying algorithm is based on the density
distribution of marker intensities. We have found this algorithm to
perform best in OPAL data. Further phenotyping methods for other data
formats are under development.</p>
<p>This algorithm does not take into account cell shape or size, so if
these are required for phenotyping, using HALO or inForm or a
machine-learning based method is recommended.</p>
<p><code><a href="../reference/predict_phenotypes.html">predict_phenotypes()</a></code> produces a density plot that shows
the cutoff for calling a cell positive for a marker. If the dataset
includes phenotypes obtained through another software, this function
prints to the console the concordance between SPIAT’s prediction and
pre-defined phenotypes as the number of true positives (TP), true
negatives (TN), false positives (FP) and false negatives (FN) phenotype
assignments. It returns a table containing the phenotypes predicted by
SPIAT and the actual phenotypes from inForm/HALO (if available).</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predicted_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_phenotypes.html">predict_phenotypes</a></span><span class="op">(</span>spe_object <span class="op">=</span> <span class="va">simulated_image</span>,</span>
<span>                                      thresholds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                      tumour_marker <span class="op">=</span> <span class="st">"Tumour_marker"</span>,</span>
<span>                                      baseline_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune_marker1"</span>, </span>
<span>                                                           <span class="st">"Immune_marker2"</span>, </span>
<span>                                                           <span class="st">"Immune_marker3"</span>, </span>
<span>                                                           <span class="st">"Immune_marker4"</span><span class="op">)</span>,</span>
<span>                                      reference_phenotypes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Tumour_marker"</span></span>
<span><span class="co">## [1] "Immune_marker1"</span></span>
<span><span class="co">## [1] "Immune_marker2"</span></span>
<span><span class="co">## [1] "Immune_marker3"</span></span>
<span><span class="co">## [1] "Immune_marker4"</span></span></code></pre>
<p><img src="data_reading-formatting_files/figure-html/unnamed-chunk-15-1.png" width="384"></p>
<p>We can use <code><a href="../reference/marker_prediction_plot.html">marker_prediction_plot()</a></code> to plot the
predicted cell phenotypes and the phenotypes generated from the
platforms for comparison.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/marker_prediction_plot.html">marker_prediction_plot</a></span><span class="op">(</span><span class="va">predicted_image</span>, marker<span class="op">=</span><span class="st">"Immune_marker1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="data_reading-formatting_files/figure-html/unnamed-chunk-16-1.png" width="100%"></p>
<p>The plot shows Immune_marker1+ cells in the tissue. On the left are
the Immune_marker1+ cells defined by the simulated image and on the
right are the Immune_marker1+ cells predicted using SPIAT. Since we know
that the simulated phenotypes are the truth, we leave the phenotypes as
they are.</p>
<p>The next example shows how to replace the original phenotypes with
the predicted ones. Note that for this tutorial, we still use the
original phenotypes.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predicted_image2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_phenotypes.html">predict_phenotypes</a></span><span class="op">(</span>spe_object <span class="op">=</span> <span class="va">simulated_image</span>,</span>
<span>                                      thresholds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                      tumour_marker <span class="op">=</span> <span class="st">"Tumour_marker"</span>,</span>
<span>                                      baseline_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune_marker1"</span>, </span>
<span>                                                           <span class="st">"Immune_marker2"</span>, </span>
<span>                                                           <span class="st">"Immune_marker3"</span>, </span>
<span>                                                           <span class="st">"Immune_marker4"</span><span class="op">)</span>,</span>
<span>                                      reference_phenotypes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="specifying-cell-types">Specifying cell types<a class="anchor" aria-label="anchor" href="#specifying-cell-types"></a>
</h3>
<p>SPIAT can define cell types with the <code><a href="../reference/define_celltypes.html">define_celltypes()</a></code>
function. By default the new column for cell types is called
<code>Cell.Type</code>. The cell types can be defined based on
<code>Phenotype</code> column, as well as other columns.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formatted_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_celltypes.html">define_celltypes</a></span><span class="op">(</span></span>
<span>    <span class="va">simulated_image</span>, </span>
<span>    categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour_marker"</span>,<span class="st">"Immune_marker1,Immune_marker2"</span>, </span>
<span>                   <span class="st">"Immune_marker1,Immune_marker3"</span>, </span>
<span>                   <span class="st">"Immune_marker1,Immune_marker2,Immune_marker4"</span>, <span class="st">"OTHER"</span><span class="op">)</span>, </span>
<span>    category_colname <span class="op">=</span> <span class="st">"Phenotype"</span>, </span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Immune3"</span>, <span class="st">"Others"</span><span class="op">)</span>,</span>
<span>    new_colname <span class="op">=</span> <span class="st">"Cell.Type"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="you-can-access-the-vignettes-for-other-modules-of-spiat-here">You can access the vignettes for other modules of SPIAT here:<a class="anchor" aria-label="anchor" href="#you-can-access-the-vignettes-for-other-modules-of-spiat-here"></a>
</h2>
<ul>
<li><a href="SPIAT.html">Overview of SPIAT</a></li>
<li><a href="quality-control_visualisation.html">Quality control and
visualisation</a></li>
<li><a href="basic_analysis.html">Basic analysis</a></li>
<li><a href="cell-colocalisation.html">Cell colocalisation</a></li>
<li><a href="spatial-heterogeneity.html">Spatial heterogeneity</a></li>
<li><a href="tissue-structure.html">Tissue structure</a></li>
<li><a href="neighborhood.html">Cellular neighborhood</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h2>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.0 (2023-04-21)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] SPIAT_1.0.6                 SpatialExperiment_1.9.5    </span></span>
<span><span class="co">##  [3] SingleCellExperiment_1.21.1 SummarizedExperiment_1.29.1</span></span>
<span><span class="co">##  [5] Biobase_2.59.0              GenomicRanges_1.51.4       </span></span>
<span><span class="co">##  [7] GenomeInfoDb_1.35.17        IRanges_2.33.1             </span></span>
<span><span class="co">##  [9] S4Vectors_0.37.7            BiocGenerics_0.45.3        </span></span>
<span><span class="co">## [11] MatrixGenerics_1.11.1       matrixStats_0.63.0         </span></span>
<span><span class="co">## [13] BiocStyle_2.27.2           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] bitops_1.0-7              deldir_1.0-6             </span></span>
<span><span class="co">##   [3] gridExtra_2.3             rlang_1.1.0              </span></span>
<span><span class="co">##   [5] magrittr_2.0.3            compiler_4.3.0           </span></span>
<span><span class="co">##   [7] spatstat.geom_3.1-0       DelayedMatrixStats_1.21.0</span></span>
<span><span class="co">##   [9] systemfonts_1.0.4         vctrs_0.6.2              </span></span>
<span><span class="co">##  [11] stringr_1.5.0             crayon_1.5.2             </span></span>
<span><span class="co">##  [13] pkgconfig_2.0.3           fastmap_1.1.1            </span></span>
<span><span class="co">##  [15] magick_2.7.4              XVector_0.39.0           </span></span>
<span><span class="co">##  [17] labeling_0.4.2            scuttle_1.9.4            </span></span>
<span><span class="co">##  [19] utf8_1.2.3                rmarkdown_2.21           </span></span>
<span><span class="co">##  [21] pracma_2.4.2              tzdb_0.3.0               </span></span>
<span><span class="co">##  [23] ragg_1.2.5                bit_4.0.5                </span></span>
<span><span class="co">##  [25] purrr_1.0.1               xfun_0.39                </span></span>
<span><span class="co">##  [27] zlibbioc_1.45.0           cachem_1.0.7             </span></span>
<span><span class="co">##  [29] beachmat_2.15.2           jsonlite_1.8.4           </span></span>
<span><span class="co">##  [31] goftest_1.2-3             highr_0.10               </span></span>
<span><span class="co">##  [33] rhdf5filters_1.11.3       DelayedArray_0.25.0      </span></span>
<span><span class="co">##  [35] spatstat.utils_3.0-2      Rhdf5lib_1.21.1          </span></span>
<span><span class="co">##  [37] BiocParallel_1.33.12      parallel_4.3.0           </span></span>
<span><span class="co">##  [39] R6_2.5.1                  bslib_0.4.2              </span></span>
<span><span class="co">##  [41] stringi_1.7.12            spatstat.data_3.0-1      </span></span>
<span><span class="co">##  [43] limma_3.55.8              jquerylib_0.1.4          </span></span>
<span><span class="co">##  [45] Rcpp_1.0.10               bookdown_0.33            </span></span>
<span><span class="co">##  [47] knitr_1.42                tensor_1.5               </span></span>
<span><span class="co">##  [49] R.utils_2.12.2            Matrix_1.5-4             </span></span>
<span><span class="co">##  [51] tidyselect_1.2.0          abind_1.4-5              </span></span>
<span><span class="co">##  [53] yaml_2.3.7                codetools_0.2-19         </span></span>
<span><span class="co">##  [55] spatstat.random_3.1-4     spatstat.explore_3.1-0   </span></span>
<span><span class="co">##  [57] lattice_0.21-8            tibble_3.2.1             </span></span>
<span><span class="co">##  [59] withr_2.5.0               evaluate_0.20            </span></span>
<span><span class="co">##  [61] desc_1.4.2                polyclip_1.10-4          </span></span>
<span><span class="co">##  [63] pillar_1.9.0              BiocManager_1.30.20      </span></span>
<span><span class="co">##  [65] generics_0.1.3            vroom_1.6.1              </span></span>
<span><span class="co">##  [67] rprojroot_2.0.3           RCurl_1.98-1.12          </span></span>
<span><span class="co">##  [69] ggplot2_3.4.2             sparseMatrixStats_1.11.1 </span></span>
<span><span class="co">##  [71] munsell_0.5.0             scales_1.2.1             </span></span>
<span><span class="co">##  [73] glue_1.6.2                tools_4.3.0              </span></span>
<span><span class="co">##  [75] locfit_1.5-9.7            fs_1.6.1                 </span></span>
<span><span class="co">##  [77] rhdf5_2.43.5              grid_4.3.0               </span></span>
<span><span class="co">##  [79] DropletUtils_1.19.3       edgeR_3.41.8             </span></span>
<span><span class="co">##  [81] colorspace_2.1-0          nlme_3.1-162             </span></span>
<span><span class="co">##  [83] GenomeInfoDbData_1.2.10   HDF5Array_1.27.0         </span></span>
<span><span class="co">##  [85] mmand_1.6.3               cli_3.6.1                </span></span>
<span><span class="co">##  [87] spatstat.sparse_3.0-1     textshaping_0.3.6        </span></span>
<span><span class="co">##  [89] fansi_1.0.4               dplyr_1.1.2              </span></span>
<span><span class="co">##  [91] gtable_0.3.3              R.methodsS3_1.8.2        </span></span>
<span><span class="co">##  [93] sass_0.4.5                digest_0.6.31            </span></span>
<span><span class="co">##  [95] dqrng_0.3.0               farver_2.1.1             </span></span>
<span><span class="co">##  [97] rjson_0.2.21              memoise_2.0.1            </span></span>
<span><span class="co">##  [99] htmltools_0.5.5           pkgdown_2.0.7            </span></span>
<span><span class="co">## [101] R.oo_1.25.0               lifecycle_1.0.3          </span></span>
<span><span class="co">## [103] bit64_4.0.5</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="author-contributions">Author Contributions<a class="anchor" aria-label="anchor" href="#author-contributions"></a>
</h2>
<p>AT, YF, TY, ML, JZ, VO, MD are authors of the package code. MD and YF
wrote the vignette. AT, YF and TY designed the package.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anna Trigos, Yuzhou Feng, Tianpei Yang, Mabel Li, John Zhu, Volkan Ozcoban, Maria Doyle.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
